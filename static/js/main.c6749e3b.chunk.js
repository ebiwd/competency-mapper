(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,a){},114:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),o=a.n(c),s=a(6),i=(a(104),a(86)),l=a(1),u=a.n(l),m=a(4),d=a(5),p=a(3),h=a(9),f=a(7),v=a(8),g=a(44),b=a(64),y=a.n(b);function k(e){var t=e.isActive;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("div",{className:"warning progress ".concat(y.a.progress),role:"progressbar"},r.a.createElement("div",{className:"progress-meter ".concat(y.a.meter)})))}k.defaultProps={isActive:!1};var E=k,w=window.$,j=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).navRef=r.a.createRef(),a.logout=function(){(0,a.props.onLogout)()},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){w(this.navRef.current).foundation()}},{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user,n=r.a.createElement("li",null,r.a.createElement("a",{tabIndex:"0",className:"dropdown-on-dark-background"},"Manage Competencies"),r.a.createElement("ul",{className:"menu vertical"},r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/bioexcel/manage/competencies"},"BioExcel")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/corbel/manage/competencies"},"CORBEL")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/iscb/manage/competencies"},"ISCB")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/ritrain/manage/competencies"},"RITrain")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/nhs/manage/competencies"},"NHS")))),c=r.a.createElement("li",null,r.a.createElement(s.b,{to:"/all-training-resources"},"Manage Training Resources")),o=r.a.createElement("li",null,r.a.createElement("a",{tabIndex:"0",className:"dropdown-on-light-background"},r.a.createElement("i",{className:"fas fa-user"})," Hi ",a),r.a.createElement("ul",{className:"menu vertical"},r.a.createElement("li",null,r.a.createElement(s.b,{to:"/user/change/password"},"Change password")),r.a.createElement("li",null,r.a.createElement("a",{onClick:this.logout},"Logout"))));return r.a.createElement("nav",{ref:this.navRef},r.a.createElement("ul",{className:"dropdown menu float-left","data-dropdown-menu":!0,"data-description":"navigational"},t.includes("framework_manager")&&n,t.includes("content_manager")&&c),r.a.createElement("ul",{className:"dropdown menu float-right","data-dropdown-menu":!0,"data-description":"user tasks"},o))}}]),t}(n.Component),O=a(14),_=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:""},a.onChange=function(e){a.setState(Object(O.a)({},e.currentTarget.name,e.currentTarget.value))},a.submit=function(){var e=a.props.onSubmit,t=a.state,n=t.username,r=t.password;n&&r&&e(n,r)},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.password;return r.a.createElement("nav",null,r.a.createElement("ul",{className:"menu float-left small-12"},r.a.createElement("li",{className:"small-12 margin-bottom-large"},r.a.createElement("label",{className:"columns small-4 medium-3 large-2 margin-top-large"},r.a.createElement("input",{value:a,name:"username",onChange:function(t){return e.onChange(t)},type:"text",autoComplete:"username",placeholder:"Username"})),r.a.createElement("label",{className:"columns small-4 medium-3 large-2 margin-top-large"},r.a.createElement("input",{value:n,name:"password",onChange:function(t){return e.onChange(t)},type:"password",autoComplete:"current-password",placeholder:"Password"})),r.a.createElement("div",{className:"columns small-4 medium-6 large-8 margin-top-large"},r.a.createElement("button",{className:"button",type:"button",onClick:function(){return e.submit()}},r.a.createElement("i",{className:"fa fa-key","aria-hidden":"true"})," Login")))))}}]),t}(n.Component),S=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onLogin=function(e,t){a.props.onLogin(e,t)},a.onLogout=function(){a.props.onLogout()},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user,n=e.isActive;return r.a.createElement("div",{"data-sticky-container":!0},r.a.createElement("header",{id:"masthead",className:"masthead","data-sticky":!0,"data-sticky-on":"large","data-top-anchor":"main-content-area:top","data-btm-anchor":"main-content-area:bottom"},r.a.createElement("div",{className:"masthead-inner row"},r.a.createElement("div",{className:"columns medium-12",id:"local-title"},r.a.createElement("h1",null,r.a.createElement(s.b,{to:"/"},"Competency Mapper"))),a&&t?r.a.createElement(j,{roles:t,user:a,onLogout:this.onLogout}):r.a.createElement(_,{onSubmit:this.onLogin})),r.a.createElement(E,{isActive:n})))}}]),t}(n.Component),N=(a(114),{oriValue:"",value:"",active:!1}),C=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).state=N,a.selfRef=r.a.createRef(),a.inputRef=r.a.createRef(),a.toggleActive=function(e){a.selfRef.current&&a.selfRef.current.contains(e.target)?a.setState({active:!0}):a.reset()},a.reset=function(){var e=a.state,t=e.oriValue;e.active&&a.setState({active:!1,value:t})},a.submit=function(){var e=a.props.change,t=a.state.value;e(t),a.setState({active:!1,oriValue:t})},a.render=function(){var e=a.props,t=e.style,n=e.staticElement,c=e.editable,o=a.state,s=o.value,i=o.active;return c?i?r.a.createElement("div",{className:"edit-inline-container",ref:a.selfRef},r.a.createElement("input",{type:"text",className:"inner-input",value:s,onChange:function(e){return a.onChange(e.target.value)},ref:a.inputRef}),r.a.createElement("div",{className:"edit-inline-controls"},r.a.createElement("button",{className:"button margin-bottom-none",type:"button",onClick:a.submit},r.a.createElement("i",{className:"icon icon-common icon-check","aria-label":"accept changes"})),r.a.createElement("button",{className:"button margin-bottom-none",type:"button",onClick:a.reset},r.a.createElement("i",{className:"icon icon-common icon-undo","aria-label":"undo changes"})))):r.a.createElement(n,{style:t,ref:a.selfRef},[s,r.a.createElement("i",{key:"dummy",className:"icon icon-common icon-edit icon-left-spacer","aria-label":"edit"})]):r.a.createElement(n,{style:t},s)},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.text;this.setState({value:e,oriValue:e}),document.addEventListener("mousedown",this.toggleActive)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.toggleActive)}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.active&&!t.active&&setTimeout(function(){return a.inputRef.current&&a.inputRef.current.focus()},0)}},{key:"onChange",value:function(e){this.setState({value:e})}}]),t}(n.Component);C.defaultProps={style:{},text:"",change:function(e){},staticElement:"div",editable:!0};var x={description:"",uuid:"",mapping:""},D=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state=x,a.onChange=function(e){e.preventDefault();var t=e.currentTarget.value,n=e.currentTarget.name;"uuid"===n&&a.setState(Object(O.a)({},n,t)),"description"===n&&a.setState(Object(O.a)({},n,t)),"mapping"===n&&a.setState(Object(O.a)({},n,t))},a.onSubmit=function(e){e.preventDefault();var t=a.props.onCreate,n=a.state,r=n.description,c=n.uuid,o=n.mapping;r.trim()&&c&&(t(r,c,o),a.reset())},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.setDefaultOption()}},{key:"setDefaultOption",value:function(){var e=this.props.options;if(e.length){var t=e[0].uuid;this.setState({uuid:t})}}},{key:"reset",value:function(){this.setState(x),this.setDefaultOption()}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.placeholder,n=e.options,c=e.showMappingField,o=this.state,s=o.description,i=o.uuid,l=o.mapping,u=n.map(function(e){var t=e.description,a=e.uuid;return r.a.createElement("option",{key:a,value:a},t)});return r.a.createElement("form",{onSubmit:this.onSubmit,className:"callout"},r.a.createElement("h4",null,t),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-7"},r.a.createElement("input",{type:"text",placeholder:a,name:"description",value:s,required:!0,onChange:this.onChange})),r.a.createElement("div",{className:"column large-3"},r.a.createElement("select",{name:"uuid",value:i,required:!0,onChange:this.onChange},u)),r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Create"})),c?r.a.createElement("div",{className:"column"},r.a.createElement("label",null,"Maps to competency/attribute from other framework",r.a.createElement("input",{type:"text",placeholder:"Framework (version), competency or attribute",name:"mapping",value:l,onChange:this.onChange}))):null))}}]),t}(n.Component);D.defaultProps={showMappingField:!1};var R=function(e){var t=e.message,a=e.style;return r.a.createElement("div",{className:"margin-top-large callout alert",style:a},t)};R.defaultProps={message:"Sorry, there was a problem when fetching the data!",style:{}};var A=R,q=a(40),T=a(35),F=a.n(T),I=a(32),L=a.n(I),U={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},M=function(e){var t=e.versions,a=e.framework,c=Object(n.useState)(!1),o=Object(q.a)(c,2),i=o[0],l=o[1],u=Object(n.useState)(""),m=Object(q.a)(u,2),d=m[0],p=m[1],h=t.filter(function(e){return"draft"!==e.number}).map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/framework/".concat(a,"/").concat(e.number)},e.number)," ",r.a.createElement("button",{className:"anchor-like",onClick:function(){p("Version: "+e.number+e.release_notes),l(!0)}},"(release notes)"))});return r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{isOpen:i,style:U},r.a.createElement("h4",null,"Release notes for ",a,"  "),L()(d),h,r.a.createElement("div",{className:"padding-top-large"},r.a.createElement("button",{className:"button",onClick:function(){p(""),l(!1)}},"Close"))),r.a.createElement("div",{className:"callout"},r.a.createElement("h5",null,"Framework versions"),0===t.length?"No previous versions":r.a.createElement("ul",null,h)))},V=a(28),B=function(){function e(){if(Object(d.a)(this,e),e.instance)return this.instance;e.instance=this}return Object(p.a)(e,[{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hal+json",t=window.localStorage.getItem("csrf_token");return"json"===e?{Accept:"application/json","Content-Type":"application/json","X-CSRF-Token":t,Authorization:"Basic"}:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":t,Authorization:"Basic"}}}]),e}(),P=a(50),H=a.n(P),W="https://live-competency-mapper.pantheonsite.io";H.a.defaults.baseURL=W;var K=function(){function e(){if(Object(d.a)(this,e),this.headers=new B,e.instance)return e.instance;e.instance=this}return Object(p.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?H.a.get(e,{headers:this.headers.get(t),withCredentials:!0}):H.a.get(e)}},{key:"post",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hal+json";return H.a.post(e,t,{headers:this.headers.get(a),withCredentials:!0})}},{key:"patch",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hal+json";return H.a.patch(e,t,{headers:this.headers.get(a),withCredentials:!0})}}]),e}(),z=function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,null,[{key:"createCompetency",value:function(e){var t,a,n=e.description,r=e.domainId,c=e.domainUuid,o=e.mapping,s=void 0===o?"":o,i=e.draftId,l=e.draftUuid;return{_links:(t={type:{href:"".concat(W,"/rest/type/node/competency")}},Object(O.a)(t,"".concat(W,"/rest/relation/node/competency/field_domain"),{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")}),Object(O.a)(t,"".concat(W,"/rest/relation/node/competency/field_versions"),[{href:"http://local.competency-mapper/taxonomy/term/".concat(i,"?_format=hal_json")}]),t),title:[{value:n}],type:[{target_id:"competency"}],field_map_other_competency:[{value:s}],_embedded:(a={},Object(O.a)(a,"".concat(W,"/rest/relation/node/competency/field_versions"),[{_links:{self:{href:"".concat(W,"/taxonomy/term/").concat(i,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/taxonomy_term/version")}},uuid:[{value:l}]}]),Object(O.a)(a,"".concat(W,"/rest/relation/node/competency/field_domain"),[{_links:{self:{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/domain")}},uuid:[{value:c}],lang:"en"}]),a)}}},{key:"createAttribute",value:function(e){var t,a,n=e.description,r=e.attributeTypeId,c=e.attributeTypeUuid,o=e.competencyId,s=e.competencyUuid,i=e.draftId,l=e.draftUuid;return{_links:(t={type:{href:"".concat(W,"/rest/type/node/attribute")}},Object(O.a)(t,"".concat(W,"/rest/relation/node/attribute/field_competency"),{href:"".concat(W,"/node/").concat(o,"?_format=hal_json")}),Object(O.a)(t,"".concat(W,"/rest/relation/node/attribute/field_attribute_type"),{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")}),Object(O.a)(t,"".concat(W,"/rest/relation/node/competency/field_versions"),[{href:"http://local.competency-mapper/taxonomy/term/".concat(i,"?_format=hal_json")}]),t),title:[{value:n}],type:[{target_id:"attribute"}],_embedded:(a={},Object(O.a)(a,"".concat(W,"/rest/relation/node/competency/field_versions"),[{_links:{self:{href:"".concat(W,"/taxonomy/term/").concat(i,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/taxonomy_term/version")}},uuid:[{value:l}]}]),Object(O.a)(a,"".concat(W,"/rest/relation/node/attribute/field_competency"),[{_links:{self:{href:"".concat(W,"/node/").concat(o,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/competency")}},uuid:[{value:s}],lang:"en"}]),Object(O.a)(a,"".concat(W,"/rest/relation/node/attribute/field_attribute_type"),[{_links:{self:{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/attribute_type")}},uuid:[{value:c}],lang:"en"}]),a)}}},{key:"mutateCompetency",value:function(t,a){return e.mutate(t,a,"competency")}},{key:"mutateAttribute",value:function(t,a){return e.mutate(t,a,"attribute")}},{key:"mutate",value:function(e,t,a){var n;return n={_links:{type:{href:"".concat(W,"/rest/type/node/").concat(a)}}},Object(O.a)(n,e,[{value:t}]),Object(O.a)(n,"type",[{target_id:a}]),n}},{key:"publishFramework",value:function(e,t,a){return{type:[{target_id:"article"}],title:[{value:e}],field_parent:[{value:e}],field_release_notes:[{value:a}],field_item:[{value:t}]}}},{key:"createDraftFramework",value:function(e){return{type:[{target_id:"article"}],title:[{value:"draft"}],field_parent:[{value:e}]}}},{key:"toggleArchivingVersionedNode",value:function(e,t){return{type:[{target_id:"article"}],field_parent:[{value:e}],field_item:[{value:t}]}}},{key:"updateReleaseNotes",value:function(e){return{_links:{type:{href:"".concat(W,"/rest/type/taxonomy_term/version")}},vid:[{target_id:"version"}],field_release_notes:[{value:e}]}}}]),e}(),J=function(){function e(){if(Object(d.a)(this,e),this.http=new K,e.instance)return this.instance;e.instance=this}return Object(p.a)(e,[{key:"getFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/v1/framework/".concat(t,"?_format=json"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getVersionedDraftFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/".concat(t,"/edit?_format=json"),"json");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getVersionedFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/".concat(t,"/").concat(a,"?_format=json"));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAllFrameworks",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/v1/framework?_format=json");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAllVersionedFrameworks",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/version_manager?_format=json&timestamp=".concat(Date.now()));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/node?_format=hal_json",z.createAttribute(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/node?_format=hal_json",z.createCompetency(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"patchCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.mutateCompetency(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"toggleArchivingVersionedNode",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/api/".concat(t,"/edit?_format=json"),z.toggleArchivingVersionedNode(t,a),"json");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"patchAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.mutateAttribute(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"publishFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/api/version_manager?_format=json",z.publishFramework(t,a,n),"json");case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"createDraftFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/api/version_manager?_format=json",z.createDraftFramework(t),"json");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateReleaseNotes",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/taxonomy/term/".concat(a,"?_format=hal_json"),z.updateReleaseNotes(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),X=function(){function e(){if(Object(d.a)(this,e),this.counter=0,this.callbacks=[],e.instance)return e.instance;e.instance=this}return Object(p.a)(e,[{key:"isActive",get:function(){return!!this.counter}}]),Object(p.a)(e,[{key:"addEventListener",value:function(e){return this.callbacks.push(e)}},{key:"removeEventListener",value:function(e){return delete this.callbacks[e-1]}},{key:"startRequest",value:function(){0===this.counter&&this.callbacks.forEach(function(e){return e&&e(!0)}),++this.counter}},{key:"finishRequest",value:function(){1===this.counter&&this.callbacks.forEach(function(e){return e&&e(!1)}),this.counter>0&&--this.counter}}]),e}(),$=a(52),Y=function(e){return Array.prototype.flat?e.flat():e.reduce(function(e,t){return[].concat(Object($.a)(e),Object($.a)(t))},[])},Q=new RegExp("</?.+?/?>","g"),G=/&nbsp;/g,Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.replace(Q,t).replace(G," ")},ee=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.state={framework:a.props.match.params.framework,frameworkName:"",frameworkVersion:"",frameworStatus:"",attributeTypes:[],versions:[],domainId:"",domainName:"",competencyId:a.props.match.params.cid,competencyUuid:"",competencyName:"",competencyData:[],loadingError:!1,editable:!1},a.createAttribute=function(){var e=Object(m.a)(u.a.mark(function e(t,n,r){var c,o,s,i,l,m,d,p,h;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.state,o=c.competencyId,s=c.competencyUuid,i=c.attributeTypes,l=c.versions,m=l.filter(function(e){return"draft"===e.number}),e.prev=2,a.activeRequests.startRequest(),d=i.find(function(e){return e.uuid===n}).id,p=m[0].id,h=m[0].uuid,e.next=9,a.competencyService.createAttribute({description:t,competencyId:o,competencyUuid:s,attributeTypeId:d,attributeTypeUuid:n,draftId:p,draftUuid:h});case 9:return e.next=11,a.fetchFramework();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 16:return e.prev=16,a.activeRequests.finishRequest(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[2,13,16,19]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){window.scroll(0,0),this.loadData()}},{key:"loadData",value:function(){var e=Object(m.a)(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.fetchVersions(t);case 4:return e.next=6,this.fetchFramework(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({loadingError:!0});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"fetchVersions",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,e.next=3,this.competencyService.getAllVersionedFrameworks();case 3:a=e.sent,(n=a.filter(function(e){return e.title.toLowerCase()===t})).length>0&&(r=n[0].attribute_types.map(function(e){return{description:e.title,uuid:e.uuid}}),this.setState({versions:n[0].versions.reverse(),attributeTypes:r}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r,c,o,s,i,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,a=t.framework,n=t.versions,r=t.competencyId,c=n.filter(function(e){return"live"===e.status}),o=n.filter(function(e){return"draft"===e.status}),s=[],i=!1,!o.length){e.next=12;break}return e.next=8,this.competencyService.getVersionedDraftFramework(a);case 8:s=e.sent,i=!0,e.next=16;break;case 12:if(!c.length){e.next=16;break}return e.next=15,this.competencyService.getVersionedFramework(a,c[0].number);case 15:s=e.sent;case 16:(l=this.filterByCompetencyId(s,r)).length&&this.setState({frameworkName:s[0].title,frameworkVersion:s[0].version,frameworkStatus:s[0].status,domainName:l[0].domainTitle,domainId:l[0].domainId,competencyUuid:l[0].uuid,competencyName:l[0].title,competencyData:l[0],editable:i});case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"filterByCompetencyId",value:function(e,t){return Y(e.map(function(e){return Y(e.domains.map(function(e){return e.competencies.filter(function(e){return e.id===t}).map(function(t){return t.domainTitle=e.title,t.domainId=e.nid,t})}))}))}},{key:"editAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchAttribute(t,"title",a);case 4:return e.next=6,this.fetchFramework();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"toggleArchive",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchAttribute(t,"field_archived","1"!==a);case 4:return e.next=6,this.fetchFramework();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAttributeRows",value:function(e){var t=this,a=this.state,n=a.competencyData,c=a.editable;return n.attributes.filter(function(t){return t.type===e.description}).map(function(e){return c?r.a.createElement("tr",{key:e.uuid},r.a.createElement("td",{className:"1"===e.archived?"strikeout":""},r.a.createElement(C,{text:e.title,change:function(a){return t.editAttribute(e.id,a)},editable:"1"!==e.archived})),r.a.createElement("td",null,r.a.createElement("button",{className:"cursor",onClick:function(){return t.toggleArchive(e.id,e.archived)}},"1"===e.archived?r.a.createElement("span",{className:"fas fa-toggle-on"},r.a.createElement("span",null,"Archived")):r.a.createElement("span",{className:"fas fa-toggle-off"})))):"1"===e.archived?null:r.a.createElement("tr",{key:e.uuid},r.a.createElement("td",{className:"1"===e.archived?"strikeout":""},r.a.createElement(C,{text:e.title,change:function(a){return t.editAttribute(e.id,a)},editable:c})))})}},{key:"getAttributeList",value:function(){var e=this,t=this.state,a=t.attributeTypes,n=t.editable;return a.map(function(t){return r.a.createElement(r.a.Fragment,{key:t.uuid},r.a.createElement("tr",{className:"secondary-background-important white-color"},r.a.createElement("td",null,r.a.createElement("strong",null,r.a.createElement("em",null,t.description))),n&&r.a.createElement("td",{className:"small-1"},"Archive")),e.getAttributeRows(t))})}},{key:"render",value:function(){var e=this.state,t=e.framework,a=e.frameworkName,n=e.frameworkVersion,c=e.frameworkStatus,o=e.attributeTypes,i=e.versions,l=e.domainId,u=e.domainName,m=e.competencyName,d=e.competencyData,p=e.loadingError,h=e.editable;return p?r.a.createElement(A,null):0===d.length?null:r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,"Manage attributes"),r.a.createElement("h4",null,r.a.createElement(s.b,{to:"/framework/".concat(t,"/manage/competencies")},a)," / ",r.a.createElement(s.b,{to:"/framework/".concat(t,"/manage/competencies/").concat(l)},u)," / ",m),r.a.createElement("p",null,r.a.createElement("span",{className:"tag"},n),r.a.createElement("span",{className:"tag secondary-background"},""===c?"draft":c)),h&&r.a.createElement(D,{title:"Create new attribute",placeholder:"Attribute description",options:o,onCreate:this.createAttribute}),r.a.createElement("table",null,r.a.createElement("tbody",null,this.getAttributeList())),r.a.createElement(M,{framework:t,versions:i}))}}]),t}(r.a.Component),te=Object(V.withSnackbar)(ee),ae=a(19),ne=a.n(ae),re=function(e){var t=e.release,a=e.updateNotes,c=e.createDraft,o=e.versions,s=e.editable,i=o.reduce(function(e,t){return"live"===t.status?t.number:e},""),l=o.reduce(function(e,t){return"draft"===t.number?t.release_notes:e},""),u=Object(n.useState)(""),m=Object(q.a)(u,2),d=m[0],p=m[1],h=Object(n.useState)(l),f=Object(q.a)(h,2),v=f[0],g=f[1],b=Object(n.useState)(!1),y=Object(q.a)(b,2),k=y[0],E=y[1],w=Object(n.useState)(!1),j=Object(q.a)(w,2),O=j[0],_=j[1],S=function(){p(""),E(!1)};return s?r.a.createElement("div",null,r.a.createElement(F.a,{isOpen:O},r.a.createElement(ne.a,{content:v,events:{change:function(e){return g(e.editor.getData())}}}),r.a.createElement("div",{className:"padding-top-large"},r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:function(){g(l),_(!1)}},"Close")),r.a.createElement("button",{className:"button",onClick:function(){a(v),_(!1)}},"Save"))),r.a.createElement(F.a,{isOpen:k},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=v.trim();k&&d&&a&&(t(d,a),S())}},r.a.createElement("label",null,"Version"," ",i?"(live version ".concat(i,")"):"(no live version)",r.a.createElement("input",{type:"text",placeholder:"1.0.0",value:d,required:!0,onChange:function(e){return p(e.currentTarget.value.trim())}})),r.a.createElement(ne.a,{content:v,events:{change:function(e){return g(e.editor.getData())}}}),r.a.createElement("div",{className:"padding-top-large"},r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:S},"Cancel")),r.a.createElement("button",{className:"button",type:"submit"},"Publish")))),r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:function(){return E(!0)}},"Release new version")),r.a.createElement("button",{className:"button",onClick:function(){return _(!0)}},"Update release notes")):r.a.createElement("div",null,r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:function(){return c()}},"Create draft")))},ce=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.state={framework:"",frameworkName:"",frameworkData:[],frameworkVersion:"",frameworkVersionId:"",frameworkStatus:"",competencyTypes:[],versions:[],loadingError:!1,editable:!1},a.createCompetency=function(){var e=Object(m.a)(u.a.mark(function e(t,n,r){var c,o,s,i,l,m,d,p;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.state,o=c.framework,s=c.frameworkData,i=c.versions,l=i.filter(function(e){return"draft"===e.number}),e.prev=2,a.activeRequests.startRequest(),m=s[0].domains.find(function(e){return e.uuid===n}).nid,d=l[0].id,p=l[0].uuid,e.next=9,a.competencyService.createCompetency({description:t,domainId:m,domainUuid:n,mapping:r,draftId:d,draftUuid:p});case 9:return e.next=11,a.fetchFramework(o);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 16:return e.prev=16,a.activeRequests.finishRequest(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[2,13,16,19]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.releaseNewVersion=function(){var e=Object(m.a)(u.a.mark(function e(t,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.state.framework,e.prev=1,a.activeRequests.startRequest(),e.next=5,a.competencyService.publishFramework(r,t,n);case 5:a.loadData(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,a.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateNotes=function(){var e=Object(m.a)(u.a.mark(function e(t){var n,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,r=n.framework,c=n.frameworkVersionId,e.prev=1,a.activeRequests.startRequest(),e.next=5,a.competencyService.updateReleaseNotes(t,c);case 5:a.loadData(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,a.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])}));return function(t){return e.apply(this,arguments)}}(),a.createDraft=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.framework,e.prev=1,a.activeRequests.startRequest(),e.next=5,a.competencyService.createDraftFramework(t);case 5:a.loadData(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,a.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])})),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params,a=t.framework,n=t.domainId,e.next=3,this.loadData(a);case 3:n&&setTimeout(function(){var e=r.refs[n];e&&e.scrollIntoView()},100);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n,r,c,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state,r=n.framework,c=n.frameworkData,o=n.loadingError,r!==a.framework&&(0!==c.length||o||this.loadData(r));case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"loadData",value:function(){var e=Object(m.a)(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.fetchVersions(t);case 4:return e.next=6,this.fetchFramework(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({loadingError:!0});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"fetchVersions",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.competencyService.getAllVersionedFrameworks();case 2:a=e.sent,(n=a.filter(function(e){return e.title.toLowerCase()===t})).length>0&&this.setState({versions:n[0].versions.reverse()});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n,r,c,o,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state.versions,n=a.filter(function(e){return"live"===e.status}),r=a.filter(function(e){return"draft"===e.status}),c=[],o=!1,!r.length){e.next=13;break}return e.next=8,this.competencyService.getVersionedDraftFramework(t);case 8:c=e.sent,this.setState({frameworkVersionId:r[0].id}),o=!0,e.next=17;break;case 13:if(!n.length){e.next=17;break}return e.next=16,this.competencyService.getVersionedFramework(t,n[0].number);case 16:c=e.sent;case 17:c.length&&(s=c[0].domains.map(function(e){return{description:e.title,uuid:e.uuid}}),this.setState({frameworkName:c[0].title,frameworkData:c,frameworkVersion:c[0].version,frameworkStatus:c[0].status,competencyTypes:s,editable:o}));case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"editCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.framework,e.prev=1,this.activeRequests.startRequest(),e.next=5,this.competencyService.patchCompetency(t,"title",a);case 5:return e.next=7,this.fetchFramework(n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"toggleArchive",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.framework,e.prev=1,this.activeRequests.startRequest(),e.next=5,this.competencyService.toggleArchivingVersionedNode(n,t);case 5:return e.next=7,this.fetchFramework(n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getCompetencyList",value:function(){var e=this,t=this.state,a=t.frameworkData,n=t.editable;return a[0].domains.map(function(t){return r.a.createElement(r.a.Fragment,{key:t.nid},r.a.createElement("tr",{className:"secondary-background-important white-color",ref:t.nid},r.a.createElement("td",null,r.a.createElement("h4",null,t.title)),n&&r.a.createElement("td",{className:"small-1"},"Archive"),r.a.createElement("td",null,"Attributes")),e.getCompetencyRows(t.competencies))})}},{key:"getCompetencyRows",value:function(e){var t=this,a=this.state,n=a.framework,c=a.editable;return e.map(function(e){return c?r.a.createElement("tr",{key:e.id},r.a.createElement("td",{className:"1"===e.archived?"strikeout":""},r.a.createElement(C,{text:e.title,change:function(a){return t.editCompetency(e.id,a)},editable:"1"!==e.archived})),r.a.createElement("td",null,r.a.createElement("button",{className:"cursor",onClick:t.toggleArchive.bind(t,e.id,e.archived)},"1"===e.archived?r.a.createElement("span",{className:"fas fa-toggle-on"},r.a.createElement("span",null,"Archived")):r.a.createElement("span",{className:"fas fa-toggle-off"}))),r.a.createElement("td",null,r.a.createElement(s.b,{to:"/framework/".concat(n,"/manage/competencies/").concat(e.id,"/manage-attributes")},r.a.createElement("i",{className:"fas fa-sitemap"})))):"1"===e.archived?null:r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(C,{text:e.title,change:function(a){return t.editCompetency(e.id,a)},editable:c})),r.a.createElement("td",null,r.a.createElement(s.b,{to:"/framework/".concat(n,"/manage/competencies/").concat(e.id,"/manage-attributes")},r.a.createElement("i",{className:"fas fa-sitemap"}))))})}},{key:"render",value:function(){var e=this.state,t=e.framework,a=e.frameworkName,n=e.frameworkData,c=e.frameworkVersion,o=e.frameworkStatus,s=e.competencyTypes,i=e.versions,l=e.loadingError,u=e.editable;return l?r.a.createElement(A,null):0===n.length?null:r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,"Manage framework"),r.a.createElement("h4",null,a),r.a.createElement("p",null,r.a.createElement("span",{className:"tag"},c),r.a.createElement("span",{className:"tag secondary-background"},""===o?"draft":o)),r.a.createElement(re,{editable:u,createDraft:this.createDraft,versions:i,release:this.releaseNewVersion,updateNotes:this.updateNotes}),u&&r.a.createElement(D,{title:"Create new competency",placeholder:"Competency description",options:s,onCreate:this.createCompetency,showMappingField:!0}),r.a.createElement("table",null,r.a.createElement("tbody",null,this.getCompetencyList())),r.a.createElement(M,{framework:t,versions:i}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.match.params.framework;return a!==t.framework?{framework:a,frameworkData:[],loadingError:!1}:null}}]),t}(r.a.Component),oe=Object(V.withSnackbar)(ce),se=a(45),ie=function(){function e(){if(Object(d.a)(this,e),this.http=new K,e.instance)return this.instance;e.instance=this}return Object(p.a)(e,[{key:"getCourses",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("".concat("https://live-competency-mapper.pantheonsite.io","/api/resources?_format=json"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),le=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.coursesService=new ie,a.state={framework:a.props.match.params.framework,version:a.props.location.pathname.split("/"),frameworkData:[],competencyId:a.props.match.params.cid,attributeDefs:[],resources:[]},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,Promise.all([this.getFramework(),this.getAttributes(),this.getResources()]);case 4:return e.prev=4,this.activeRequests.finishRequest(),e.finish(4);case 7:case"end":return e.stop()}},e,this,[[0,,4,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"getFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,a=this.state.version,e.next=4,this.competencyService.getVersionedFramework(t,a[3]);case 4:n=e.sent,this.setState({frameworkData:n});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAttributes",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.competencyService.getAllFrameworks();case 2:t=e.sent,a=this.state.framework,(n=t.filter(function(e){return e.name.toLowerCase()===a})).length&&(r=n[0].attribute_types.map(function(e){return e.title}),this.setState({attributeDefs:r}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getResources",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.coursesService.getCourses();case 3:t=e.sent,a=t.filter(function(e){return!!e.competency_profile.find(function(e){return!!e.domains.find(function(e){return!!e.competencies.find(function(e){return e.id===n.state.competencyId})})})}),this.setState({resources:a}),this.setState({resources:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to retrieve training resources",{variant:"error"});case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"resourceBlock",value:function(){return this.state.resources.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/training-resources/".concat(e.id)},e.title))})}},{key:"render",value:function(){var e=this,t=this.state,a=t.competencyId,n=t.frameworkData,c=t.attributeDefs,o=t.resources,s=[];n.forEach(function(e){return e.domains.forEach(function(t){return t.competencies.forEach(function(n){n.id===a&&s.push(Object(se.a)({},n,{framework:e.title,domain:t.title}))})})});var i=s.map(function(t){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("h4",null," ",t.framework," / ",t.domain),r.a.createElement("h4",null,t.title))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-8"},r.a.createElement("ul",null,c.map(function(e){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"margin-top-medium"}," ",r.a.createElement("strong",null,r.a.createElement("em",null,e))),t.attributes.map(function(t){return t.type===e?r.a.createElement("li",{key:t.id},t.title," "):null}))}))),r.a.createElement("div",{className:"column large-4"},r.a.createElement("div",{className:"callout notice industry-background white-color"},r.a.createElement("p",null,"Competency derived from:"),r.a.createElement("p",null," ",t.mapped_other_competency?t.mapped_other_competency:"No data available"," ")),0===o.length?null:r.a.createElement("div",{className:"callout notice training-background white-color"},r.a.createElement("p",null,"Training resources mapped to this competency"),r.a.createElement("ul",null,e.resourceBlock())))))});return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("h3",null,"Competency details"),i))}}]),t}(r.a.Component),ue=Object(V.withSnackbar)(le),me=a(46),de=(a(169),a(95)),pe=a.n(de),he=a(190);a(170);function fe(e){e.index;var t=e.framework,a=e.competency,n=(e.disable,e.version),c=Object(he.a)(a.attributes,"type"),o=Object.keys(c).map(function(e){var t=c[e].map(function(e){return r.a.createElement("li",{key:e.id},e.title)});return r.a.createElement("div",{key:e},r.a.createElement("em",null,e),r.a.createElement("ul",null,t))});return"1"===a.archived?null:r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(pe.a,{trigger:r.a.createElement("div",{className:"open-close-title"},r.a.createElement("span",null,a.title),r.a.createElement("span",{className:"icon icon-common icon-plus float-right"},r.a.createElement("p",{className:"show-for-sr"},"show more"))),triggerWhenOpen:r.a.createElement("div",{className:"open-close-title"},r.a.createElement("span",null,a.title),r.a.createElement("span",{className:"icon icon-common icon-minus float-right"},r.a.createElement("p",{className:"show-for-sr"},"show less")))},r.a.createElement("div",{className:"padding-left-large padding-top-large"},r.a.createElement(s.b,{to:"/framework/".concat(t,"/").concat(n,"/competency/details/").concat(a.id)},r.a.createElement("span",{className:"float-right"},r.a.createElement("i",{className:"icon icon-spacer icon-common icon-info"}),"More details")),o))))}fe.defaultProps={parentIndex:0,index:0,disable:!0};var ve=fe;function ge(e){e.index;var t=e.framework,a=e.domain,n=e.disable,c=e.version,o=a.competencies.map(function(e,a){return r.a.createElement(ve,{key:e.id,index:a,framework:t,competency:e,disable:n,version:c})});return r.a.createElement("tbody",null,r.a.createElement("tr",{className:"white-color secondary-background"},r.a.createElement("td",null,r.a.createElement("h4",null," ",a.title))),o)}ge.defaultProps={domain:{title:"",competencies:[]},disable:!0};var be=ge,ye=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={courses:[],filteredCourses:[],filter:"",loadingError:!1},a.coursesService=new ie,a.activeRequests=new X,a.onFilter=function(e){var t,n=a.state.courses;try{t=new RegExp(e,"i")}catch(c){t=/./}var r=n.filter(function(e){return t.test(e.title)});a.setState({filteredCourses:r,filter:e})},a.state.framework=e.framework,a.state.version=e.version,a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.coursesService.getCourses();case 4:t=e.sent,a=this.filterCourses(t),this.setState({courses:a,filteredCourses:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.setState({loadingError:!0});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[0,9,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"filterCourses",value:function(e){var t=this.state.framework,a=(this.state.version,[]);return e.forEach(function(e){if("1"!==e.archived){var n=e.competency_profile.filter(function(e){return(e.title||"").toLowerCase()===t});if(0!==n.length){var r=Object(se.a)({},e,{competencies:Y(n.map(function(e){return Y(e.domains.map(function(e){return e.competencies.map(function(t){return Object(se.a)({},t,{domain:e.title})})}))}))});a.push(r)}}}),a}},{key:"render",value:function(){var e=this,t=this.state,a=t.filteredCourses,n=t.framework,c=t.filter,o=t.loadingError,i=t.version;if(o)return r.a.createElement(A,null);var l=a.map(function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(s.b,{to:"/training-resources/".concat(e.id)},e.title)),r.a.createElement("td",null,e.type),r.a.createElement("td",null,r.a.createElement("ul",null,e.competencies.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/framework/".concat(n,"/").concat(i,"/competency/details/").concat(e.id)},e.title))}))))});return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"search",value:c,onChange:function(t){return e.onFilter(t.target.value)},placeholder:"Filter resources"}),r.a.createElement("table",null,r.a.createElement("tbody",null,l)))}}]),t}(n.Component),ke=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).competencyService=new J,a.activeRequests=new X,a.state={framework:"",frameworkVersion:"",frameworkName:"",frameworkStatus:"",frameworkDescription:"",versions:[],domains:[],filter:"",filteredDomains:[],loadingError:!1},a.onFilter=function(e){var t,n=a.state.domains;try{t=new RegExp(e,"i")}catch(c){t=/./}var r=n.map(function(e){var a=e.competencies.filter(function(e){return t.test(e.title)});return 0===a.length?null:Object(se.a)({},e,{competencies:a})});a.setState({filter:e,filteredDomains:r})},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params,a=t.framework,n=t.version,e.prev=1,this.activeRequests.startRequest(),e.next=5,Promise.all([this.fetchFramework(a,n),this.fetchVersions(a)]);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.setState({loadingError:!0});case 10:return e.prev=10,this.activeRequests.finishRequest(),e.finish(10);case 13:case"end":return e.stop()}},e,this,[[1,7,10,13]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n,r,c,o,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,r=n.framework,c=n.frameworkVersion,o=n.domains,s=n.loadingError,r===a.framework&&c===a.frameworkVersion){e.next=15;break}if(0!==o.length||s){e.next=15;break}return e.prev=3,this.activeRequests.startRequest(),e.next=7,this.fetchFramework(r,c);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),this.setState({loadingError:!0});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[3,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n,r,c,o,s,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.scroll(0,0),e.next=3,this.competencyService.getVersionedFramework(t,a);case 3:return n=e.sent,r=Y(n.map(function(e){return e.domains})),c=Z(n[0].description),this.setState({frameworkName:n[0].title,frameworkDescription:c,domains:r,filteredDomains:r}),e.next=9,this.competencyService.getAllVersionedFrameworks();case 9:o=e.sent,(s=o.filter(function(e){return e.title.toLowerCase()===t})).length>0&&(i=s[0].versions.filter(function(e){return e.number==a}),this.setState({frameworkStatus:i[0].status}));case 12:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchVersions",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.competencyService.getAllVersionedFrameworks();case 2:a=e.sent,(n=a.filter(function(e){return e.title.toLowerCase()===t})).length>0&&this.setState({versions:n[0].versions.reverse()});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.framework,n=t.frameworkVersion,c=t.frameworkName,o=t.frameworkStatus,s=t.frameworkDescription,i=t.filteredDomains,l=t.versions,u=t.filter;if(t.loadingError)return r.a.createElement(A,null);var m=i.map(function(e){return null===e?null:r.a.createElement(be,{key:e.nid,framework:a,domain:e,disable:!0,version:n})});return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,c),r.a.createElement("p",null,r.a.createElement("span",{className:"tag"},n),r.a.createElement("span",{className:"tag secondary-background"}," ",o)),r.a.createElement("p",null,s),r.a.createElement(me.d,null,r.a.createElement(me.b,null,r.a.createElement(me.a,null,"Competencies"),r.a.createElement(me.a,null,"Training resources")),r.a.createElement(me.c,null,r.a.createElement("input",{type:"search",value:u,onChange:function(t){return e.onFilter(t.target.value)},placeholder:"Filter competencies"}),r.a.createElement("table",null,m),r.a.createElement(M,{framework:a,versions:l})),r.a.createElement(me.c,null,r.a.createElement(ye,{framework:a,version:n}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.match.params,n=a.framework,r=a.version;return n!==t.framework||r!==t.frameworkVersion?{framework:n,frameworkVersion:r,domains:[],loadingError:!1}:null}}]),t}(n.Component),Ee=a(12),we=a(13),je=a.n(we),Oe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={data:[],csrf:"",updateFlag:!1,path:a.props.location.pathname.split("/"),nid:"",title:"",dates:"",dates2:"",type:"",description:"",location:"",url:"",target_audience:"",learning_outcomes:"",keywords:"",organisers:"",trainers:""},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"changeDescription",value:function(e){var t=e.editor.getData();this.setState({description:t})}},{key:"changeTargetAudience",value:function(e){var t=e.editor.getData();this.setState({target_audience:t})}},{key:"changeLearningOutcomes",value:function(e){var t=e.editor.getData();this.setState({learning_outcomes:t})}},{key:"changeOrganisers",value:function(e){var t=e.editor.getData();this.setState({organisers:t})}},{key:"changeTrainers",value:function(e){var t=e.editor.getData();this.setState({trainers:t})}},{key:"componentDidMount",value:function(){var e=this;this.setState({nid:this.state.path[3]});var t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(W,"/api/v1/training-resources/all?_format=json");fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({data:t})})}},{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"render",value:function(){var e=this;this.checkUser();var t="",a="",n="",c="",o="",s="",i="",l="",u="",m="",d="",p="",h="";return this.state.data.forEach(function(r){r.id===e.state.nid&&(t=r.id,a=r.title,n=r.start_date,c=r.end_date,o=r.type,s=r.description,i=r.location,l=r.url,u=r.target_audience,m=r.learning_outcomes,d=r.keywords,p=r.organisers,h=r.trainers)}),this.state.data.length>0?(console.log(a),r.a.createElement(_e,{nid:t,title:a,dates:n,dates2:c,type:o,description:s,location:i,url:l,target_audience:u,learning_outcomes:m,keywords:d,organisers:p,trainers:h})):null}}]),t}(r.a.Component),_e=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).setRedirect=function(){a.props.history.push("all-training-resources")},a.state={nid:a.props.nid,title:a.props.title,dates:a.props.dates,dates2:a.props.dates2,type:a.props.type,description:a.props.description,location:a.props.location,url:a.props.url,target_audience:a.props.target_audience,learning_outcomes:a.props.learning_outcomes,keywords:a.props.keywords,organisers:a.props.organisers,trainers:a.props.trainers,redirect:!1,updateFlag:!1,csrf:""},a.handleTitle=a.handleTitle.bind(Object(Ee.a)(a)),a.handleDates=a.handleDates.bind(Object(Ee.a)(a)),a.handleDates2=a.handleDates2.bind(Object(Ee.a)(a)),a.handleType=a.handleType.bind(Object(Ee.a)(a)),a.handleDesc=a.handleDesc.bind(Object(Ee.a)(a)),a.handleLocation=a.handleLocation.bind(Object(Ee.a)(a)),a.handleURL=a.handleURL.bind(Object(Ee.a)(a)),a.handleTargetAudience=a.handleTargetAudience.bind(Object(Ee.a)(a)),a.handleLearningOutcomes=a.handleLearningOutcomes.bind(Object(Ee.a)(a)),a.handleKeywords=a.handleKeywords.bind(Object(Ee.a)(a)),a.handleOrganisers=a.handleOrganisers.bind(Object(Ee.a)(a)),a.handleTrainers=a.handleTrainers.bind(Object(Ee.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})})}},{key:"handleTitle",value:function(e){this.setState({title:e.value})}},{key:"handleDates",value:function(e){this.setState({dates:e.value})}},{key:"handleDates2",value:function(e){this.setState({dates2:e.value})}},{key:"handleType",value:function(e){this.setState({type:e.value})}},{key:"handleDesc",value:function(e){this.setState({description:e.editor.getData()})}},{key:"handleLocation",value:function(e){this.setState({location:e.value})}},{key:"handleURL",value:function(e){this.setState({url:e.value})}},{key:"handleTargetAudience",value:function(e){this.setState({target_audience:e.editor.getData()})}},{key:"handleLearningOutcomes",value:function(e){this.setState({learning_outcomes:e.editor.getData()})}},{key:"handleKeywords",value:function(e){this.setState({keywords:e.value})}},{key:"handleOrganisers",value:function(e){this.setState({organisers:e.editor.getData()})}},{key:"handleTrainers",value:function(e){this.setState({trainers:e.editor.getData()})}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(setTimeout(function(){a.context.router.history.push("/training-resources/"+a.state.nid)},1e3),console.log("componentDidUpdate"))}},{key:"handleSubmit",value:function(e){var t=this.state.nid,a=this.refs.title.value,n=this.refs.dates.value,r=this.refs.dates2.value,c=this.refs.type.value,o=this.state.description,s=this.refs.location.value,i=this.refs.url.value,l=this.state.target_audience,u=this.state.learning_outcomes,m=this.state.organisers,d=this.state.trainers,p=this.refs.keywords.value,h=localStorage.getItem("csrf_token");fetch("".concat(W,"/node/")+t+"?_format=hal_json",{method:"PATCH",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":h,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/node/training_resource")}},title:[{value:a}],field_dates:[{value:n}],field_end_date:[{value:r}],field_type:[{value:c}],field_description:[{value:o,format:"basic_html"}],field_location:[{value:s}],field_url:[{value:i}],field_target_audience:[{value:l,format:"basic_html"}],field_learning_outcomes:[{value:u,format:"basic_html"}],field_keywords:[{value:p}],field_organisers:[{value:m,format:"basic_html"}],field_trainers:[{value:d,format:"basic_html"}],type:[{target_id:"training_resource"}]})}),e.preventDefault(),this.setState({updateFlag:!0})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Edit Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12 callout"},r.a.createElement("form",{className:"form",id:"resource_edit_form",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Title"),r.a.createElement("input",{type:"text",ref:"title",id:"title",value:this.state.title,onChange:this.handleTitle.bind(this),required:!0,placeholder:"Title"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Dates"),r.a.createElement("input",{type:"date",ref:"dates",value:this.state.dates,onChange:this.handleDates.bind(this),placeholder:"Date"})),r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Dates"),r.a.createElement("input",{type:"date",ref:"dates2",value:this.state.dates2,onChange:this.handleDates2.bind(this),placeholder:"Date"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Event type"),r.a.createElement("select",{ref:"type",value:this.state.type,onChange:this.handleType.bind(this)},r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Description"),r.a.createElement(ne.a,{content:this.state.description,events:{change:this.handleDesc},activeClass:"p10",required:!0}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Location"),r.a.createElement("input",{type:"text",ref:"location",value:this.state.location,onChange:this.handleLocation.bind(this),placeholder:"Location"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"URL"),r.a.createElement("input",{type:"text",ref:"url",value:this.state.url,onChange:this.handleURL.bind(this),required:!0,placeholder:"URL"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Target audience"),r.a.createElement(ne.a,{content:this.state.target_audience,events:{change:this.handleTargetAudience},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Learning outcomes"),r.a.createElement(ne.a,{content:this.state.learning_outcomes,events:{change:this.handleLearningOutcomes},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Organisers"),r.a.createElement(ne.a,{content:this.state.organisers,events:{change:this.handleOrganisers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Trainers"),r.a.createElement(ne.a,{content:this.state.trainers,events:{change:this.handleTrainers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Keywords"),r.a.createElement("input",{type:"text",ref:"keywords",value:this.state.keywords,onChange:this.handleKeywords.bind(this),placeholder:"Keywords"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Update"})))))))}}]),t}(r.a.Component);_e.contextTypes={router:je.a.object};var Se=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resource/edit/:nid",component:Oe}))},Ne=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).changeDescription=a.changeDescription.bind(Object(Ee.a)(a)),a.changeTargetAudience=a.changeTargetAudience.bind(Object(Ee.a)(a)),a.changeLearningOutcomes=a.changeLearningOutcomes.bind(Object(Ee.a)(a)),a.changeOrganisers=a.changeOrganisers.bind(Object(Ee.a)(a)),a.changeTrainers=a.changeTrainers.bind(Object(Ee.a)(a)),a.state={data:[],csrf:"",updateFlag:!1,content:"content",description:"",target_audience:"",learning_outcomes:"",organisers:"",trainers:""},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"changeDescription",value:function(e){var t=e.editor.getData();this.setState({description:t})}},{key:"changeTargetAudience",value:function(e){var t=e.editor.getData();this.setState({target_audience:t})}},{key:"changeLearningOutcomes",value:function(e){var t=e.editor.getData();this.setState({learning_outcomes:t})}},{key:"changeOrganisers",value:function(e){var t=e.editor.getData();this.setState({organisers:t})}},{key:"changeTrainers",value:function(e){var t=e.editor.getData();this.setState({trainers:t})}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(setTimeout(function(){a.props.history.push("/all-training-resources")},1e3),console.log("componentDidUpdate"))}},{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"componentDidMount",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})})}},{key:"handleSubmit",value:function(e){var t=this.refs.title.value,a=this.refs.dates.value,n=this.refs.dates2.value,r="Online";this.refs.type.value&&(r=this.refs.type.value);var c=this.state.description,o=this.refs.location.value,s=this.refs.url.value,i=this.state.target_audience,l=this.state.learning_outcomes,u=this.refs.keywords.value,m=this.state.organisers,d=this.state.trainers,p=localStorage.getItem("csrf_token");fetch("".concat(W,"/node?_format=hal_json"),{credentials:"include",method:"POST",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":p,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/node/training_resource")}},title:[{value:t}],field_dates:[{value:a}],field_end_date:[{value:n}],field_type:[{value:r}],field_description:[{value:c,format:"basic_html"}],field_location:[{value:o}],field_url:[{value:s}],field_target_audience:[{value:i,format:"basic_html"}],field_learning_outcomes:[{value:l,format:"basic_html"}],field_keywords:[{value:u}],field_organisers:[{value:m,format:"basic_html"}],field_trainers:[{value:d,format:"basic_html"}],type:[{target_id:"training_resource"}]})}),e.target.reset(),this.setState({updateFlag:!0}),e.preventDefault()}},{key:"render",value:function(){return this.checkUser(),r.a.createElement("div",null,r.a.createElement("h2",null,"Create Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12 callout"},r.a.createElement("h4",null,"Create new competency"),r.a.createElement("form",{className:"form",id:"resource_create_form",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Title"),r.a.createElement("input",{type:"text",ref:"title",required:!0,placeholder:"Title"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Start Date"),r.a.createElement("input",{type:"date",ref:"dates",placeholder:"Date"})),r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"End Date"),r.a.createElement("input",{type:"date",ref:"dates2",placeholder:"Date"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Event type"),r.a.createElement("select",{ref:"type"},r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Description"),r.a.createElement(ne.a,{content:this.state.description,events:{change:this.changeDescription},activeClass:"p10",required:!0}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Location"),r.a.createElement("input",{type:"text",ref:"location",placeholder:"Location"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"URL"),r.a.createElement("input",{type:"text",ref:"url",required:!0,placeholder:"URL"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Target audience"),r.a.createElement(ne.a,{content:this.state.target_audience,events:{change:this.changeTargetAudience},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Learning outcomes"),r.a.createElement(ne.a,{content:this.state.learning_outcomes,events:{change:this.changeLearningOutcomes},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Organisers"),r.a.createElement(ne.a,{content:this.state.organisers,events:{change:this.changeOrganisers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Trainers"),r.a.createElement(ne.a,{content:this.state.trainers,events:{change:this.changeTrainers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Keywords"),r.a.createElement("input",{type:"text",ref:"keywords",placeholder:"Keywords"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))))))}}]),t}(r.a.Component),Ce=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resource/create",component:Ne}))},xe=window.$,De=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={data:[],framework:a.props.selectedFramework,resourceID:a.props.resourceID,frameworkdetails:[],csrf:"",frameworkUUID:"",competencies:[],attributes:a.props.selectedAttributes,selectedAttributes:a.props.selectedAttributes,selectedCompetencies:a.props.selectedCompetencies,resourceDetails:[]},a.handleSelect=a.handleSelect.bind(Object(Ee.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"handleSelect",value:function(){for(var e=this.state.selectedAttributes,t=[],a=localStorage.getItem("csrf_token"),n=0;n<e.length;n++)t.push(e[n].split("id",2));if(t.length>0){for(var r={_links:Object(O.a)({type:{href:"".concat(W,"/rest/type/node/training_resource")}},"".concat(W,"/rest/relation/node/training_resource/field_attribute_mapped"),{href:"http://dev-competency-mapper.pantheonsite.io/node/"+t[0][1]+"?_format=hal_json"}),type:[{target_id:"training_resource"}],_embedded:{}},c=[],o=0;o<t.length;o++)c.push({_links:{self:{href:"".concat(W,"/node/")+t[o][1]+"?_format=hal_json"},type:{href:"".concat(W,"/rest/type/node/attribute")}},uuid:[{value:t[o][0]}]});r._embedded=Object(O.a)({},"".concat(W,"/rest/relation/node/training_resource/field_attribute_mapped"),c),fetch("".concat(W,"/node/")+this.state.resourceID+"?_format=hal_json",{credentials:"include",method:"PATCH",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":a,Authorization:"Basic"},body:JSON.stringify(r)})}this.props.handleCloseModal()}},{key:"handleAllCheck",value:function(e,t,a){var n=this.state.selectedAttributes,r=document.getElementsByName(e);if(a.target.checked)for(var c=0;c<r.length;c++)r[c].checked=!0,n.push(r[c].getAttribute("data-uuid")+"id"+r[c].getAttribute("data-id")),this.setState({selectedAttributes:n}),console.log(this.state.selectedAttributes);else for(var o=0;o<r.length;o++)!0===r[o].checked&&(r[o].checked=!1,n.splice(n.indexOf(r[o]),1),this.setState({selectedAttributes:n}),console.log(this.state.selectedAttributes))}},{key:"handleAttributeClick",value:function(e,t,a){var n=this.state.selectedAttributes;a.target.checked?(n.push(t+"id"+e),this.setState({selectedAttributes:n}),document.getElementById(a.target.name).checked=!0,console.log(this.state.selectedAttributes)):(n.splice(n.indexOf(t+"id"+e),1),this.setState({selectedAttributes:n}),xe(":checkbox[name="+a.target.name+"]").is(":checked")||(document.getElementById(a.target.name).checked=!1,console.log(this.state.selectedAttributes)))}},{key:"handleListAllChecked",value:function(e){var t=[];xe(":checkbox").each(function(){xe(this).is(":checked")&&t.push(xe(this).attr("id"))}),alert(t)}},{key:"componentDidMount",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(W,"/api/v1/framework/")+this.state.framework+"?_format=json";fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({data:t})});var n="".concat(W,"/api/v1/framework?_format=json");fetch(n).then(function(e){return e.json()}).then(function(t){e.setState({frameworkdetails:t})}),fetch("".concat(W,"/node/")+this.state.resourceID+"?_format=hal_json").then(function(e){return e.json()}).then(function(t){e.setState({resourceDetails:t})})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.attributes===t.attributes}},{key:"render",value:function(){var e=this,t=this.state.frameworkdetails,a=this.state.data,n=[],c=[],o=[];t.forEach(function(t,a){t.name.toLowerCase()===e.state.framework&&(e.state.frameworkUUID=t.uuid,t.attribute_types.forEach(function(e){n.push(e.title),o.push(r.a.createElement("option",{"data-id":e.id,value:e.uuid},e.title))}),t.domains.forEach(function(e){c.push(r.a.createElement("option",{"data-id":e.id,value:e.uuid},e.title))}))});var s=a.map(function(t){return t.domains.map(function(t,a){return r.a.createElement("tbody",null,r.a.createElement("tr",{key:t.nid},r.a.createElement("td",null,a+1)," ",r.a.createElement("td",null,r.a.createElement("strong",null," ",t.title)," ")," "),t.competencies.map(function(t,c){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,a+1,".",c+1),r.a.createElement("td",null,r.a.createElement("input",{type:"checkbox",defaultChecked:-1!==e.state.selectedCompetencies.indexOf(t.id),"data-test":t.uuid,id:t.id,onChange:e.handleAllCheck.bind(e,t.id,t.uuid)})," ",t.title,r.a.createElement("ul",{style:{marginLeft:"1em",marginBottom:"1em"}},n.map(function(a){return r.a.createElement("div",{style:{marginLeft:"1em"}},r.a.createElement("div",null," ",r.a.createElement("strong",null,r.a.createElement("em",null,a))),t.attributes.filter(function(e){return e.type===a}).map(function(a){return r.a.createElement("li",{key:a.id,style:{marginLeft:"1em"}},r.a.createElement("input",{type:"checkbox",defaultChecked:-1!==e.state.selectedAttributes.indexOf(a.uuid+"id"+a.id),name:t.id,"data-id":a.id,"data-uuid":a.uuid,id:a.id,onChange:e.handleAttributeClick.bind(e,a.id,a.uuid)})," ",a.title)}))}))))}),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("td",null))))})});return r.a.createElement("div",null,s,r.a.createElement("div",{id:"footer-button"},r.a.createElement("button",{className:"button",onClick:this.handleSelect.bind(this)}," ","Save")))}}]),t}(r.a.Component),Re=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={resources:[],frameworks:[],resourcePath:a.props.location.pathname.split("/"),showModal:!1,selectedFramework:"",updateFlag:""},a.handleOpenModal=a.handleOpenModal.bind(Object(Ee.a)(a)),a.handleCloseModal=a.handleCloseModal.bind(Object(Ee.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"handleOpenModal",value:function(e,t){this.setState({showModal:!0}),this.setState({selectedFramework:e}),t.preventDefault()}},{key:"handleCloseModal",value:function(){this.setState({showModal:!1}),this.setState({updateFlag:!0})}},{key:"componentDidUpdate",value:function(){var e=this;this.state.updateFlag&&(this.fetchData(),setTimeout(function(){e.setState({updateFlag:!1})},1e3),console.log("componentDidUpdate"))}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(W,"/api/resources/?_format=json");fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({resources:t})}),fetch("".concat(W,"/api/v1/framework?_format=json")).then(function(e){return e.json()}).then(function(t){e.setState({frameworks:t})})}},{key:"mappingBlock",value:function(){var e=this;if(localStorage.getItem("roles")&&localStorage.getItem("roles").includes("content_manager"))return r.a.createElement("div",{className:"callout white-color industry-background"},r.a.createElement("strong",null," Manage competency profile "),r.a.createElement("ul",null,this.state.frameworks.map(function(t,a){return r.a.createElement("li",{style:{display:"inline",margin:"5px"}},r.a.createElement("a",{onClick:e.handleOpenModal.bind(e,t.name.toLowerCase())}," ",r.a.createElement("i",{className:"fas fa-tags"})," ",t.name," "))})))}},{key:"render",value:function(){var e=this,t=[],a=[],n=[],c=this.state.resources.map(function(c,o){return c.id===e.state.resourcePath[2]?(c.competency_profile.map(function(e){return e.domains.map(function(e){return e.competencies.map(function(e){return e.attributes.map(function(e){return t.push(e.uuid+"id"+e.id)},a.push(e.id))})})}),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,c.title)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-9"},r.a.createElement("div",{className:"callout"},c.date?r.a.createElement("p",null,r.a.createElement("strong",null,"Date:")," ",c.dates):"",c.keywords?r.a.createElement("p",null,r.a.createElement("strong",null,"Keywords:")," ",c.keywords):"",c.location?r.a.createElement("p",null,r.a.createElement("strong",null,"Location:")," ",c.location):"",c.type?r.a.createElement("p",null,r.a.createElement("strong",null,"Type:")," ",c.type):"",c.url?r.a.createElement("p",null,r.a.createElement("strong",null," URL: ")," ",r.a.createElement("a",{href:c.url,target:"_blank"},c.url)):""),r.a.createElement("h3",null,"Overview"),L()(c.description),c.target_audience?L()("<h3>Target Audience</h3>"+c.target_audience):"",c.learning_outcomes?L()("<h3>Learning Outcomes</h3>"+c.learning_outcomes):"",c.organisers?L()("<h3>Organizers</h3>"+c.organisers):"",c.trainers?L()("<h3>Trainers</h3>"+c.trainers):"",r.a.createElement("h3",null,"Competency Profile"),r.a.createElement("table",{className:"hover"},r.a.createElement("tbody",null,c.competency_profile.map(function(t){return r.a.createElement("tr",null,e.state.frameworks.map(function(e){return e.id===t.id&&e.attribute_types.map(function(e){return n.push(e.title)}),null}),r.a.createElement("td",null,r.a.createElement("h4",null,t.title)),r.a.createElement("td",null,t.domains.map(function(e){return r.a.createElement("div",null,r.a.createElement("h5",null,e.title),r.a.createElement("ul",null,e.competencies.map(function(e){return r.a.createElement("li",null,r.a.createElement("strong",null," ",e.title),r.a.createElement("ul",null,n.map(function(t){return r.a.createElement("span",null,e.attributes.map(function(e){return e.type===t?r.a.createElement("li",null," ",r.a.createElement("em",null,t)," -"," ",e.title):null}))})))})))})))})))),r.a.createElement("div",{className:"column large-3 callout industry-background white-color"},r.a.createElement("h3",null,"More information"),r.a.createElement("p",null,"No data available")))))):null});return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},c,this.mappingBlock()),r.a.createElement("div",{style:{overflow:"scroll"}},r.a.createElement(F.a,{isOpen:this.state.showModal,className:"Modal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},r.a.createElement("div",null,r.a.createElement("h2",{style:{"text-align":"center"}},"Manage competency profile for"," ",this.state.selectedFramework.toUpperCase()," ",r.a.createElement("i",{className:"fas fa-window-close float-right","data-close":!0,onClick:this.handleCloseModal})," ")),r.a.createElement("table",null,r.a.createElement(De,{selectedCompetencies:a,selectedAttributes:t,selectedFramework:this.state.selectedFramework,resourceID:this.state.resourcePath[2],handleCloseModal:this.handleCloseModal})))))}}]),t}(r.a.Component),Ae=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resources/:id",component:Re}))},qe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={resources:[],filterType:""},a.archiveHandle=a.archiveHandle.bind(Object(Ee.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(this.fetchData(),setTimeout(function(){a.setState({updateFlag:!1})},1e3),console.log("componentDidUpdate"))}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(W,"/api/v1/training-resources/all?_format=json");fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({resources:t})})}},{key:"filter",value:function(e){this.setState({filter:e.target.value})}},{key:"filterTypeHandle",value:function(e){this.setState({filterType:e.target.value})}},{key:"archiveHandle",value:function(e,t,a){var n="";n=1!==t;var r=localStorage.getItem("csrf_token");fetch("".concat(W,"/node/")+e+"?_format=hal_json",{credentials:"include",method:"PATCH",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":r,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/node/training_resource")}},field_archived:[{value:n}],type:[{target_id:"training_resource"}]})}),this.setState({updateFlag:!0}),a.preventDefault()}},{key:"render",value:function(){var e=this;this.checkUser();var t=this.state.resources;this.state.filter&&(t=t.filter(function(t){return t.title.toLowerCase().includes(e.state.filter.toLowerCase())||t.description.toLocaleLowerCase().includes(e.state.filter.toLowerCase())})),"All"!==this.state.filterType&&(t=t.filter(function(t){return t.type.toLocaleLowerCase().includes(e.state.filterType.toLowerCase())}));var a=t.map(function(t,a){return r.a.createElement("tr",{key:a},r.a.createElement("td",null,a+1," "),r.a.createElement("td",null," ",r.a.createElement("h4",null," ",r.a.createElement(s.b,{to:"/training-resources/"+t.id},t.title," ")),r.a.createElement("p",null,t.dates," "),r.a.createElement("strong",null,"Learning resource type:")," ",t.type," ",r.a.createElement("br",null),L()(t.description.substr(0,240)+"...")," ",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("strong",null," URL: ")," ",r.a.createElement("a",{href:t.url,target:"_blank"},t.url)),r.a.createElement("td",null,"1"===t.archived?r.a.createElement("a",{onClick:e.archiveHandle.bind(e,t.id,1)}," ",r.a.createElement("i",{className:"fas fa-toggle-on"})," ",r.a.createElement("span",null,"Archived")," "):r.a.createElement("a",{onClick:e.archiveHandle.bind(e,t.id,0)}," ",r.a.createElement("i",{className:"fas fa-toggle-off"}))),r.a.createElement("td",null,r.a.createElement(s.b,{to:"/training-resource/edit/".concat(t.id)},r.a.createElement("i",{className:"fas fa-edit"})," ")))});return r.a.createElement("div",{className:"row"},r.a.createElement("h3",null,"Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-8"},r.a.createElement("div",null,r.a.createElement("input",{type:"text",onChange:this.filter.bind(this),placeholder:"Type to search"}))),r.a.createElement("div",{className:"column large-2"},r.a.createElement("div",null,r.a.createElement("select",{ref:"type",onChange:this.filterTypeHandle.bind(this)},r.a.createElement("option",{value:"All"},"All"),r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"column large-2"},r.a.createElement(s.b,{className:"button float-right",to:"/training-resource/create"},r.a.createElement("i",{className:"fas fa-plus-circle"}," ")," Add new"," "))),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"S. No."),r.a.createElement("th",null,"Details"),r.a.createElement("th",null,"Archive"),r.a.createElement("th",null,"Edit"))),r.a.createElement("tbody",null,a)))}}]),t}(r.a.Component),Te=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/all-training-resources",component:qe}))},Fe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={data:[],roles:"",user:""},a.handlePasswordChange=a.handlePasswordChange.bind(Object(Ee.a)(a)),a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"handlePasswordChange",value:function(e){var t=this.refs.old.value,a=this.refs.new1.value,n=localStorage.getItem("userid");fetch("".concat(W,"/user/")+n+"/password?_format=json",{credentials:"include",method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-Token":localStorage.getItem("csrf_token")},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/user/user")}},old:[{value:t}],new:[{target_id:a}]})}).then(function(e){return e}).then(function(e){return setTimeout(function(){alert("Password changed successfully"),window.location.reload()},1e3)}),e.preventDefault()}},{key:"checkUser",value:function(){localStorage.getItem("roles")||this.props.history.push("/")}},{key:"render",value:function(){return this.checkUser(),r.a.createElement("div",null,r.a.createElement("h3",null,"Change password:"),r.a.createElement("form",{id:"passChange"},r.a.createElement("input",{type:"password",ref:"old",placeholder:"Old password"}),r.a.createElement("input",{type:"password",ref:"new1",placeholder:"New password"}),r.a.createElement("input",{type:"password",placeholder:"Confirm new password"}),r.a.createElement("input",{type:"button",className:"button",onClick:this.handlePasswordChange.bind(this),value:"Submit"})))}}]),t}(r.a.Component),Ie=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"About competency mapper"),r.a.createElement("p",{className:"lead"},"Competency mapper is a web-based tool to support the creation and management of competency frameworks for professionals working in the biomolecular sciences."),r.a.createElement("h3",null,"Anyone can.."),r.a.createElement("p",null,r.a.createElement("ul",null,r.a.createElement("li",null,"Explore the five competency frameworks that we currently have in the system"),r.a.createElement("li",null,"Click on any competency to find the knowledge, skills and attitudes (KSAs) associated with it"),r.a.createElement("li",null,"See the relationships between different competency frameworks; for example, if a competency in framework 2 is derived from one in framework 1, this information is captured"),r.a.createElement("li",null,"Access a list of courses that have been mapped to a particular competency"),r.a.createElement("li",null,"View summary information on each of these courses, including a link through to the course website"))),r.a.createElement("h3",null,"In addition to the above, content editors can..."),r.a.createElement("ul",null,r.a.createElement("li",null,"Map courses to any competency in the mapper"),r.a.createElement("li",null,"Map courses to any combination of knowledge, skills and attitudes")),r.a.createElement("h3",null,"In addition to the above, administrators can..."),r.a.createElement("ul",null,r.a.createElement("li",null,"Build a completely new competency framework from a blank template"),r.a.createElement("li",null,"Make minor updates to an existing competency framework"),r.a.createElement("li",null,"If a competency framework has undergone major updates such as merging, splitting or deprecation of competencies, create and publish a new version of the framework without overwriting the previous version, and without losing links to pre-existing mappings"),r.a.createElement("li",null,"Create and edit multiple personas or roles associated with a competency framework"),r.a.createElement("li",null,"For each competency in an associated framework, define the level of competency required by any of the personas/roles associated with it, using an administrator-defined list of variables.")),r.a.createElement("h3",null,"What is competency?"),r.a.createElement("p",null,"By definition, competency is an observable ability of any professional, integrating multiple components such as knowledge, skills, values and attitudes. It is observable, so its acquisition can be validated objectively."),r.a.createElement("h4",null,"Why is it relevant?"),r.a.createElement("p",null,"Competency provides a shared \u2018currency\u2019 applicable to learning of all types and at all career stages."),r.a.createElement("ul",null,r.a.createElement("li",null,"Individual professionals can use competency as a career development tool: by documenting the competencies that you have gained, and the evidence that you have gained them, in a competency portfolio you can seek further training to fill gaps in your portfolio, or map your existing portfolio to roles that you might not previously have considered."),r.a.createElement("li",null,"Professional bodies and employers can use competency to define competency frameworks for different roles or professions. These provide useful guidance when hiring and promoting individuals, and can also provide the basis for professional recognition in regulated professions."),r.a.createElement("li",null,"Course providers can use competency to develop training (by asking what competencies their trainees need to gain) and, where appropriate, to assess whether training has been effective.")),r.a.createElement("h3",null,"What is a competency framework?"),r.a.createElement("p",null,"A competency framework defines the competencies required to fulfil a particular role. competency frameworks are typically defined by professional bodies or learned societies in collaboration with employers. Several projects under the EU\u2019s Horizon 2020 framework have developed competency frameworks to support emerging professions."),r.a.createElement("h3",null,"Who is developing the competency mapper?"),r.a.createElement("p",null,"The competency mapper is being developed by the"," ",r.a.createElement("a",{href:"https://www.ebi.ac.uk/about/people/cath-brooksbank",target:"_blank"}," ","EMBL-EBI training team"," ")," ","with the"," ",r.a.createElement("a",{href:"https://bioexcel.eu/",target:"_blank"}," ","BioExcel"," ")," ","competency framework as its primary use case."," "),r.a.createElement("p",null,"EMBL-EBI\u2019s Training programme uses a competency-based approach to developing new courses: put simply, we ask ourselves \u2018What competency or competencies does our audience for this course need to develop?\u2019 before we create the programme and content for a new course, and before we make a significant update to an existing course."),r.a.createElement("p",null,"The team has contributed to, and helped to steer, a number of initiatives to develop new training programmes by defining competency requirements in relation to a specific target audience and building a competency framework for that audience. Competency-based projects that we have been involved in include:"),r.a.createElement("ul",null,r.a.createElement("li",null,"The ISCB education committee\u2019s"," ",r.a.createElement("a",{href:"https://europepmc.org/articles/PMC5794068",target:"_blank"}," ","competency framework for bioinformatics professionals"," ")," "),r.a.createElement("li",null,"A clinical bioinformatics competency framework to support Health Education England to prepare clinical practitioners for the application of genomics in the healthcare service"),r.a.createElement("li",null,"The"," ",r.a.createElement("a",{href:"https://drive.google.com/file/d/0B3BA3KSKGOoQb0hvUkx3a3lMS00/view",target:"_blank"}," ","RItrain competency framework"," ")," ","for managers and leaders of research infrastructure"),r.a.createElement("li",null,"The"," ",r.a.createElement("a",{href:"https://zenodo.org/record/154085#.WbUNUhNSwUE",target:"_blank"}," ","CORBEL competency framework"," ")," ","for technical operators of research infrastructure"),r.a.createElement("li",null,"The"," ",r.a.createElement("a",{href:"https://zenodo.org/record/264231#.WbUNoRNSwUE",target:"_blank"}," ","BioExcel competency framework"," "),"for scientists working on biomolecular modelling and simulation"),r.a.createElement("p",null),r.a.createElement("p",null,"These competency frameworks were designed to be used by the training communities who developed them, and openly available to anyone who might find them useful, yet all too often they end up buried in a PDF file as part of a project deliverable. This made us long for a web-based tool that would make these frameworks,and the training associated with them, readily discoverable. We therefore decided to build that tool, and although it\u2019s still in the early stages of development we\u2019ve decided to make it openly available now so that we can seek broad input to improve it and make it as useful as possible to the education and training community at large. If you have comments or suggestions, please"," ",r.a.createElement("a",{href:"mailto:competency@ebi.ac.uk"}," contact us "),".")))};var Le=function(e){var t=e.framework,a=Z(t.description);a.length>120&&(a="".concat(a.slice(0,120).trim(),"..."));var n=t.versions.reduce(function(e,t){return"live"===t.status?t.number:e},null);return null===n?null:r.a.createElement("div",{className:"column medium-4"},r.a.createElement(s.b,{className:"column callout","data-equalizer-watch":!0,to:"/framework/".concat(t.title.toLowerCase(),"/").concat(n)},r.a.createElement("img",{className:"float-center margin-bottom-medium",style:{height:"6rem"},src:t.logo[0].url,alt:"competency logo"}),r.a.createElement("h5",null,a,r.a.createElement("i",{className:"icon icon-functional","data-icon":">"}))))},Ue=window.$;var Me=function(e){var t=e.frameworks,a=new r.a.createRef;return t.length<1?null:r.a.createElement("div",{className:"row","data-equalizer":!0,ref:a},(window.setTimeout(function(){return Ue(a.current).foundation()}),t.map(function(e){return r.a.createElement(Le,{key:e.nid,framework:e})})))},Ve=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.state={frameworks:[]},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.getAllVersionedFrameworks();case 4:t=e.sent,this.setState({frameworks:t}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to fetch framework data",{variant:"error"}),console.error(e.t0);case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[0,8,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.frameworks;return r.a.createElement("div",{className:"column"},r.a.createElement("h3",null,"Overview"),r.a.createElement("p",{className:"lead"},"Competency mapper is a web-based tool to support the creation and management of competency frameworks for professionals working in the biomolecular sciences"," ",r.a.createElement(s.b,{to:"/about",className:"readmore"},"read more"," ")),r.a.createElement(Me,{frameworks:e}))}}]),t}(n.Component),Be=Object(V.withSnackbar)(Ve),Pe=new K,He="/user/login?_format=json",We="/user/logout";function Ke(e,t){return ze.apply(this,arguments)}function ze(){return(ze=Object(m.a)(u.a.mark(function e(t,a){var n,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t,pass:a},e.prev=1,e.next=4,Pe.post(He,n);case 4:return r=e.sent,c=r.data,localStorage.setItem("roles",c.current_user.roles),localStorage.setItem("csrf_token",c.csrf_token),localStorage.setItem("logout_token",c.logout_token),localStorage.setItem("user",c.current_user.name),localStorage.setItem("userid",c.current_user.uid),e.abrupt("return",c);case 14:throw e.prev=14,e.t0=e.catch(1),Je(),e.t0;case 18:case"end":return e.stop()}},e,null,[[1,14]])}))).apply(this,arguments)}function Je(){return localStorage.removeItem("roles"),localStorage.removeItem("csrf_token"),localStorage.removeItem("logout_token"),localStorage.removeItem("userid"),localStorage.removeItem("user"),Pe.post(We)}var Xe=window.$,$e=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:!1,roles:localStorage.getItem("roles")||"",user:localStorage.getItem("user")||""},a.activeRequests=new X,a.handleActiveRequests=function(e){a.setState({isActive:e})},a.detectUserChangesFromOtherTabs=function(e){var t=e.key,n=e.newValue;"user"===t&&(n?a.setState({user:localStorage.getItem("user"),roles:localStorage.getItem("roles")}):a.setState({user:"",roles:""}))},a.handleLogin=function(){var e=Object(m.a)(u.a.mark(function e(t,n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke(t,n);case 3:a.setState({user:localStorage.getItem("user"),roles:localStorage.getItem("roles")}),e.next=17;break;case 6:if(e.prev=6,e.t0=e.catch(0),window.console.error(e.t0),!e.t0.response){e.next=17;break}e.t1=e.t0.response.status,e.next=400===e.t1?13:15;break;case 13:return window.alert(e.t0.response.data.message),e.abrupt("return");case 15:window.alert("Sorry, there was an unknown login problem, please try again.");case 16:window.alert("Sorry, there was an unknown login problem, please try again.");case 17:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleLogout=function(){a.setState({user:"",roles:""}),Je()},a}return Object(v.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){Xe(document).foundation(),Xe(document).foundationExtendEBI(),this.setState({isActive:this.activeRequests.isActive}),this.subcription=this.activeRequests.addEventListener(this.handleActiveRequests),window.addEventListener("storage",this.detectUserChangesFromOtherTabs)}},{key:"componentWillUnmount",value:function(){this.subcription&&this.activeRequests.removeEventListener(this.subcription),window.removeEventListener("storage",this.detectUserChangesFromOtherTabs)}},{key:"render",value:function(){var e=this.state,t=e.isActive,a=e.roles,n=e.user;return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.SnackbarProvider,{maxSnack:1,anchorOrigin:{vertical:"bottom",horizontal:"center"},preventDuplicate:!0},r.a.createElement(S,{roles:a,user:n,isActive:t,onLogin:this.handleLogin,onLogout:this.handleLogout}),r.a.createElement("section",{id:"main-content-area",className:"row",role:"main"},r.a.createElement("main",{className:"column"},r.a.createElement(g.d,null,r.a.createElement(Ye,{condition:!!n&&a.includes("content_manager"),path:"/training-resource/edit/:nid",component:Se}),r.a.createElement(Ye,{condition:!!n&&a.includes("content_manager"),path:"/training-resource/create",component:Ce}),r.a.createElement(g.b,{path:"/training-resources/:id",component:Ae}),r.a.createElement(g.b,{path:"/all-training-resources",component:Te}),r.a.createElement(Ye,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/manage/competencies/:cid/manage-attributes",component:te}),r.a.createElement(Ye,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/manage/competencies/:domainId?",component:oe}),r.a.createElement(g.b,{path:"/framework/:framework/:version/competency/details/:cid",component:ue}),r.a.createElement(g.b,{path:"/framework/:framework/:version",component:ke}),r.a.createElement(g.b,{path:"/user/change/password",component:Fe}),r.a.createElement(g.b,{path:"/about",component:Ie}),r.a.createElement(g.b,{path:"/",component:Be}))))))}}]),t}(n.Component),Ye=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.component,a=e.condition,n=Object(i.a)(e,["component","condition"]);return r.a.createElement(g.b,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,e):r.a.createElement(g.a,{to:"/"})}}))}}]),t}(n.Component),Qe=document.getElementById("root");o.a.render(r.a.createElement(s.a,{basename:""},r.a.createElement($e,null)),Qe),F.a.setAppElement(Qe)},64:function(e,t,a){e.exports={meter:"progress-bar_meter__2KLWm",progress:"progress-bar_progress__QKIy2"}},99:function(e,t,a){e.exports=a(171)}},[[99,1,2]]]);
//# sourceMappingURL=main.c6749e3b.chunk.js.map