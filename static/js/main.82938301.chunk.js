(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,a){},113:function(e,t,a){},148:function(e,t,a){},170:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),i=a.n(c),s=a(11),o=(a(103),a(84)),l=a(2),u=a.n(l),m=a(5),d=a(4),h=a(3),p=a(8),f=a(6),v=a(7),g=a(42),E=a(62),b=a.n(E);function y(e){var t=e.isActive;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("div",{className:"warning progress ".concat(b.a.progress),role:"progressbar"},r.a.createElement("div",{className:"progress-meter ".concat(b.a.meter)})))}y.defaultProps={isActive:!1};var k=y,w=window.$,O=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).navRef=r.a.createRef(),a.logout=function(){(0,a.props.onLogout)()},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){w(this.navRef.current).foundation()}},{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user,n=r.a.createElement("li",null,r.a.createElement("a",{tabIndex:"0",className:"dropdown-on-dark-background"},"Manage Competencies"),r.a.createElement("ul",{className:"menu vertical"},r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/bioexcel/manage/competencies"},"BioExcel")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/corbel/manage/competencies"},"CORBEL")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/iscb/manage/competencies"},"ISCB")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/ritrain/manage/competencies"},"RITrain")),r.a.createElement("li",null,r.a.createElement(s.b,{to:"/framework/nhs/manage/competencies"},"NHS")))),c=r.a.createElement("li",null,r.a.createElement(s.b,{to:"/all-training-resources"},"Manage Training Resources")),i=r.a.createElement("li",null,r.a.createElement("a",{tabIndex:"0",className:"dropdown-on-light-background"},r.a.createElement("i",{className:"fas fa-user"})," Hi ",a),r.a.createElement("ul",{className:"menu vertical"},r.a.createElement("li",null,r.a.createElement(s.b,{to:"/user/change/password"},"Change password")),r.a.createElement("li",null,r.a.createElement("a",{onClick:this.logout},"Logout"))));return r.a.createElement("nav",{ref:this.navRef},r.a.createElement("ul",{className:"dropdown menu float-left","data-dropdown-menu":!0,"data-description":"navigational"},t.includes("framework_manager")&&n,t.includes("content_manager")&&c),r.a.createElement("ul",{className:"dropdown menu float-right","data-dropdown-menu":!0,"data-description":"user tasks"},i))}}]),t}(n.Component),j=a(14),_=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:""},a.onChange=function(e){a.setState(Object(j.a)({},e.currentTarget.name,e.currentTarget.value))},a.submit=function(){var e=a.props.onSubmit,t=a.state,n=t.username,r=t.password;n&&r&&e(n,r)},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.password;return r.a.createElement("nav",null,r.a.createElement("ul",{className:"menu float-left small-12"},r.a.createElement("li",{className:"small-12 margin-bottom-large"},r.a.createElement("label",{className:"columns small-4 medium-3 large-2 margin-top-large"},r.a.createElement("input",{value:a,name:"username",onChange:function(t){return e.onChange(t)},type:"text",autoComplete:"username",placeholder:"Username"})),r.a.createElement("label",{className:"columns small-4 medium-3 large-2 margin-top-large"},r.a.createElement("input",{value:n,name:"password",onChange:function(t){return e.onChange(t)},type:"password",autoComplete:"current-password",placeholder:"Password"})),r.a.createElement("div",{className:"columns small-4 medium-6 large-8 margin-top-large"},r.a.createElement("button",{className:"button",type:"button",onClick:function(){return e.submit()}},r.a.createElement("i",{className:"fa fa-key","aria-hidden":"true"})," Login")))))}}]),t}(n.Component),S=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onLogin=function(e,t){a.props.onLogin(e,t)},a.onLogout=function(){a.props.onLogout()},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user,n=e.isActive;return r.a.createElement("div",{"data-sticky-container":!0},r.a.createElement("header",{id:"masthead",className:"masthead","data-sticky":!0,"data-sticky-on":"large","data-top-anchor":"main-content-area:top","data-btm-anchor":"main-content-area:bottom"},r.a.createElement("div",{className:"masthead-inner row"},r.a.createElement("div",{className:"columns medium-12",id:"local-title"},r.a.createElement("h1",null,r.a.createElement(s.b,{to:"/"},"Competency Mapper"))),a&&t?r.a.createElement(O,{roles:t,user:a,onLogout:this.onLogout}):r.a.createElement(_,{onSubmit:this.onLogin})),r.a.createElement(k,{isActive:n})))}}]),t}(n.Component),C=(a(113),{oriValue:"",value:"",active:!1}),N=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).state=C,a.selfRef=r.a.createRef(),a.inputRef=r.a.createRef(),a.toggleActive=function(e){a.selfRef.current&&a.selfRef.current.contains(e.target)?a.setState({active:!0}):a.reset()},a.reset=function(){var e=a.state,t=e.oriValue;e.active&&a.setState({active:!1,value:t})},a.submit=function(){var e=a.props.change,t=a.state.value;e(t),a.setState({active:!1,oriValue:t})},a.render=function(){var e=a.props,t=e.style,n=e.staticElement,c=a.state,i=c.value;return c.active?r.a.createElement("div",{className:"edit-inline-container",ref:a.selfRef},r.a.createElement("input",{type:"text",className:"inner-input",value:i,onChange:function(e){return a.onChange(e.target.value)},ref:a.inputRef}),r.a.createElement("div",{className:"edit-inline-controls"},r.a.createElement("button",{className:"button margin-bottom-none",type:"button",onClick:a.submit},r.a.createElement("i",{className:"icon icon-common icon-check","aria-label":"accept changes"})),r.a.createElement("button",{className:"button margin-bottom-none",type:"button",onClick:a.reset},r.a.createElement("i",{className:"icon icon-common icon-undo","aria-label":"undo changes"})))):r.a.createElement(n,{style:t,ref:a.selfRef},[i,r.a.createElement("i",{key:"dummy",className:"icon icon-common icon-edit icon-left-spacer"})])},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.text;this.setState({value:e,oriValue:e}),document.addEventListener("mousedown",this.toggleActive)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.toggleActive)}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.active&&!t.active&&setTimeout(function(){return a.inputRef.current&&a.inputRef.current.focus()},0)}},{key:"onChange",value:function(e){this.setState({value:e})}}]),t}(n.Component);N.defaultProps={style:{},text:"",change:function(e){},staticElement:"div"};var x={value:"",uuid:""},D=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state=x,a.onChange=function(e){e.preventDefault();var t=e.currentTarget.value,n=e.currentTarget.name;"uuid"===n&&a.setState(Object(j.a)({},n,t)),"value"===n&&a.setState(Object(j.a)({},n,t))},a.onSubmit=function(e){e.preventDefault();var t=a.props.onCreate,n=a.state,r=n.value,c=n.uuid;r.trim()&&c&&t(r,c)},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.options;if(e.length){var t=e[0].uuid;this.setState({uuid:t})}}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.placeholder,n=e.options,c=this.state,i=c.value,s=c.uuid,o=n.map(function(e){var t=e.description,a=e.uuid;return r.a.createElement("option",{key:a,value:a},t)});return r.a.createElement("form",{onSubmit:this.onSubmit,className:"callout"},r.a.createElement("h4",null,t),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-7"},r.a.createElement("input",{type:"text",placeholder:a,name:"value",value:i,required:!0,onChange:this.onChange})),r.a.createElement("div",{className:"column large-3"},r.a.createElement("select",{name:"uuid",value:s,required:!0,onChange:this.onChange},o)),r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Create"}))))}}]),t}(n.Component),A=function(e){var t=e.message,a=e.style;return r.a.createElement("div",{className:"margin-top-large callout alert",style:a},t)};A.defaultProps={message:"Sorry, there was a problem when fetching the data!",style:{}};var R=A,T=a(34),q=function(){function e(){if(Object(d.a)(this,e),e.instance)return this.instance;e.instance=this}return Object(h.a)(e,[{key:"get",value:function(){return{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":window.localStorage.getItem("csrf_token"),Authorization:"Basic"}}}]),e}(),L=a(55),F=a.n(L),I=function(){function e(){if(Object(d.a)(this,e),this.headers=new q,e.instance)return e.instance;e.instance=this}return Object(h.a)(e,[{key:"get",value:function(e){return F.a.get(e)}},{key:"post",value:function(e,t){return F.a.post(e,t,{headers:this.headers.get(),withCredentials:!0})}},{key:"patch",value:function(e,t){return F.a.patch(e,t,{headers:this.headers.get(),withCredentials:!0})}}]),e}(),U=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,null,[{key:"createCompetency",value:function(e){var t=e.description,a=e.domainId,n=e.domainUuid;return{_links:Object(j.a)({type:{href:"".concat(M,"/rest/type/node/competency")}},"".concat(M,"/rest/relation/node/competency/field_domain"),{href:"".concat(M,"/node/").concat(a,"?_format=hal_json")}),title:[{value:t}],type:[{target_id:"competency"}],_embedded:Object(j.a)({},"".concat(M,"/rest/relation/node/competency/field_domain"),[{_links:{self:{href:"".concat(M,"/node/").concat(a,"?_format=hal_json")},type:{href:"".concat(M,"/rest/type/node/domain")}},uuid:[{value:n}],lang:"en"}])}}},{key:"createAttribute",value:function(e){var t,a,n=e.description,r=e.attributeTypeId,c=e.attributeTypeUuid,i=e.competencyId,s=e.competencyUuid;return{_links:(t={type:{href:"".concat(M,"/rest/type/node/attribute")}},Object(j.a)(t,"".concat(M,"/rest/relation/node/attribute/field_competency"),{href:"".concat(M,"/node/").concat(i,"?_format=hal_json")}),Object(j.a)(t,"".concat(M,"/rest/relation/node/attribute/field_attribute_type"),{href:"".concat(M,"/node/").concat(r,"?_format=hal_json")}),t),title:[{value:n}],type:[{target_id:"attribute"}],_embedded:(a={},Object(j.a)(a,"".concat(M,"/rest/relation/node/attribute/field_competency"),[{_links:{self:{href:"".concat(M,"/node/").concat(i,"?_format=hal_json")},type:{href:"".concat(M,"/rest/type/node/competency")}},uuid:[{value:s}],lang:"en"}]),Object(j.a)(a,"".concat(M,"/rest/relation/node/attribute/field_attribute_type"),[{_links:{self:{href:"".concat(M,"/node/").concat(r,"?_format=hal_json")},type:{href:"".concat(M,"/rest/type/node/attribute_type")}},uuid:[{value:c}],lang:"en"}]),a)}}},{key:"mutateCompetency",value:function(t,a){return e.mutate(t,a,"competency")}},{key:"mutateAttribute",value:function(t,a){return e.mutate(t,a,"attribute")}},{key:"mutate",value:function(e,t,a){var n;return n={_links:{type:{href:"".concat(M,"/rest/type/node/").concat(a)}}},Object(j.a)(n,e,[{value:t}]),Object(j.a)(n,"type",[{target_id:a}]),n}}]),e}(),M="https://live-competency-mapper.pantheonsite.io",P=function(){function e(){if(Object(d.a)(this,e),this.http=new I,e.instance)return this.instance;e.instance=this}return Object(h.a)(e,[{key:"getFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("".concat(M,"/api/v1/framework/").concat(t,"?_format=json"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAllFrameworks",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("".concat(M,"/api/v1/framework/?_format=json"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAllFrameworksDetails",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("".concat(M,"/api/frameworks"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("".concat(M,"/node?_format=hal_json"),U.createAttribute(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("".concat(M,"/node?_format=hal_json"),U.createCompetency(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"patchCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("".concat(M,"/node/").concat(t,"?_format=hal_json"),U.mutateCompetency(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"patchAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("".concat(M,"/node/").concat(t,"?_format=hal_json"),U.mutateAttribute(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()}]),e}(),B=function(){function e(){if(Object(d.a)(this,e),e.instance)return e.instance;e.instance=this,this.counter=0,this.callbacks=[]}return Object(h.a)(e,[{key:"addEventListener",value:function(e){return this.callbacks.push(e)}},{key:"removeEventListener",value:function(e){return delete this.callbacks[e-1]}},{key:"startRequest",value:function(){0===this.counter&&this.callbacks.forEach(function(e){return e&&e(!0)}),++this.counter}},{key:"finishRequest",value:function(){1===this.counter&&this.callbacks.forEach(function(e){return e&&e(!1)}),this.counter>0&&--this.counter}}]),e}(),H=a(49),W=function(e){return Array.prototype.flat?e.flat():e.reduce(function(e,t){return[].concat(Object(H.a)(e),Object(H.a)(t))},[])},K=new RegExp("</?.+?/?>","g"),z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.replace(K,t)},J=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new B,a.competencyService=new P,a.state={framework:a.props.match.params.framework,frameworkName:"",attributeTypes:[],domainId:"",domainName:"",competencyId:a.props.match.params.cid,competencyUuid:"",competencyName:"",competencyData:[],loadingError:!1},a.createAttribute=function(){var e=Object(m.a)(u.a.mark(function e(t,n){var r,c,i,s,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.state,c=r.competencyId,i=r.competencyUuid,s=r.attributeTypes,e.prev=1,a.activeRequests.startRequest(),o=s.find(function(e){return e.uuid===n}).id,e.next=6,a.competencyService.createAttribute({description:t,competencyId:c,competencyUuid:i,attributeTypeId:o,attributeTypeUuid:n});case 6:a.fetchCompetency(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,a.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.scroll(0,0),this.activeRequests.startRequest(),e.next=4,Promise.all([this.fetchAllFrameworks(),this.fetchCompetency()]);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchAllFrameworks",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,e.prev=1,e.next=4,this.competencyService.getAllFrameworks();case 4:a=e.sent,(n=a.filter(function(e){return e.name.toLowerCase()===t})).length&&(r=n[0].attribute_types.map(function(e){return{description:e.title,uuid:e.uuid}}),this.setState({attributeTypes:r})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.setState({loadingError:!0});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"fetchCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,e.prev=1,e.next=4,this.competencyService.getFramework(t);case 4:a=e.sent,(n=this.filterByCompetencyId(a,this.state.competencyId)).length&&this.setState({frameworkName:a[0].title,domainName:n[0].domainTitle,domainId:n[0].domainId,competencyUuid:n[0].uuid,competencyName:n[0].title,competencyData:n[0]}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.setState({loadingError:!0});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"filterByCompetencyId",value:function(e,t){return W(e.map(function(e){return W(e.domains.map(function(e){return e.competencies.filter(function(e){return e.id===t}).map(function(t){return t.domainTitle=e.title,t.domainId=e.nid,t})}))}))}},{key:"editAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchAttribute(t,"title",a);case 4:this.fetchCompetency(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 10:return e.prev=10,this.activeRequests.finishRequest(),e.finish(10);case 13:case"end":return e.stop()}},e,this,[[0,7,10,13]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"toggleArchive",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchAttribute(t,"field_archived","1"!==a);case 4:this.fetchCompetency(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 10:return e.prev=10,this.activeRequests.finishRequest(),e.finish(10);case 13:case"end":return e.stop()}},e,this,[[0,7,10,13]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAttributeRows",value:function(e,t){var a=this;return this.state.competencyData.attributes.filter(function(t){return t.type===e.description}).map(function(e,n){return r.a.createElement("tr",{key:e.uuid},r.a.createElement("td",null,"".concat(t,".").concat(n+1)),r.a.createElement("td",null,r.a.createElement(N,{text:e.title,change:function(t){return a.editAttribute(e.id,t)}})),r.a.createElement("td",null,r.a.createElement("button",{className:"cursor",onClick:function(){return a.toggleArchive(e.id,e.archived)}},"1"===e.archived?r.a.createElement("span",{className:"fas fa-toggle-on"},r.a.createElement("span",null,"Archived")):r.a.createElement("span",{className:"fas fa-toggle-off"}))))})}},{key:"getAttributeList",value:function(){var e=this;return this.state.attributeTypes.map(function(t,a){return r.a.createElement(r.a.Fragment,{key:t.uuid},r.a.createElement("tr",{className:"secondary-background-important white-color"},r.a.createElement("td",null,a+1),r.a.createElement("td",null,r.a.createElement("strong",null,r.a.createElement("em",null,t.description))),r.a.createElement("td",{className:"small-1"},"Archive")),e.getAttributeRows(t,a+1))})}},{key:"render",value:function(){var e=this.state,t=e.framework,a=e.frameworkName,n=e.attributeTypes,c=e.domainId,i=e.domainName,o=e.competencyName,l=e.competencyData;return e.loadingError?r.a.createElement(R,null):0===l.length?null:r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,"Manage attributes"),r.a.createElement("h4",null,r.a.createElement(s.b,{to:"/framework/".concat(t,"/manage/competencies")},a)," / ",r.a.createElement(s.b,{to:"/framework/".concat(t,"/manage/competencies/").concat(c)},i)," / ",o),r.a.createElement(D,{title:"Create new attribute",placeholder:"Attribute description",options:n,onCreate:this.createAttribute}),r.a.createElement("table",null,r.a.createElement("tbody",null,this.getAttributeList())))}}]),t}(r.a.Component),V=Object(T.withSnackbar)(J),X=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new B,a.competencyService=new P,a.state={framework:"",frameworkName:"",frameworkData:[],competencyTypes:[],loadingError:!1},a.createCompetency=function(){var e=Object(m.a)(u.a.mark(function e(t,n){var r,c,i,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.state,c=r.framework,i=r.frameworkData,e.prev=1,a.activeRequests.startRequest(),s=i[0].domains.find(function(e){return e.uuid===n}).nid,e.next=6,a.competencyService.createCompetency({description:t,domainId:s,domainUuid:n});case 6:a.fetchFramework(c),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,a.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,null,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params,a=t.framework,n=t.domainId,e.next=3,this.fetchFramework(a);case 3:n&&setTimeout(function(){var e=r.refs[n];e&&e.scrollIntoView()},100);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){var a=this.state,n=a.framework,r=a.frameworkData,c=a.loadingError;n!==t.framework&&(0!==r.length||c||this.fetchFramework(n))}},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.getFramework(t);case 4:(a=e.sent).length&&(n=a[0].domains.map(function(e){return{description:e.title,uuid:e.uuid}}),this.setState({frameworkName:a[0].title,frameworkData:a,competencyTypes:n})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({loadingError:!0});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"editCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchCompetency(t,"title",a);case 4:n=this.state.framework,this.fetchFramework(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"toggleArchive",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),n=!a,e.next=5,this.competencyService.patchCompetency(t,"field_archived",n);case 5:r=this.state.framework,this.fetchFramework(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[0,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getCompetencyList",value:function(){var e=this;return this.state.frameworkData[0].domains.map(function(t,a){return r.a.createElement(r.a.Fragment,{key:t.nid},r.a.createElement("tr",{className:"secondary-background-important white-color",ref:t.nid},r.a.createElement("td",null,a+1),r.a.createElement("td",null,r.a.createElement("h4",null,t.title)),r.a.createElement("td",{className:"small-1"},"Archive"),r.a.createElement("td",null,"Manage attributes")),e.getCompetencyRows(t.competencies,a))})}},{key:"getCompetencyRows",value:function(e,t){var a=this,n=this.state.framework;return e.map(function(e,c){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,t+1,".",c+1),r.a.createElement("td",null,r.a.createElement(N,{text:e.title,change:function(t){return a.editCompetency(e.id,t)}})),r.a.createElement("td",null,r.a.createElement("button",{className:"cursor",onClick:a.toggleArchive.bind(a,e.id,e.archived)},1===e.archived?r.a.createElement("span",{className:"fas fa-toggle-on"},r.a.createElement("span",null,"Archived")):r.a.createElement("span",{className:"fas fa-toggle-off"}))),r.a.createElement("td",null,r.a.createElement(s.b,{to:"/framework/".concat(n,"/manage/competencies/").concat(e.id,"/manage-attributes")},r.a.createElement("i",{className:"fas fa-sitemap"}))))})}},{key:"render",value:function(){var e=this.state,t=e.frameworkName,a=e.frameworkData,n=e.competencyTypes;return e.loadingError?r.a.createElement(R,null):0===a.length?null:r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,"Manage framework"),r.a.createElement("h4",null,t),r.a.createElement(D,{title:"Create new competency",placeholder:"Competency description",options:n,onCreate:this.createCompetency}),r.a.createElement("table",null,r.a.createElement("tbody",null,this.getCompetencyList())))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.match.params.framework;return a!==t.framework?{framework:a,frameworkData:[],loadingError:!1}:null}}]),t}(r.a.Component),$=Object(T.withSnackbar)(X),Y=a(43),Q=function(){function e(){if(Object(d.a)(this,e),this.http=new I,e.instance)return this.instance;e.instance=this}return Object(h.a)(e,[{key:"getCourses",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("".concat("https://live-competency-mapper.pantheonsite.io","/api/v1/training-resources/all?_format=json"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),G=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new B,a.competencyService=new P,a.coursesService=new Q,a.state={framework:a.props.match.params.framework,frameworkData:[],competencyId:a.props.match.params.cid,attributeDefs:[],resources:[]},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,Promise.all([this.getFramework(),this.getAttributes(),this.getResources()]);case 4:return e.prev=4,this.activeRequests.finishRequest(),e.finish(4);case 7:case"end":return e.stop()}},e,this,[[0,,4,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"getFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,e.next=3,this.competencyService.getFramework(t);case 3:a=e.sent,this.setState({frameworkData:a});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAttributes",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.competencyService.getAllFrameworks();case 2:t=e.sent,a=this.state.framework,(n=t.filter(function(e){return e.name.toLowerCase()===a})).length&&(r=n[0].attribute_types.map(function(e){return e.title}),this.setState({attributeDefs:r}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getResources",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.coursesService.getCourses();case 3:t=e.sent,this.setState({resources:t}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to retrieve training resources",{variant:"error"});case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"resourceBlock",value:function(){var e=this;return this.state.resources.map(function(t){return t.competency_profile.map(function(a){return a.domains.map(function(a){return a.competencies.filter(function(t){return t.id===e.state.competencyId}).map(function(e){return r.a.createElement("li",{key:t.id},r.a.createElement(s.b,{to:"/training-resources/".concat(t.id)},t.title))})})})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.competencyId,n=t.frameworkData,c=t.attributeDefs,i=[];n.forEach(function(e){return e.domains.forEach(function(t){return t.competencies.forEach(function(n){n.id===a&&i.push(Object(Y.a)({},n,{framework:e.title,domain:t.title}))})})});var s=i.map(function(t){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("h4",null," ",t.framework," / ",t.domain),r.a.createElement("h4",null,t.title))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-8"},r.a.createElement("ul",null,c.map(function(e){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"margin-top-medium"}," ",r.a.createElement("strong",null,r.a.createElement("em",null,e))),t.attributes.map(function(t){return t.type===e?r.a.createElement("li",{key:t.id},t.title," "):null}))}))),r.a.createElement("div",{className:"column large-4"},r.a.createElement("div",{className:"callout notice industry-background white-color"},r.a.createElement("p",null,"Competency derived from:"),r.a.createElement("p",null,"No data available")),r.a.createElement("div",{className:"callout notice training-background white-color"},r.a.createElement("p",null,"Training resources mapped to this competency"),r.a.createElement("ul",null,e.resourceBlock())))))});return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("h3",null,"Competency details"),s))}}]),t}(r.a.Component),Z=Object(T.withSnackbar)(G),ee=a(44),te=(a(147),a(93)),ae=a.n(te),ne=a(189);a(148);function re(e){var t=e.parentIndex,a=e.index,n=e.framework,c=e.competency,i=(e.disable,Object(ne.a)(c.attributes,"type")),o=Object.keys(i).map(function(e){var t=i[e].map(function(e){return r.a.createElement("li",{key:e.id},e.title)});return r.a.createElement("div",{key:e},r.a.createElement("em",null,e),r.a.createElement("ul",null,t))});return r.a.createElement("tr",null,r.a.createElement("td",null,"".concat(t+1,".").concat(a+1)),r.a.createElement("td",null,r.a.createElement(ae.a,{trigger:r.a.createElement("div",{className:"open-close-title"},r.a.createElement("span",null,c.title),r.a.createElement("span",{className:"icon icon-common icon-plus float-right"},r.a.createElement("p",{className:"show-for-sr"},"show more"))),triggerWhenOpen:r.a.createElement("div",{className:"open-close-title"},r.a.createElement("span",null,c.title),r.a.createElement("span",{className:"icon icon-common icon-minus float-right"},r.a.createElement("p",{className:"show-for-sr"},"show less")))},r.a.createElement("div",{className:"padding-left-large padding-top-large"},r.a.createElement(s.b,{to:"".concat(n,"/competency/details/").concat(c.id)},r.a.createElement("span",{className:"float-right"},r.a.createElement("i",{className:"icon icon-spacer icon-common icon-info"}),"More details")),o))))}re.defaultProps={parentIndex:0,index:0,disable:!0};var ce=re;function ie(e){var t=e.index,a=e.framework,n=e.domain,c=e.disable,i=n.competencies.map(function(e,n){return r.a.createElement(ce,{key:e.id,parentIndex:t,index:n,framework:a,competency:e,disable:c})});return r.a.createElement("tbody",null,r.a.createElement("tr",{className:"white-color secondary-background"},r.a.createElement("td",null,t+1),r.a.createElement("td",null,r.a.createElement("h4",null," ",n.title))),i)}ie.defaultProps={index:0,domain:{title:"",competencies:[]},disable:!0};var se=ie,oe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={courses:[],filteredCourses:[],filter:"",loadingError:!1},a.coursesService=new Q,a.activeRequests=new B,a.onFilter=function(e){var t,n=a.state.courses;try{t=new RegExp(e,"i")}catch(c){t=/./}var r=n.filter(function(e){return t.test(e.title)});a.setState({filteredCourses:r,filter:e})},a.state.framework=e.framework,a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.coursesService.getCourses();case 4:t=e.sent,a=this.filterCourses(t),this.setState({courses:a,filteredCourses:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.setState({loadingError:!0});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[0,9,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"filterCourses",value:function(e){var t=this.state.framework,a=[];return e.forEach(function(e){if("1"!==e.archived){var n=e.competency_profile.filter(function(e){return(e.title||"").toLowerCase()===t});if(0!==n.length){var r=Object(Y.a)({},e,{competencies:W(n.map(function(e){return W(e.domains.map(function(e){return e.competencies.map(function(t){return Object(Y.a)({},t,{domain:e.title})})}))}))});a.push(r)}}}),a}},{key:"render",value:function(){var e=this,t=this.state,a=t.filteredCourses,n=t.framework,c=t.filter;if(t.loadingError)return r.a.createElement(R,null);var i=a.map(function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(s.b,{to:"/training-resources/".concat(e.id)},e.title)),r.a.createElement("td",null,e.type),r.a.createElement("td",null,r.a.createElement("ul",null,e.competencies.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(s.b,{to:"/framework/".concat(n,"/competency/details/").concat(e.id)},e.title))}))))});return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"search",value:c,onChange:function(t){return e.onFilter(t.target.value)},placeholder:"Filter resources"}),r.a.createElement("table",null,r.a.createElement("tbody",null,i)))}}]),t}(n.Component),le=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).competencyService=new P,a.activeRequests=new B,a.state={framework:a.props.match.params.framework,frameworkName:"",description:"",domains:[],filter:"",filteredDomains:[],loadingError:!1},a.onFilter=function(e){var t,n=a.state.domains;try{t=new RegExp(e,"i")}catch(c){t=/./}var r=n.map(function(e){var a=e.competencies.filter(function(e){return t.test(e.title)});return 0===a.length?null:Object(Y.a)({},e,{competencies:a})});a.setState({filter:e,filteredDomains:r})},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,Promise.all([this.fetchFramework(),this.fetchAllFrameworks()]);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.setState({loadingError:!0});case 9:return e.prev=9,this.activeRequests.finishRequest(),e.finish(9);case 12:case"end":return e.stop()}},e,this,[[0,6,9,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){window.scroll(0,0)}},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,e.next=3,this.competencyService.getFramework(t);case 3:a=e.sent,n=W(a.map(function(e){return e.domains})),this.setState({domains:n,filteredDomains:n});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchAllFrameworks",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,e.next=3,this.competencyService.getAllFrameworks();case 3:a=e.sent,(n=a.filter(function(e){return e.name.toLowerCase()===t})).length&&this.setState({frameworkName:n[0].name,description:z(n[0].description)});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.frameworkName,n=t.description,c=t.filteredDomains,i=t.framework,s=t.filter;if(t.loadingError)return r.a.createElement(R,null);var o=c.map(function(e,t){return null===e?null:r.a.createElement(se,{key:e.nid,index:t,framework:i,domain:e,disable:!0})});return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,a),r.a.createElement("p",null,n),r.a.createElement(ee.d,null,r.a.createElement(ee.b,null,r.a.createElement(ee.a,null,"Competencies"),r.a.createElement(ee.a,null,"Training resources")),r.a.createElement(ee.c,null,r.a.createElement("input",{type:"search",value:s,onChange:function(t){return e.onFilter(t.target.value)},placeholder:"Filter competencies"}),r.a.createElement("table",null,o)),r.a.createElement(ee.c,null,r.a.createElement(oe,{framework:i}))))}}]),t}(n.Component),ue=a(12),me=a(13),de=a.n(me),he=a(25),pe=a.n(he),fe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={data:[],csrf:"",updateFlag:!1,path:a.props.location.pathname.split("/"),nid:"",title:"",dates:"",dates2:"",type:"",description:"",location:"",url:"",target_audience:"",learning_outcomes:"",keywords:"",organisers:"",trainers:""},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"changeDescription",value:function(e){var t=e.editor.getData();this.setState({description:t})}},{key:"changeTargetAudience",value:function(e){var t=e.editor.getData();this.setState({target_audience:t})}},{key:"changeLearningOutcomes",value:function(e){var t=e.editor.getData();this.setState({learning_outcomes:t})}},{key:"changeOrganisers",value:function(e){var t=e.editor.getData();this.setState({organisers:t})}},{key:"changeTrainers",value:function(e){var t=e.editor.getData();this.setState({trainers:t})}},{key:"componentDidMount",value:function(){var e=this;this.setState({nid:this.state.path[3]});var t="".concat(M,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(M,"/api/v1/training-resources/all?_format=json");fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({data:t})})}},{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"render",value:function(){var e=this;this.checkUser();var t="",a="",n="",c="",i="",s="",o="",l="",u="",m="",d="",h="",p="";return this.state.data.forEach(function(r){r.id===e.state.nid&&(t=r.id,a=r.title,n=r.start_date,c=r.end_date,i=r.type,s=r.description,o=r.location,l=r.url,u=r.target_audience,m=r.learning_outcomes,d=r.keywords,h=r.organisers,p=r.trainers)}),this.state.data.length>0?(console.log(a),r.a.createElement(ve,{nid:t,title:a,dates:n,dates2:c,type:i,description:s,location:o,url:l,target_audience:u,learning_outcomes:m,keywords:d,organisers:h,trainers:p})):null}}]),t}(r.a.Component),ve=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).setRedirect=function(){a.props.history.push("all-training-resources")},a.state={nid:a.props.nid,title:a.props.title,dates:a.props.dates,dates2:a.props.dates2,type:a.props.type,description:a.props.description,location:a.props.location,url:a.props.url,target_audience:a.props.target_audience,learning_outcomes:a.props.learning_outcomes,keywords:a.props.keywords,organisers:a.props.organisers,trainers:a.props.trainers,redirect:!1,updateFlag:!1,csrf:""},a.handleTitle=a.handleTitle.bind(Object(ue.a)(a)),a.handleDates=a.handleDates.bind(Object(ue.a)(a)),a.handleDates2=a.handleDates2.bind(Object(ue.a)(a)),a.handleType=a.handleType.bind(Object(ue.a)(a)),a.handleDesc=a.handleDesc.bind(Object(ue.a)(a)),a.handleLocation=a.handleLocation.bind(Object(ue.a)(a)),a.handleURL=a.handleURL.bind(Object(ue.a)(a)),a.handleTargetAudience=a.handleTargetAudience.bind(Object(ue.a)(a)),a.handleLearningOutcomes=a.handleLearningOutcomes.bind(Object(ue.a)(a)),a.handleKeywords=a.handleKeywords.bind(Object(ue.a)(a)),a.handleOrganisers=a.handleOrganisers.bind(Object(ue.a)(a)),a.handleTrainers=a.handleTrainers.bind(Object(ue.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this,t="".concat(M,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})})}},{key:"handleTitle",value:function(e){this.setState({title:e.value})}},{key:"handleDates",value:function(e){this.setState({dates:e.value})}},{key:"handleDates2",value:function(e){this.setState({dates2:e.value})}},{key:"handleType",value:function(e){this.setState({type:e.value})}},{key:"handleDesc",value:function(e){this.setState({description:e.editor.getData()})}},{key:"handleLocation",value:function(e){this.setState({location:e.value})}},{key:"handleURL",value:function(e){this.setState({url:e.value})}},{key:"handleTargetAudience",value:function(e){this.setState({target_audience:e.editor.getData()})}},{key:"handleLearningOutcomes",value:function(e){this.setState({learning_outcomes:e.editor.getData()})}},{key:"handleKeywords",value:function(e){this.setState({keywords:e.value})}},{key:"handleOrganisers",value:function(e){this.setState({organisers:e.editor.getData()})}},{key:"handleTrainers",value:function(e){this.setState({trainers:e.editor.getData()})}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(setTimeout(function(){a.context.router.history.push("/training-resources/"+a.state.nid)},1e3),console.log("componentDidUpdate"))}},{key:"handleSubmit",value:function(e){var t=this.state.nid,a=this.refs.title.value,n=this.refs.dates.value,r=this.refs.dates2.value,c=this.refs.type.value,i=this.state.description,s=this.refs.location.value,o=this.refs.url.value,l=this.state.target_audience,u=this.state.learning_outcomes,m=this.state.organisers,d=this.state.trainers,h=this.refs.keywords.value,p=localStorage.getItem("csrf_token");fetch("".concat(M,"/node/")+t+"?_format=hal_json",{method:"PATCH",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":p,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(M,"/rest/type/node/training_resource")}},title:[{value:a}],field_dates:[{value:n}],field_end_date:[{value:r}],field_type:[{value:c}],field_description:[{value:i,format:"basic_html"}],field_location:[{value:s}],field_url:[{value:o}],field_target_audience:[{value:l,format:"basic_html"}],field_learning_outcomes:[{value:u,format:"basic_html"}],field_keywords:[{value:h}],field_organisers:[{value:m,format:"basic_html"}],field_trainers:[{value:d,format:"basic_html"}],type:[{target_id:"training_resource"}]})}),e.preventDefault(),this.setState({updateFlag:!0})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Edit Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12 callout"},r.a.createElement("form",{className:"form",id:"resource_edit_form",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Title"),r.a.createElement("input",{type:"text",ref:"title",id:"title",value:this.state.title,onChange:this.handleTitle.bind(this),required:!0,placeholder:"Title"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Dates"),r.a.createElement("input",{type:"date",ref:"dates",value:this.state.dates,onChange:this.handleDates.bind(this),placeholder:"Date"})),r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Dates"),r.a.createElement("input",{type:"date",ref:"dates2",value:this.state.dates2,onChange:this.handleDates2.bind(this),placeholder:"Date"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Event type"),r.a.createElement("select",{ref:"type",value:this.state.type,onChange:this.handleType.bind(this)},r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Description"),r.a.createElement(pe.a,{content:this.state.description,events:{change:this.handleDesc},activeClass:"p10",required:!0}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Location"),r.a.createElement("input",{type:"text",ref:"location",value:this.state.location,onChange:this.handleLocation.bind(this),placeholder:"Location"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"URL"),r.a.createElement("input",{type:"text",ref:"url",value:this.state.url,onChange:this.handleURL.bind(this),required:!0,placeholder:"URL"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Target audience"),r.a.createElement(pe.a,{content:this.state.target_audience,events:{change:this.handleTargetAudience},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Learning outcomes"),r.a.createElement(pe.a,{content:this.state.learning_outcomes,events:{change:this.handleLearningOutcomes},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Organisers"),r.a.createElement(pe.a,{content:this.state.organisers,events:{change:this.handleOrganisers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Trainers"),r.a.createElement(pe.a,{content:this.state.trainers,events:{change:this.handleTrainers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Keywords"),r.a.createElement("input",{type:"text",ref:"keywords",value:this.state.keywords,onChange:this.handleKeywords.bind(this),placeholder:"Keywords"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Update"})))))))}}]),t}(r.a.Component);ve.contextTypes={router:de.a.object};var ge=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resource/edit/:nid",component:fe}))},Ee=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).changeDescription=a.changeDescription.bind(Object(ue.a)(a)),a.changeTargetAudience=a.changeTargetAudience.bind(Object(ue.a)(a)),a.changeLearningOutcomes=a.changeLearningOutcomes.bind(Object(ue.a)(a)),a.changeOrganisers=a.changeOrganisers.bind(Object(ue.a)(a)),a.changeTrainers=a.changeTrainers.bind(Object(ue.a)(a)),a.state={data:[],csrf:"",updateFlag:!1,content:"content",description:"",target_audience:"",learning_outcomes:"",organisers:"",trainers:""},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"changeDescription",value:function(e){var t=e.editor.getData();this.setState({description:t})}},{key:"changeTargetAudience",value:function(e){var t=e.editor.getData();this.setState({target_audience:t})}},{key:"changeLearningOutcomes",value:function(e){var t=e.editor.getData();this.setState({learning_outcomes:t})}},{key:"changeOrganisers",value:function(e){var t=e.editor.getData();this.setState({organisers:t})}},{key:"changeTrainers",value:function(e){var t=e.editor.getData();this.setState({trainers:t})}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(setTimeout(function(){a.props.history.push("/all-training-resources")},1e3),console.log("componentDidUpdate"))}},{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"componentDidMount",value:function(){var e=this,t="".concat(M,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})})}},{key:"handleSubmit",value:function(e){var t=this.refs.title.value,a=this.refs.dates.value,n=this.refs.dates2.value,r="Online";this.refs.type.value&&(r=this.refs.type.value);var c=this.state.description,i=this.refs.location.value,s=this.refs.url.value,o=this.state.target_audience,l=this.state.learning_outcomes,u=this.refs.keywords.value,m=this.state.organisers,d=this.state.trainers,h=localStorage.getItem("csrf_token");fetch("".concat(M,"/node?_format=hal_json"),{credentials:"include",method:"POST",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":h,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(M,"/rest/type/node/training_resource")}},title:[{value:t}],field_dates:[{value:a}],field_end_date:[{value:n}],field_type:[{value:r}],field_description:[{value:c,format:"basic_html"}],field_location:[{value:i}],field_url:[{value:s}],field_target_audience:[{value:o,format:"basic_html"}],field_learning_outcomes:[{value:l,format:"basic_html"}],field_keywords:[{value:u}],field_organisers:[{value:m,format:"basic_html"}],field_trainers:[{value:d,format:"basic_html"}],type:[{target_id:"training_resource"}]})}),e.target.reset(),this.setState({updateFlag:!0}),e.preventDefault()}},{key:"render",value:function(){return this.checkUser(),r.a.createElement("div",null,r.a.createElement("h2",null,"Create Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12 callout"},r.a.createElement("h4",null,"Create new competency"),r.a.createElement("form",{className:"form",id:"resource_create_form",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Title"),r.a.createElement("input",{type:"text",ref:"title",required:!0,placeholder:"Title"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Start Date"),r.a.createElement("input",{type:"date",ref:"dates",placeholder:"Date"})),r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"End Date"),r.a.createElement("input",{type:"date",ref:"dates2",placeholder:"Date"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Event type"),r.a.createElement("select",{ref:"type"},r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Description"),r.a.createElement(pe.a,{content:this.state.description,events:{change:this.changeDescription},activeClass:"p10",required:!0}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Location"),r.a.createElement("input",{type:"text",ref:"location",placeholder:"Location"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"URL"),r.a.createElement("input",{type:"text",ref:"url",required:!0,placeholder:"URL"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Target audience"),r.a.createElement(pe.a,{content:this.state.target_audience,events:{change:this.changeTargetAudience},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Learning outcomes"),r.a.createElement(pe.a,{content:this.state.learning_outcomes,events:{change:this.changeLearningOutcomes},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Organisers"),r.a.createElement(pe.a,{content:this.state.organisers,events:{change:this.changeOrganisers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Trainers"),r.a.createElement(pe.a,{content:this.state.trainers,events:{change:this.changeTrainers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Keywords"),r.a.createElement("input",{type:"text",ref:"keywords",placeholder:"Keywords"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))))))}}]),t}(r.a.Component),be=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resource/create",component:Ee}))},ye=a(95),ke=a.n(ye),we=window.$,Oe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={data:[],framework:a.props.selectedFramework,resourceID:a.props.resourceID,frameworkdetails:[],csrf:"",frameworkUUID:"",competencies:[],attributes:a.props.selectedAttributes,selectedAttributes:a.props.selectedAttributes,selectedCompetencies:a.props.selectedCompetencies,resourceDetails:[]},a.handleSelect=a.handleSelect.bind(Object(ue.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleSelect",value:function(){for(var e=this.state.selectedAttributes,t=[],a=localStorage.getItem("csrf_token"),n=0;n<e.length;n++)t.push(e[n].split("id",2));if(t.length>0){for(var r={_links:Object(j.a)({type:{href:"".concat(M,"/rest/type/node/training_resource")}},"".concat(M,"/rest/relation/node/training_resource/field_attribute_mapped"),{href:"http://dev-competency-mapper.pantheonsite.io/node/"+t[0][1]+"?_format=hal_json"}),type:[{target_id:"training_resource"}],_embedded:{}},c=[],i=0;i<t.length;i++)c.push({_links:{self:{href:"".concat(M,"/node/")+t[i][1]+"?_format=hal_json"},type:{href:"".concat(M,"/rest/type/node/attribute")}},uuid:[{value:t[i][0]}]});r._embedded=Object(j.a)({},"".concat(M,"/rest/relation/node/training_resource/field_attribute_mapped"),c),fetch("".concat(M,"/node/")+this.state.resourceID+"?_format=hal_json",{credentials:"include",method:"PATCH",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":a,Authorization:"Basic"},body:JSON.stringify(r)})}this.props.handleCloseModal()}},{key:"handleAllCheck",value:function(e,t,a){var n=this.state.selectedAttributes,r=document.getElementsByName(e);if(a.target.checked)for(var c=0;c<r.length;c++)r[c].checked=!0,n.push(r[c].getAttribute("data-uuid")+"id"+r[c].getAttribute("data-id")),this.setState({selectedAttributes:n}),console.log(this.state.selectedAttributes);else for(var i=0;i<r.length;i++)!0===r[i].checked&&(r[i].checked=!1,n.splice(n.indexOf(r[i]),1),this.setState({selectedAttributes:n}),console.log(this.state.selectedAttributes))}},{key:"handleAttributeClick",value:function(e,t,a){var n=this.state.selectedAttributes;a.target.checked?(n.push(t+"id"+e),this.setState({selectedAttributes:n}),document.getElementById(a.target.name).checked=!0,console.log(this.state.selectedAttributes)):(n.splice(n.indexOf(t+"id"+e),1),this.setState({selectedAttributes:n}),we(":checkbox[name="+a.target.name+"]").is(":checked")||(document.getElementById(a.target.name).checked=!1,console.log(this.state.selectedAttributes)))}},{key:"handleListAllChecked",value:function(e){var t=[];we(":checkbox").each(function(){we(this).is(":checked")&&t.push(we(this).attr("id"))}),alert(t)}},{key:"componentDidMount",value:function(){var e=this,t="".concat(M,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(M,"/api/v1/framework/")+this.state.framework+"?_format=json";fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({data:t})});var n="".concat(M,"/api/v1/framework?_format=json");fetch(n).then(function(e){return e.json()}).then(function(t){e.setState({frameworkdetails:t})}),fetch("".concat(M,"/node/")+this.state.resourceID+"?_format=hal_json").then(function(e){return e.json()}).then(function(t){e.setState({resourceDetails:t})})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.attributes===t.attributes}},{key:"render",value:function(){var e=this,t=this.state.frameworkdetails,a=this.state.data,n=[],c=[],i=[];t.forEach(function(t,a){t.name.toLowerCase()===e.state.framework&&(e.state.frameworkUUID=t.uuid,t.attribute_types.forEach(function(e){n.push(e.title),i.push(r.a.createElement("option",{"data-id":e.id,value:e.uuid},e.title))}),t.domains.forEach(function(e){c.push(r.a.createElement("option",{"data-id":e.id,value:e.uuid},e.title))}))});var s=a.map(function(t){return t.domains.map(function(t,a){return r.a.createElement("tbody",null,r.a.createElement("tr",{key:t.nid},r.a.createElement("td",null,a+1)," ",r.a.createElement("td",null,r.a.createElement("strong",null," ",t.title)," ")," "),t.competencies.map(function(t,c){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,a+1,".",c+1),r.a.createElement("td",null,r.a.createElement("input",{type:"checkbox",defaultChecked:-1!==e.state.selectedCompetencies.indexOf(t.id),"data-test":t.uuid,id:t.id,onChange:e.handleAllCheck.bind(e,t.id,t.uuid)})," ",t.title,r.a.createElement("ul",{style:{marginLeft:"1em",marginBottom:"1em"}},n.map(function(a){return r.a.createElement("div",{style:{marginLeft:"1em"}},r.a.createElement("div",null," ",r.a.createElement("strong",null,r.a.createElement("em",null,a))),t.attributes.filter(function(e){return e.type===a}).map(function(a){return r.a.createElement("li",{key:a.id,style:{marginLeft:"1em"}},r.a.createElement("input",{type:"checkbox",defaultChecked:-1!==e.state.selectedAttributes.indexOf(a.uuid+"id"+a.id),name:t.id,"data-id":a.id,"data-uuid":a.uuid,id:a.id,onChange:e.handleAttributeClick.bind(e,a.id,a.uuid)})," ",a.title)}))}))))}),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("td",null))))})});return r.a.createElement("div",null,s,r.a.createElement("div",{id:"footer-button"},r.a.createElement("button",{className:"button",onClick:this.handleSelect.bind(this)}," ","Save")))}}]),t}(r.a.Component),je=a(38),_e=a.n(je),Se=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={resources:[],frameworks:[],resourcePath:a.props.location.pathname.split("/"),showModal:!1,selectedFramework:"",updateFlag:""},a.handleOpenModal=a.handleOpenModal.bind(Object(ue.a)(a)),a.handleCloseModal=a.handleCloseModal.bind(Object(ue.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleOpenModal",value:function(e,t){this.setState({showModal:!0}),this.setState({selectedFramework:e}),t.preventDefault()}},{key:"handleCloseModal",value:function(){this.setState({showModal:!1}),this.setState({updateFlag:!0})}},{key:"componentDidUpdate",value:function(){var e=this;this.state.updateFlag&&(this.fetchData(),setTimeout(function(){e.setState({updateFlag:!1})},1e3),console.log("componentDidUpdate"))}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t="".concat(M,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(M,"/api/v1/training-resources/all?_format=hal_json");fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({resources:t})}),fetch("".concat(M,"/api/v1/framework?_format=json")).then(function(e){return e.json()}).then(function(t){e.setState({frameworks:t})})}},{key:"mappingBlock",value:function(){var e=this;if(localStorage.getItem("roles")&&localStorage.getItem("roles").includes("content_manager"))return r.a.createElement("div",{className:"callout white-color industry-background"},r.a.createElement("strong",null," Manage competency profile "),r.a.createElement("ul",null,this.state.frameworks.map(function(t,a){return r.a.createElement("li",{style:{display:"inline",margin:"5px"}},r.a.createElement("a",{onClick:e.handleOpenModal.bind(e,t.name.toLowerCase())}," ",r.a.createElement("i",{className:"fas fa-tags"})," ",t.name," "))})))}},{key:"render",value:function(){var e=this,t=[],a=[],n=[],c=this.state.resources.map(function(c,i){return c.id===e.state.resourcePath[2]?(c.competency_profile.map(function(e){return e.domains.map(function(e){return e.competencies.map(function(e){return e.attributes.map(function(e){return t.push(e.uuid+"id"+e.id)},a.push(e.id))})})}),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,c.title)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-9"},r.a.createElement("div",{className:"callout"},c.date?r.a.createElement("p",null,r.a.createElement("strong",null,"Date:")," ",c.dates):"",c.keywords?r.a.createElement("p",null,r.a.createElement("strong",null,"Keywords:")," ",c.keywords):"",c.location?r.a.createElement("p",null,r.a.createElement("strong",null,"Location:")," ",c.location):"",c.type?r.a.createElement("p",null,r.a.createElement("strong",null,"Type:")," ",c.type):"",c.url?r.a.createElement("p",null,r.a.createElement("strong",null," URL: ")," ",r.a.createElement("a",{href:c.url,target:"_blank"},c.url)):""),r.a.createElement("h3",null,"Overview"),_e()(c.description),c.target_audience?_e()("<h3>Target Audience</h3>"+c.target_audience):"",c.learning_outcomes?_e()("<h3>Learning Outcomes</h3>"+c.learning_outcomes):"",c.organisers?_e()("<h3>Organizers</h3>"+c.organisers):"",c.trainers?_e()("<h3>Trainers</h3>"+c.trainers):"",r.a.createElement("h3",null,"Competency Profile"),r.a.createElement("table",{className:"hover"},r.a.createElement("tbody",null,c.competency_profile.map(function(t){return r.a.createElement("tr",null,e.state.frameworks.map(function(e){return e.id===t.id&&e.attribute_types.map(function(e){return n.push(e.title)}),null}),r.a.createElement("td",null,r.a.createElement("h4",null,t.title)),r.a.createElement("td",null,t.domains.map(function(e){return r.a.createElement("div",null,r.a.createElement("h5",null,e.title),r.a.createElement("ul",null,e.competencies.map(function(e){return r.a.createElement("li",null,r.a.createElement("strong",null," ",e.title),r.a.createElement("ul",null,n.map(function(t){return r.a.createElement("span",null,e.attributes.map(function(e){return e.type===t?r.a.createElement("li",null," ",r.a.createElement("em",null,t)," -"," ",e.title):null}))})))})))})))})))),r.a.createElement("div",{className:"column large-3 callout industry-background white-color"},r.a.createElement("h3",null,"More information"),r.a.createElement("p",null,"We can place some relevant information in this block to make the page look more beautiful")))))):null});return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},c,this.mappingBlock()),r.a.createElement("div",{style:{overflow:"scroll"}},r.a.createElement(ke.a,{isOpen:this.state.showModal,className:"Modal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},r.a.createElement("div",null,r.a.createElement("h2",{style:{"text-align":"center"}},"Manage competency profile for"," ",this.state.selectedFramework.toUpperCase()," ",r.a.createElement("i",{className:"fas fa-window-close float-right","data-close":!0,onClick:this.handleCloseModal})," ")),r.a.createElement("table",null,r.a.createElement(Oe,{selectedCompetencies:a,selectedAttributes:t,selectedFramework:this.state.selectedFramework,resourceID:this.state.resourcePath[2],handleCloseModal:this.handleCloseModal})))))}}]),t}(r.a.Component),Ce=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resources/:id",component:Se}))},Ne=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={resources:[],filterType:""},a.archiveHandle=a.archiveHandle.bind(Object(ue.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(this.fetchData(),setTimeout(function(){a.setState({updateFlag:!1})},1e3),console.log("componentDidUpdate"))}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t="".concat(M,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(M,"/api/v1/training-resources/all?_format=json");fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({resources:t})})}},{key:"filter",value:function(e){this.setState({filter:e.target.value})}},{key:"filterTypeHandle",value:function(e){this.setState({filterType:e.target.value})}},{key:"archiveHandle",value:function(e,t,a){var n="";n=1!==t;var r=localStorage.getItem("csrf_token");fetch("".concat(M,"/node/")+e+"?_format=hal_json",{credentials:"include",method:"PATCH",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":r,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(M,"/rest/type/node/training_resource")}},field_archived:[{value:n}],type:[{target_id:"training_resource"}]})}),this.setState({updateFlag:!0}),a.preventDefault()}},{key:"render",value:function(){var e=this;this.checkUser();var t=this.state.resources;this.state.filter&&(t=t.filter(function(t){return t.title.toLowerCase().includes(e.state.filter.toLowerCase())||t.description.toLocaleLowerCase().includes(e.state.filter.toLowerCase())})),"All"!==this.state.filterType&&(t=t.filter(function(t){return t.type.toLocaleLowerCase().includes(e.state.filterType.toLowerCase())}));var a=t.map(function(t,a){return r.a.createElement("tr",{key:a},r.a.createElement("td",null,a+1," "),r.a.createElement("td",null," ",r.a.createElement("h4",null," ",r.a.createElement(s.b,{to:"/training-resources/"+t.id},t.title," ")),r.a.createElement("p",null,t.dates," "),r.a.createElement("strong",null,"Learning resource type:")," ",t.type," ",r.a.createElement("br",null),_e()(t.description.substr(0,240)+"...")," ",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("strong",null," URL: ")," ",r.a.createElement("a",{href:t.url,target:"_blank"},t.url)),r.a.createElement("td",null,"1"===t.archived?r.a.createElement("a",{onClick:e.archiveHandle.bind(e,t.id,1)}," ",r.a.createElement("i",{className:"fas fa-toggle-on"})," ",r.a.createElement("span",null,"Archived")," "):r.a.createElement("a",{onClick:e.archiveHandle.bind(e,t.id,0)}," ",r.a.createElement("i",{className:"fas fa-toggle-off"}))),r.a.createElement("td",null,r.a.createElement(s.b,{to:"/training-resource/edit/".concat(t.id)},r.a.createElement("i",{className:"fas fa-edit"})," ")))});return r.a.createElement("div",{className:"row"},r.a.createElement("h3",null,"Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-8"},r.a.createElement("div",null,r.a.createElement("input",{type:"text",onChange:this.filter.bind(this),placeholder:"Type to search"}))),r.a.createElement("div",{className:"column large-2"},r.a.createElement("div",null,r.a.createElement("select",{ref:"type",onChange:this.filterTypeHandle.bind(this)},r.a.createElement("option",{value:"All"},"All"),r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"column large-2"},r.a.createElement(s.b,{className:"button float-right",to:"/training-resource/create"},r.a.createElement("i",{className:"fas fa-plus-circle"}," ")," Add new"," "))),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"S. No."),r.a.createElement("th",null,"Details"),r.a.createElement("th",null,"Archive"),r.a.createElement("th",null,"Edit"))),r.a.createElement("tbody",null,a)))}}]),t}(r.a.Component),xe=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/all-training-resources",component:Ne}))},De=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={data:[],roles:"",user:""},a.handlePasswordChange=a.handlePasswordChange.bind(Object(ue.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handlePasswordChange",value:function(e){var t=this.refs.old.value,a=this.refs.new1.value,n=localStorage.getItem("userid");fetch("".concat(M,"/user/")+n+"/password?_format=json",{credentials:"include",method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-Token":localStorage.getItem("csrf_token")},body:JSON.stringify({_links:{type:{href:"".concat(M,"/rest/type/user/user")}},old:[{value:t}],new:[{target_id:a}]})}).then(function(e){return e}).then(function(e){return setTimeout(function(){alert("Password changed successfully"),window.location.reload()},1e3)}),e.preventDefault()}},{key:"checkUser",value:function(){localStorage.getItem("roles")||this.props.history.push("/")}},{key:"render",value:function(){return this.checkUser(),r.a.createElement("div",null,r.a.createElement("h3",null,"Change password:"),r.a.createElement("form",{id:"passChange"},r.a.createElement("input",{type:"password",ref:"old",placeholder:"Old password"}),r.a.createElement("input",{type:"password",ref:"new1",placeholder:"New password"}),r.a.createElement("input",{type:"password",placeholder:"Confirm new password"}),r.a.createElement("input",{type:"button",className:"button",onClick:this.handlePasswordChange.bind(this),value:"Submit"})))}}]),t}(r.a.Component);var Ae=function(e){var t=e.framework,a=z(t.field_description);return a.length>120&&(a="".concat(a.slice(0,120).trim(),"...")),r.a.createElement("div",{className:"column medium-4"},r.a.createElement(s.b,{className:"column callout","data-equalizer-watch":!0,to:"/framework/".concat(t.title.toLowerCase())},r.a.createElement("img",{className:"float-center margin-bottom-medium",style:{height:"6rem"},src:"http://dev-competency-mapper.pantheonsite.io/".concat(t.field_logo),alt:"competency logo"}),r.a.createElement("h5",null,a,r.a.createElement("i",{className:"icon icon-functional","data-icon":">"}))))},Re=window.$;var Te=function(e){var t=e.frameworks,a=new r.a.createRef;return t.length<1?null:r.a.createElement("div",{className:"row","data-equalizer":!0,ref:a},(window.setTimeout(function(){return Re(a.current).foundation()}),t.map(function(e){return r.a.createElement(Ae,{key:e.nid,framework:e})})))},qe=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).competencyService=new P,a.activeRequests=new B,a.state={frameworks:[]},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.activeRequests.startRequest(),e.next=3,this.competencyService.getAllFrameworksDetails();case 3:t=e.sent,this.setState({frameworks:t}),this.activeRequests.finishRequest();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.frameworks;return r.a.createElement("div",{className:"column"},r.a.createElement("h3",null,"Overview"),r.a.createElement("p",{className:"lead"},"Introduction to the idea of competency frameworks and their linkage with training resources. Two lines of description should look good and then links can be given to"," ",r.a.createElement("a",{className:"readmore"},"read more")),r.a.createElement(Te,{frameworks:e}))}}]),t}(n.Component),Le=new I,Fe="".concat(M,"/user/login?_format=json"),Ie="".concat(M,"/user/logout");function Ue(e,t){return Me.apply(this,arguments)}function Me(){return(Me=Object(m.a)(u.a.mark(function e(t,a){var n,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t,pass:a},e.prev=1,e.next=4,Le.post(Fe,n);case 4:return r=e.sent,c=r.data,localStorage.setItem("roles",c.current_user.roles),localStorage.setItem("csrf_token",c.csrf_token),localStorage.setItem("logout_token",c.logout_token),localStorage.setItem("user",c.current_user.name),localStorage.setItem("userid",c.current_user.uid),e.abrupt("return",c);case 14:throw e.prev=14,e.t0=e.catch(1),Pe(),e.t0;case 18:case"end":return e.stop()}},e,null,[[1,14]])}))).apply(this,arguments)}function Pe(){return localStorage.removeItem("roles"),localStorage.removeItem("csrf_token"),localStorage.removeItem("logout_token"),localStorage.removeItem("userid"),localStorage.removeItem("user"),Le.post(Ie)}var Be=window.$,He=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(p.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:!1,roles:localStorage.getItem("roles")||"",user:localStorage.getItem("user")||""},a.activeRequests=new B,a.handleActiveRequests=function(e){return a.setState({isActive:e})},a.detectUserChangesFromOtherTabs=function(e){var t=e.key,n=e.newValue;"user"===t&&(n?a.setState({user:localStorage.getItem("user"),roles:localStorage.getItem("roles")}):a.setState({user:"",roles:""}))},a.handleLogin=function(){var e=Object(m.a)(u.a.mark(function e(t,n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ue(t,n);case 3:a.setState({user:localStorage.getItem("user"),roles:localStorage.getItem("roles")}),e.next=17;break;case 6:if(e.prev=6,e.t0=e.catch(0),window.console.error(e.t0),!e.t0.response){e.next=17;break}e.t1=e.t0.response.status,e.next=400===e.t1?13:15;break;case 13:return window.alert(e.t0.response.data.message),e.abrupt("return");case 15:window.alert("Sorry, there was an unknown login problem, please try again.");case 16:window.alert("Sorry, there was an unknown login problem, please try again.");case 17:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleLogout=function(){a.setState({user:"",roles:""}),Pe()},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){Be(document).foundation(),Be(document).foundationExtendEBI(),this.subcription=this.activeRequests.addEventListener(this.handleActiveRequests),window.addEventListener("storage",this.detectUserChangesFromOtherTabs)}},{key:"componentWillUnmount",value:function(){this.subcription&&this.activeRequests.removeEventListener(this.subcription),window.removeEventListener("storage",this.detectUserChangesFromOtherTabs)}},{key:"render",value:function(){var e=this.state,t=e.isActive,a=e.roles,n=e.user;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.SnackbarProvider,{maxSnack:1,anchorOrigin:{vertical:"bottom",horizontal:"center"},preventDuplicate:!0},r.a.createElement(S,{roles:a,user:n,isActive:t,onLogin:this.handleLogin,onLogout:this.handleLogout}),r.a.createElement("section",{id:"main-content-area",className:"row",role:"main"},r.a.createElement("main",{className:"column"},r.a.createElement(g.d,null,r.a.createElement(We,{condition:!!n&&a.includes("content_manager"),path:"/training-resource/edit/:nid",component:ge}),r.a.createElement(We,{condition:!!n&&a.includes("content_manager"),path:"/training-resource/create",component:be}),r.a.createElement(g.b,{condition:!!n&&a.includes("framework_manager"),path:"/training-resources/:id",component:Ce}),r.a.createElement(g.b,{path:"/all-training-resources",component:xe}),r.a.createElement(We,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/manage/competencies/:cid/manage-attributes",component:V}),r.a.createElement(We,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/manage/competencies/:domainId?",component:$}),r.a.createElement(We,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/competency/details/:cid",component:Z}),r.a.createElement(g.b,{path:"/framework/:framework",component:le}),r.a.createElement(g.b,{path:"/user/change/password",component:De}),r.a.createElement(g.b,{path:"/",component:qe}))))))}}]),t}(n.Component),We=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.component,a=e.condition,n=Object(o.a)(e,["component","condition"]);return r.a.createElement(g.b,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,e):r.a.createElement(g.a,{to:"/"})}}))}}]),t}(n.Component);i.a.render(r.a.createElement(s.a,{basename:""},r.a.createElement(He,null)),document.getElementById("root"))},62:function(e,t,a){e.exports={meter:"progress-bar_meter__2KLWm",progress:"progress-bar_progress__QKIy2"}},98:function(e,t,a){e.exports=a(170)}},[[98,1,2]]]);
//# sourceMappingURL=main.82938301.chunk.js.map