(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,a){e.exports=a(173)},106:function(e,t,a){},116:function(e,t,a){},172:function(e,t,a){},173:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),i=a.n(c),o=a(6),s=(a(106),a(88)),l=a(1),u=a.n(l),m=a(3),p=a(5),h=a(4),d=a(9),f=a(8),v=a(10),g=a(45),b=a(66),y=a.n(b);function E(e){var t=e.isActive;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("div",{className:"warning progress ".concat(y.a.progress),role:"progressbar"},r.a.createElement("div",{className:"progress-meter ".concat(y.a.meter)})))}E.defaultProps={isActive:!1};var k=E,w=window.$,j=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).navRef=r.a.createRef(),a.logout=function(){(0,a.props.onLogout)()},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){w(this.navRef.current).foundation()}},{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user,n=r.a.createElement("li",null,r.a.createElement("a",{tabIndex:"0",className:"dropdown-on-dark-background"},"Manage Competencies"),r.a.createElement("ul",{className:"menu vertical"},r.a.createElement("li",null,r.a.createElement(o.b,{to:"/framework/bioexcel/manage/competencies"},"BioExcel")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/framework/corbel/manage/competencies"},"CORBEL")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/framework/iscb/manage/competencies"},"ISCB")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/framework/ritrain/manage/competencies"},"RITrain")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/framework/nhs/manage/competencies"},"NHS")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/framework/cineca/manage/competencies"},"CINECA")))),c=r.a.createElement("li",null,r.a.createElement(o.b,{to:"/all-training-resources"},"Manage Training Resources")),i=r.a.createElement("li",null,r.a.createElement("a",{tabIndex:"0",className:"dropdown-on-light-background"},r.a.createElement("i",{className:"fas fa-user"})," Hi ",a),r.a.createElement("ul",{className:"menu vertical"},r.a.createElement("li",null,r.a.createElement(o.b,{to:"/user/change/password"},"Change password")),r.a.createElement("li",null,r.a.createElement("a",{onClick:this.logout},"Logout"))));return r.a.createElement("nav",{ref:this.navRef},r.a.createElement("ul",{className:"dropdown menu float-left","data-dropdown-menu":!0,"data-description":"navigational"},t.includes("framework_manager")&&n,t.includes("content_manager")&&c),r.a.createElement("ul",{className:"dropdown menu float-right","data-dropdown-menu":!0,"data-description":"user tasks"},i))}}]),t}(n.Component),_=a(14),O=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:""},a.onChange=function(e){a.setState(Object(_.a)({},e.currentTarget.name,e.currentTarget.value))},a.submit=function(){var e=a.props.onSubmit,t=a.state,n=t.username,r=t.password;n&&r&&e(n,r)},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.password;return r.a.createElement("nav",null,r.a.createElement("ul",{className:"menu float-left small-12"},r.a.createElement("li",{className:"small-12 margin-bottom-large"},r.a.createElement("label",{className:"columns small-4 medium-3 large-2 margin-top-large"},r.a.createElement("input",{value:a,name:"username",onChange:function(t){return e.onChange(t)},type:"text",autoComplete:"username",placeholder:"Username"})),r.a.createElement("label",{className:"columns small-4 medium-3 large-2 margin-top-large"},r.a.createElement("input",{value:n,name:"password",onChange:function(t){return e.onChange(t)},type:"password",autoComplete:"current-password",placeholder:"Password"})),r.a.createElement("div",{className:"columns small-4 medium-6 large-8 margin-top-large"},r.a.createElement("button",{className:"button",type:"button",onClick:function(){return e.submit()}},r.a.createElement("i",{className:"fa fa-key","aria-hidden":"true"})," Login")))))}}]),t}(n.Component),S=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).onLogin=function(e,t){a.props.onLogin(e,t)},a.onLogout=function(){a.props.onLogout()},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user,n=e.isActive;return r.a.createElement("div",{"data-sticky-container":!0},r.a.createElement("header",{id:"masthead",className:"masthead","data-sticky":!0,"data-sticky-on":"large","data-top-anchor":"main-content-area:top","data-btm-anchor":"main-content-area:bottom"},r.a.createElement("div",{className:"masthead-inner row"},r.a.createElement("div",{className:"columns medium-12",id:"local-title"},r.a.createElement("h1",null,r.a.createElement(o.b,{to:"/"},"Competency Mapper"))),a&&t?r.a.createElement(j,{roles:t,user:a,onLogout:this.onLogout}):r.a.createElement(O,{onSubmit:this.onLogin})),r.a.createElement(k,{isActive:n})))}}]),t}(n.Component),N=(a(116),{oriValue:"",value:"",active:!1}),C=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(c)))).state=N,a.selfRef=r.a.createRef(),a.inputRef=r.a.createRef(),a.toggleActive=function(e){a.selfRef.current&&a.selfRef.current.contains(e.target)?a.setState({active:!0}):a.reset()},a.reset=function(){var e=a.state,t=e.oriValue;e.active&&a.setState({active:!1,value:t})},a.submit=function(){var e=a.props.change,t=a.state.value;e(t),a.setState({active:!1,oriValue:t})},a.render=function(){var e=a.props,t=e.style,n=e.staticElement,c=e.editable,i=a.state,o=i.value,s=i.active;return c?s?r.a.createElement("div",{className:"edit-inline-container",ref:a.selfRef},r.a.createElement("input",{type:"text",className:"inner-input",value:o,onChange:function(e){return a.onChange(e.target.value)},ref:a.inputRef}),r.a.createElement("div",{className:"edit-inline-controls"},r.a.createElement("button",{className:"button margin-bottom-none",type:"button",onClick:a.submit},r.a.createElement("i",{className:"icon icon-common icon-check","aria-label":"accept changes"})),r.a.createElement("button",{className:"button margin-bottom-none",type:"button",onClick:a.reset},r.a.createElement("i",{className:"icon icon-common icon-undo","aria-label":"undo changes"})))):r.a.createElement(n,{style:t,ref:a.selfRef},[o,r.a.createElement("i",{key:"dummy",className:"icon icon-common icon-edit icon-left-spacer","aria-label":"edit"})]):r.a.createElement(n,{style:t},o)},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.text;this.setState({value:e,oriValue:e}),document.addEventListener("mousedown",this.toggleActive)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.toggleActive)}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.active&&!t.active&&setTimeout(function(){return a.inputRef.current&&a.inputRef.current.focus()},0)}},{key:"onChange",value:function(e){this.setState({value:e})}}]),t}(n.Component);C.defaultProps={style:{},text:"",change:function(e){},staticElement:"div",editable:!0};var x={description:"",uuid:"",mapping:""},D=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state=x,a.onChange=function(e){e.preventDefault();var t=e.currentTarget.value,n=e.currentTarget.name;"uuid"===n&&a.setState(Object(_.a)({},n,t)),"description"===n&&a.setState(Object(_.a)({},n,t)),"mapping"===n&&a.setState(Object(_.a)({},n,t))},a.onSubmit=function(e){e.preventDefault();var t=a.props.onCreate,n=a.state,r=n.description,c=n.uuid,i=n.mapping;r.trim()&&c&&(t(r,c,i),a.reset())},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.setDefaultOption()}},{key:"setDefaultOption",value:function(){var e=this.props.options;if(e.length){var t=e[0].uuid;this.setState({uuid:t})}}},{key:"reset",value:function(){this.setState(x),this.setDefaultOption()}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.placeholder,n=e.options,c=e.showMappingField,i=this.state,o=i.description,s=i.uuid,l=i.mapping,u=n.map(function(e){var t=e.description,a=e.uuid;return r.a.createElement("option",{key:a,value:a},t)});return r.a.createElement("form",{onSubmit:this.onSubmit,className:"callout"},r.a.createElement("h4",null,t),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-7"},r.a.createElement("input",{type:"text",placeholder:a,name:"description",value:o,required:!0,onChange:this.onChange})),r.a.createElement("div",{className:"column large-3"},r.a.createElement("select",{name:"uuid",value:s,required:!0,onChange:this.onChange},u)),r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Create"})),c?r.a.createElement("div",{className:"column"},r.a.createElement("label",null,"Maps to competency/attribute from other framework",r.a.createElement("input",{type:"text",placeholder:"Framework (version), competency or attribute",name:"mapping",value:l,onChange:this.onChange}))):null))}}]),t}(n.Component);D.defaultProps={showMappingField:!1};var R=function(e){var t=e.message,a=e.style;return r.a.createElement("div",{className:"margin-top-large callout alert",style:a},t)};R.defaultProps={message:"Sorry, there was a problem when fetching the data!",style:{}};var T=R,A=a(41),I=a(21),q=a.n(I),F=a(33),L=a.n(F),U={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},M=function(e){var t=e.versions,a=e.framework,c=Object(n.useState)(!1),i=Object(A.a)(c,2),s=i[0],l=i[1],u=Object(n.useState)(""),m=Object(A.a)(u,2),p=m[0],h=m[1],d=t.filter(function(e){return"draft"!==e.number}).map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(o.b,{to:"/framework/".concat(a,"/").concat(e.number)},e.number)," ",r.a.createElement("button",{className:"anchor-like",onClick:function(){h("Version: "+e.number+e.release_notes),l(!0)}},"(release notes)"))});return r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,{isOpen:s,style:U},r.a.createElement("h4",null,"Release notes for ",a," "),L()(p),d,r.a.createElement("div",{className:"padding-top-large"},r.a.createElement("button",{className:"button",onClick:function(){h(""),l(!1)}},"Close"))),r.a.createElement("div",{className:"callout"},r.a.createElement("h5",null,"Framework versions"),0===t.length?"No previous versions":r.a.createElement("ul",null,d)))},V=a(29),P=function(){function e(){if(Object(p.a)(this,e),e.instance)return this.instance;e.instance=this}return Object(h.a)(e,[{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hal+json",t=window.localStorage.getItem("csrf_token");return"json"===e?{Accept:"application/json","Content-Type":"application/json","X-CSRF-Token":t,Authorization:"Basic"}:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":t,Authorization:"Basic"}}}]),e}(),B=a(50),H=a.n(B),W="https://live-competency-mapper.pantheonsite.io";H.a.defaults.baseURL=W;var K=function(){function e(){if(Object(p.a)(this,e),this.headers=new P,e.instance)return e.instance;e.instance=this}return Object(h.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?H.a.get(e,{headers:this.headers.get(t),withCredentials:!0}):H.a.get(e)}},{key:"post",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hal+json";return H.a.post(e,t,{headers:this.headers.get(a),withCredentials:!0})}},{key:"patch",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hal+json";return H.a.patch(e,t,{headers:this.headers.get(a),withCredentials:!0})}}]),e}(),z=function(){function e(){Object(p.a)(this,e)}return Object(h.a)(e,null,[{key:"createCompetency",value:function(e){var t,a,n=e.description,r=e.domainId,c=e.domainUuid,i=e.mapping,o=void 0===i?"":i,s=e.draftId,l=e.draftUuid;return{_links:(t={type:{href:"".concat(W,"/rest/type/node/competency")}},Object(_.a)(t,"".concat(W,"/rest/relation/node/competency/field_domain"),{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")}),Object(_.a)(t,"".concat(W,"/rest/relation/node/competency/field_versions"),[{href:"http://local.competency-mapper/taxonomy/term/".concat(s,"?_format=hal_json")}]),t),title:[{value:n}],type:[{target_id:"competency"}],field_map_other_competency:[{value:o}],_embedded:(a={},Object(_.a)(a,"".concat(W,"/rest/relation/node/competency/field_versions"),[{_links:{self:{href:"".concat(W,"/taxonomy/term/").concat(s,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/taxonomy_term/version")}},uuid:[{value:l}]}]),Object(_.a)(a,"".concat(W,"/rest/relation/node/competency/field_domain"),[{_links:{self:{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/domain")}},uuid:[{value:c}],lang:"en"}]),a)}}},{key:"createAttribute",value:function(e){var t,a,n=e.description,r=e.attributeTypeId,c=e.attributeTypeUuid,i=e.competencyId,o=e.competencyUuid,s=e.draftId,l=e.draftUuid;return{_links:(t={type:{href:"".concat(W,"/rest/type/node/attribute")}},Object(_.a)(t,"".concat(W,"/rest/relation/node/attribute/field_competency"),{href:"".concat(W,"/node/").concat(i,"?_format=hal_json")}),Object(_.a)(t,"".concat(W,"/rest/relation/node/attribute/field_attribute_type"),{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")}),Object(_.a)(t,"".concat(W,"/rest/relation/node/competency/field_versions"),[{href:"http://local.competency-mapper/taxonomy/term/".concat(s,"?_format=hal_json")}]),t),title:[{value:n}],type:[{target_id:"attribute"}],_embedded:(a={},Object(_.a)(a,"".concat(W,"/rest/relation/node/competency/field_versions"),[{_links:{self:{href:"".concat(W,"/taxonomy/term/").concat(s,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/taxonomy_term/version")}},uuid:[{value:l}]}]),Object(_.a)(a,"".concat(W,"/rest/relation/node/attribute/field_competency"),[{_links:{self:{href:"".concat(W,"/node/").concat(i,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/competency")}},uuid:[{value:o}],lang:"en"}]),Object(_.a)(a,"".concat(W,"/rest/relation/node/attribute/field_attribute_type"),[{_links:{self:{href:"".concat(W,"/node/").concat(r,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/attribute_type")}},uuid:[{value:c}],lang:"en"}]),a)}}},{key:"mutateCompetency",value:function(t,a){return e.mutate(t,a,"competency")}},{key:"mutateCompetencyPosition",value:function(t,a){return e.mutate(t,a,"competency")}},{key:"mutateAttribute",value:function(t,a){return e.mutate(t,a,"attribute")}},{key:"mutate",value:function(e,t,a){var n;return n={_links:{type:{href:"".concat(W,"/rest/type/node/").concat(a)}}},Object(_.a)(n,e,[{value:t}]),Object(_.a)(n,"type",[{target_id:a}]),n}},{key:"publishFramework",value:function(e,t,a){return{type:[{target_id:"article"}],title:[{value:e}],field_parent:[{value:e}],field_release_notes:[{value:a}],field_item:[{value:t}]}}},{key:"createDraftFramework",value:function(e){return{type:[{target_id:"article"}],title:[{value:"draft"}],field_parent:[{value:e}]}}},{key:"toggleArchivingVersionedNode",value:function(e,t){return{type:[{target_id:"article"}],field_parent:[{value:e}],field_item:[{value:t}]}}},{key:"updateReleaseNotes",value:function(e){return{_links:{type:{href:"".concat(W,"/rest/type/taxonomy_term/version")}},vid:[{target_id:"version"}],field_release_notes:[{value:e}]}}},{key:"changeDomain",value:function(e,t,a,n){return{_links:Object(_.a)({self:{href:"".concat(W,"/node/").concat(e,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/competency")}},"".concat(W,"/rest/relation/node/competency/field_domain"),{href:"".concat(W,"/node/").concat(t,"?_format=hal_json")}),field_map_other_competency:[{value:n}],type:{target_id:"competency"},_embedded:Object(_.a)({},"".concat(W,"/rest/relation/node/competency/field_domain"),[{_links:{self:{href:"".concat(W,"/node/").concat(t,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/domain")}},uuid:[{value:a}]}])}}},{key:"changeAttributeSettings",value:function(e,t,a,n,r){var c,i;return{_links:(c={self:{href:"".concat(W,"/node/").concat(e,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/attribute")}},Object(_.a)(c,"".concat(W,"/rest/relation/node/attribute/field_competency"),{href:"".concat(W,"/node/").concat(t,"?_format=hal_json")}),Object(_.a)(c,"".concat(W,"/rest/relation/node/attribute/field_attribute_type"),{href:"".concat(W,"/node/").concat(n,"?_format=hal_json")}),c),type:{target_id:"attribute"},_embedded:(i={},Object(_.a)(i,"".concat(W,"/rest/relation/node/attribute/field_competency"),[{_links:{self:{href:"".concat(W,"/node/").concat(t,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/competency")}},uuid:[{value:a}]}]),Object(_.a)(i,"".concat(W,"/rest/relation/node/attribute/field_attribute_type"),[{_links:{self:{href:"".concat(W,"/node/").concat(n,"?_format=hal_json")},type:{href:"".concat(W,"/rest/type/node/attribute_type")}},uuid:[{value:r}]}]),i)}}},{key:"editResource",value:function(e,t,a,n,r,c,i,o,s,l,u,m,p){return{_links:{type:{href:"".concat(W,"/rest/type/node/training_resource")}},title:[{value:t}],type:[{target_id:"training_resource"}]}}}]),e}(),J=function(){function e(){if(Object(p.a)(this,e),this.http=new K,e.instance)return this.instance;e.instance=this}return Object(h.a)(e,[{key:"getFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/v1/framework/".concat(t,"?_format=json"));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getVersionedDraftFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/".concat(t,"/edit?_format=json&timestamp=").concat(Date.now()),"json");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getVersionedFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/".concat(t,"/").concat(a,"?_format=json&timestamp=").concat(Date.now()));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAllFrameworks",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/v1/framework?_format=json");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAllVersionedFrameworks",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/version_manager?_format=json&timestamp=".concat(Date.now()));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"createAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/node?_format=hal_json",z.createAttribute(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/node?_format=hal_json",z.createCompetency(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"patchCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.mutateCompetency(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"patchCompetencyPosition",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.mutateCompetencyPosition(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"toggleArchivingVersionedNode",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/api/".concat(t,"/edit?_format=json"),z.toggleArchivingVersionedNode(t,a),"json");case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"patchAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.mutateAttribute(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"patchAttributePosition",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.mutateAttribute(a,n));case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"publishFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/api/version_manager?_format=json",z.publishFramework(t,a,n),"json");case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"createDraftFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/api/version_manager?_format=json",z.createDraftFramework(t),"json");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateReleaseNotes",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/taxonomy/term/".concat(a,"?_format=hal_json"),z.updateReleaseNotes(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"changeDomain",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n,r){var c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.changeDomain(t,a,n,r));case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"editResource",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n,r,c,i,o,s,l,m,p,h,d){var f;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.editResource(t,a,n,r,c,i,o,s,l,m,p,h,d));case 2:return f=e.sent,e.abrupt("return",f.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n,r,c,i,o,s,l,u,m,p,h){return e.apply(this,arguments)}}()},{key:"changeAttributeSettings",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a,n,r,c){var i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.patch("/node/".concat(t,"?_format=hal_json"),z.changeAttributeSettings(t,a,n,r,c));case 2:return i=e.sent,e.abrupt("return",i.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n,r,c){return e.apply(this,arguments)}}()},{key:"demap",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/mapping?_format=hal_json&resource="+t+"&items="+a+"&timestamp=".concat(Date.now()));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"attrmap",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("/api/mapping?_format=hal_json&resource="+t+"&attributes="+a+"&timestamp=".concat(Date.now()));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),X=function(){function e(){if(Object(p.a)(this,e),this.counter=0,this.callbacks=[],e.instance)return e.instance;e.instance=this}return Object(h.a)(e,[{key:"isActive",get:function(){return!!this.counter}}]),Object(h.a)(e,[{key:"addEventListener",value:function(e){return this.callbacks.push(e)}},{key:"removeEventListener",value:function(e){return delete this.callbacks[e-1]}},{key:"startRequest",value:function(){0===this.counter&&this.callbacks.forEach(function(e){return e&&e(!0)}),++this.counter}},{key:"finishRequest",value:function(){1===this.counter&&this.callbacks.forEach(function(e){return e&&e(!1)}),this.counter>0&&--this.counter}}]),e}(),Y=a(52),$=function(e){return Array.prototype.flat?e.flat():e.reduce(function(e,t){return[].concat(Object(Y.a)(e),Object(Y.a)(t))},[])},G=new RegExp("</?.+?/?>","g"),Q=/&nbsp;/g,Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.replace(G,t).replace(Q," ")},ee=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.state={framework:a.props.match.params.framework,frameworkName:"",frameworkVersion:"",frameworStatus:"",attributeTypes:[],versions:[],domainId:"",domainName:"",competencyId:a.props.match.params.cid,competencyUuid:"",competencyName:"",competencyData:[],path:a.props.location.pathname.split("/"),loadingError:!1,editable:!1},a.createAttribute=function(){var e=Object(m.a)(u.a.mark(function e(t,n,r){var c,i,o,s,l,m,p,h,d;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.state,i=c.competencyId,o=c.competencyUuid,s=c.attributeTypes,l=c.versions,m=l.filter(function(e){return"draft"===e.number}),e.prev=2,a.activeRequests.startRequest(),p=s.find(function(e){return e.uuid===n}).id,h=m[0].id,d=m[0].uuid,e.next=9,a.competencyService.createAttribute({description:t,competencyId:i,competencyUuid:o,attributeTypeId:p,attributeTypeUuid:n,draftId:h,draftUuid:d});case 9:return e.next=11,a.fetchFramework();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 16:return e.prev=16,a.activeRequests.finishRequest(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[2,13,16,19]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){window.scroll(0,0),this.loadData()}},{key:"loadData",value:function(){var e=Object(m.a)(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.fetchVersions(t);case 4:return e.next=6,this.fetchFramework(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({loadingError:!0});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"fetchVersions",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,e.next=3,this.competencyService.getAllVersionedFrameworks();case 3:a=e.sent,(n=a.filter(function(e){return e.title.toLowerCase()===t})).length>0&&(r=n[0].attribute_types.map(function(e){return{description:e.title,uuid:e.uuid}}),this.setState({versions:n[0].versions.reverse(),attributeTypes:r}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r,c,i,o,s,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,a=t.framework,n=t.versions,r=t.competencyId,c=n.filter(function(e){return"live"===e.status}),i=n.filter(function(e){return"draft"===e.status}),o=[],s=!1,!i.length){e.next=12;break}return e.next=8,this.competencyService.getVersionedDraftFramework(a);case 8:o=e.sent,s=!0,e.next=16;break;case 12:if(!c.length){e.next=16;break}return e.next=15,this.competencyService.getVersionedFramework(a,c[0].number);case 15:o=e.sent;case 16:(l=this.filterByCompetencyId(o,r)).length&&this.setState({frameworkName:o[0].title,frameworkVersion:o[0].version,frameworkStatus:o[0].status,domainName:l[0].domainTitle,domainId:l[0].domainId,competencyUuid:l[0].uuid,competencyName:l[0].title,competencyData:l[0],editable:s});case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"filterByCompetencyId",value:function(e,t){return $(e.map(function(e){return $(e.domains.map(function(e){return e.competencies.filter(function(e){return e.id===t}).map(function(t){return t.domainTitle=e.title,t.domainId=e.nid,t})}))}))}},{key:"editAttribute",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchAttribute(t,"title",a);case 4:return e.next=6,this.fetchFramework();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"editAttributePosition",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchAttributePosition(t,"field_number",a);case 4:return e.next=6,this.fetchFramework();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"toggleArchive",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.patchAttribute(t,"field_archived","1"!==a);case 4:return e.next=6,this.fetchFramework();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAttributeRows",value:function(e){var t=this,a=this.state,n=a.competencyData,c=a.editable;return n.attributes.filter(function(t){return t.type===e.description}).map(function(e){return c?r.a.createElement("tr",{key:e.uuid},r.a.createElement("td",{className:"1"===e.archived?"strikeout":""},r.a.createElement(C,{text:e.title,change:function(a){return t.editAttribute(e.id,a)},editable:"1"!==e.archived})),r.a.createElement("td",{className:"1"===e.archived?"strikeout":""},r.a.createElement(C,{text:e.field_number,change:function(a){return t.editAttributePosition(e.id,a)},editable:"1"!==e.archived})),r.a.createElement("td",null,r.a.createElement("button",{className:"cursor",onClick:function(){return t.toggleArchive(e.id,e.archived)}},"1"===e.archived?r.a.createElement("span",{className:"fas fa-toggle-on"},r.a.createElement("span",null,"Archived")):r.a.createElement("span",{className:"fas fa-toggle-off"}))),r.a.createElement("td",null,r.a.createElement(o.b,{to:"/framework/".concat(t.state.framework,"/competency/").concat(t.state.competencyId,"/attribute/").concat(e.id,"/settings")},r.a.createElement("i",{class:"fas fa-cog"})))):"1"===e.archived?null:r.a.createElement("tr",{key:e.uuid},r.a.createElement("td",{className:"1"===e.archived?"strikeout":""},r.a.createElement(C,{text:e.title,change:function(a){return t.editAttribute(e.id,a)},editable:c})))})}},{key:"getAttributeList",value:function(){var e=this,t=this.state,a=t.attributeTypes,n=t.editable;return a.map(function(t){return r.a.createElement(r.a.Fragment,{key:t.uuid},r.a.createElement("tr",{className:"secondary-background-important white-color"},r.a.createElement("td",null,r.a.createElement("strong",null,r.a.createElement("em",null,t.description))),n&&r.a.createElement("td",{className:"small-1"},"Position"),n&&r.a.createElement("td",{className:"small-1"},"Archive"),n&&r.a.createElement("td",{className:"small-1"},"Settings")),e.getAttributeRows(t))})}},{key:"render",value:function(){var e=this.state,t=e.framework,a=e.frameworkName,n=e.frameworkVersion,c=e.frameworkStatus,i=e.attributeTypes,s=e.versions,l=e.domainId,u=e.domainName,m=e.competencyName,p=e.competencyData,h=e.loadingError,d=e.editable;return h?r.a.createElement(T,null):0===p.length?null:r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,"Manage attributes"),r.a.createElement("h4",null,r.a.createElement(o.b,{to:"/framework/".concat(t,"/manage/competencies")},a)," / ",r.a.createElement(o.b,{to:"/framework/".concat(t,"/manage/competencies/").concat(l)},u)," / ",m),r.a.createElement("p",null,r.a.createElement("span",{className:"tag"},n),r.a.createElement("span",{className:"tag secondary-background"},""===c?"draft":c)),d&&r.a.createElement(D,{title:"Create new attribute",placeholder:"Attribute description",options:i,onCreate:this.createAttribute}),r.a.createElement("table",null,r.a.createElement("tbody",null,this.getAttributeList())),r.a.createElement(M,{framework:t,versions:s}))}}]),t}(r.a.Component),te=Object(V.withSnackbar)(ee),ae=a(19),ne=a.n(ae),re=function(e){var t=e.release,a=e.updateNotes,c=e.createDraft,i=e.versions,o=e.editable,s=i.reduce(function(e,t){return"live"===t.status?t.number:e},""),l=i.reduce(function(e,t){return"draft"===t.number?t.release_notes:e},""),u=Object(n.useState)(""),m=Object(A.a)(u,2),p=m[0],h=m[1],d=Object(n.useState)(l),f=Object(A.a)(d,2),v=f[0],g=f[1],b=Object(n.useState)(!1),y=Object(A.a)(b,2),E=y[0],k=y[1],w=Object(n.useState)(!1),j=Object(A.a)(w,2),_=j[0],O=j[1],S=function(){h(""),k(!1)};return o?r.a.createElement("div",null,r.a.createElement(q.a,{isOpen:_},r.a.createElement(ne.a,{content:v,events:{change:function(e){return g(e.editor.getData())}}}),r.a.createElement("div",{className:"padding-top-large"},r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:function(){g(l),O(!1)}},"Close")),r.a.createElement("button",{className:"button",onClick:function(){a(v),O(!1)}},"Save"))),r.a.createElement(q.a,{isOpen:E},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=v.trim();E&&p&&a&&(t(p,a),S())}},r.a.createElement("label",null,"Version"," ",s?"(live version ".concat(s,")"):"(no live version)",r.a.createElement("input",{type:"text",placeholder:"1.0.0",value:p,required:!0,onChange:function(e){return h(e.currentTarget.value.trim())}})),r.a.createElement(ne.a,{content:v,events:{change:function(e){return g(e.editor.getData())}}}),r.a.createElement("div",{className:"padding-top-large"},r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:S},"Cancel")),r.a.createElement("button",{className:"button",type:"submit"},"Publish")))),r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:function(){return k(!0)}},"Release new version")),r.a.createElement("button",{className:"button",onClick:function(){return O(!0)}},"Update release notes")):r.a.createElement("div",null,r.a.createElement("span",{className:"padding-right-small"},r.a.createElement("button",{className:"button",onClick:function(){return c()}},"Create draft")))},ce=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.state={framework:"",frameworkName:"",frameworkData:[],frameworkVersion:"",frameworkVersionId:"",frameworkStatus:"",competencyTypes:[],versions:[],loadingError:!1,editable:!1},a.createCompetency=function(){var e=Object(m.a)(u.a.mark(function e(t,n,r){var c,i,o,s,l,m,p,h;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.state,i=c.framework,o=c.frameworkData,s=c.versions,l=s.filter(function(e){return"draft"===e.number}),e.prev=2,a.activeRequests.startRequest(),m=o[0].domains.find(function(e){return e.uuid===n}).nid,p=l[0].id,h=l[0].uuid,e.next=9,a.competencyService.createCompetency({description:t,domainId:m,domainUuid:n,mapping:r,draftId:p,draftUuid:h});case 9:return e.next=11,a.fetchFramework(i);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 16:return e.prev=16,a.activeRequests.finishRequest(),e.finish(16);case 19:case"end":return e.stop()}},e,null,[[2,13,16,19]])}));return function(t,a,n){return e.apply(this,arguments)}}(),a.releaseNewVersion=function(){var e=Object(m.a)(u.a.mark(function e(t,n){var r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.state.framework,e.prev=1,a.activeRequests.startRequest(),e.next=5,a.competencyService.publishFramework(r,t,n);case 5:a.loadData(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,a.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])}));return function(t,a){return e.apply(this,arguments)}}(),a.updateNotes=function(){var e=Object(m.a)(u.a.mark(function e(t){var n,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,r=n.framework,c=n.frameworkVersionId,e.prev=1,a.activeRequests.startRequest(),e.next=5,a.competencyService.updateReleaseNotes(t,c);case 5:a.loadData(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,a.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])}));return function(t){return e.apply(this,arguments)}}(),a.createDraft=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.framework,e.prev=1,a.activeRequests.startRequest(),e.next=5,a.competencyService.createDraftFramework(t);case 5:a.loadData(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 11:return e.prev=11,a.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])})),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params,a=t.framework,n=t.domainId,e.next=3,this.loadData(a);case 3:n&&setTimeout(function(){var e=r.refs[n];e&&e.scrollIntoView()},100);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n,r,c,i;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state,r=n.framework,c=n.frameworkData,i=n.loadingError,r!==a.framework&&(0!==c.length||i||this.loadData(r));case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"loadData",value:function(){var e=Object(m.a)(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.fetchVersions(t);case 4:return e.next=6,this.fetchFramework(t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({loadingError:!0});case 11:return e.prev=11,this.activeRequests.finishRequest(),e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(t){return e.apply(this,arguments)}}()},{key:"fetchVersions",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.competencyService.getAllVersionedFrameworks();case 2:a=e.sent,(n=a.filter(function(e){return e.title.toLowerCase()===t})).length>0&&this.setState({versions:n[0].versions.reverse()});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n,r,c,i,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state.versions,n=a.filter(function(e){return"live"===e.status}),r=a.filter(function(e){return"draft"===e.status}),c=[],i=!1,!r.length){e.next=13;break}return e.next=8,this.competencyService.getVersionedDraftFramework(t);case 8:c=e.sent,this.setState({frameworkVersionId:r[0].id}),i=!0,e.next=17;break;case 13:if(!n.length){e.next=17;break}return e.next=16,this.competencyService.getVersionedFramework(t,n[0].number);case 16:c=e.sent;case 17:c.length&&(o=c[0].domains.map(function(e){return{description:e.title,uuid:e.uuid}}),this.setState({frameworkName:c[0].title,frameworkData:c,frameworkVersion:c[0].version,frameworkStatus:c[0].status,competencyTypes:o,editable:i}));case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"editCompetency",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.framework,e.prev=1,this.activeRequests.startRequest(),e.next=5,this.competencyService.patchCompetency(t,"title",a);case 5:return e.next=7,this.fetchFramework(n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"editCompetencyPosition",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.framework,e.prev=1,this.activeRequests.startRequest(),e.next=5,this.competencyService.patchCompetencyPosition(t,"field_number",a);case 5:return e.next=7,this.fetchFramework(n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"toggleArchive",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.framework,e.prev=1,this.activeRequests.startRequest(),e.next=5,this.competencyService.toggleArchivingVersionedNode(n,t);case 5:return e.next=7,this.fetchFramework(n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.props.enqueueSnackbar("Unable to perform the request",{variant:"error"});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getCompetencyList",value:function(){var e=this,t=this.state,a=t.frameworkData,n=t.editable;return a[0].domains.map(function(t){return r.a.createElement(r.a.Fragment,{key:t.nid},r.a.createElement("tr",{className:"secondary-background-important white-color",ref:t.nid},r.a.createElement("td",null,r.a.createElement("h4",null,t.title)),n&&r.a.createElement("td",{className:"small-1"},"Position"),n&&r.a.createElement("td",{className:"small-1"},"Archive"),r.a.createElement("td",null,"Attributes"),n&&r.a.createElement("td",{className:"small-1"},"Settings")),e.getCompetencyRows(t.competencies))})}},{key:"getCompetencyRows",value:function(e){var t=this,a=this.state,n=a.framework,c=a.editable;return e.map(function(e){return c?r.a.createElement("tr",{key:e.id},r.a.createElement("td",{className:"1"===e.archived?"strikeout":""},r.a.createElement(C,{text:e.title,change:function(a){return t.editCompetency(e.id,a)},editable:"1"!==e.archived})),r.a.createElement("td",null,r.a.createElement(C,{text:e.position,change:function(a){return t.editCompetencyPosition(e.id,a)},editable:"1"!==e.archived})),r.a.createElement("td",null,r.a.createElement("button",{className:"cursor",onClick:t.toggleArchive.bind(t,e.id,e.archived)},"1"===e.archived?r.a.createElement("span",{className:"fas fa-toggle-on"},r.a.createElement("span",null,"Archived")):r.a.createElement("span",{className:"fas fa-toggle-off"}))),r.a.createElement("td",null,r.a.createElement(o.b,{to:"/framework/".concat(n,"/manage/competencies/").concat(e.id,"/manage-attributes")},r.a.createElement("i",{className:"fas fa-sitemap"}))),r.a.createElement("td",null,r.a.createElement(o.b,{to:"/framework/".concat(n,"/competency/").concat(e.id,"/settings")},r.a.createElement("i",{class:"fas fa-cog"})))):"1"===e.archived?null:r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(C,{text:e.title,change:function(a){return t.editCompetency(e.id,a)},editable:c})),r.a.createElement("td",null,r.a.createElement(o.b,{to:"/framework/".concat(n,"/manage/competencies/").concat(e.id,"/manage-attributes")},r.a.createElement("i",{className:"fas fa-sitemap"}))))})}},{key:"render",value:function(){var e=this.state,t=e.framework,a=e.frameworkName,n=e.frameworkData,c=e.frameworkVersion,i=e.frameworkStatus,o=e.competencyTypes,s=e.versions,l=e.loadingError,u=e.editable;return l?r.a.createElement(T,null):0===n.length?null:r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,"Manage framework"),r.a.createElement("h4",null,a),r.a.createElement("p",null,r.a.createElement("span",{className:"tag"},c),r.a.createElement("span",{className:"tag secondary-background"},""===i?"draft":i)),r.a.createElement(re,{editable:u,createDraft:this.createDraft,versions:s,release:this.releaseNewVersion,updateNotes:this.updateNotes}),u&&r.a.createElement(D,{title:"Create new competency",placeholder:"Competency description",options:o,onCreate:this.createCompetency,showMappingField:!0}),r.a.createElement("table",null,r.a.createElement("tbody",null,this.getCompetencyList())),r.a.createElement(M,{framework:t,versions:s}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.match.params.framework;return a!==t.framework?{framework:a,frameworkData:[],loadingError:!1}:null}}]),t}(r.a.Component),ie=Object(V.withSnackbar)(ce),oe=a(48),se=function(){function e(){if(Object(p.a)(this,e),this.http=new K,e.instance)return this.instance;e.instance=this}return Object(h.a)(e,[{key:"getCourses",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.get("".concat("https://live-competency-mapper.pantheonsite.io","/api/resources?_format=json&timestamp=").concat(Date.now()));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),le=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.coursesService=new se,a.state={framework:a.props.match.params.framework,version:a.props.location.pathname.split("/"),frameworkData:[],competencyId:a.props.match.params.cid,attributeDefs:[],resources:[]},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,Promise.all([this.getFramework(),this.getAttributes(),this.getResources()]);case 4:return e.prev=4,this.activeRequests.finishRequest(),e.finish(4);case 7:case"end":return e.stop()}},e,this,[[0,,4,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"getFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.framework,a=this.state.version,e.next=4,this.competencyService.getVersionedFramework(t,a[3]);case 4:n=e.sent,this.setState({frameworkData:n});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAttributes",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.competencyService.getAllFrameworks();case 2:t=e.sent,a=this.state.framework,(n=t.filter(function(e){return e.name.toLowerCase()===a})).length&&(r=n[0].attribute_types.map(function(e){return e.title}),this.setState({attributeDefs:r}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getResources",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.coursesService.getCourses();case 3:t=e.sent,a=t.filter(function(e){return!!e.competency_profile.find(function(e){return e.competency_id===n.state.competencyId})}),this.setState({resources:a}),this.setState({resources:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to retrieve training resources",{variant:"error"});case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"resourceBlock",value:function(){return this.state.resources.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(o.b,{to:"/training-resources/".concat(e.id)},e.title))})}},{key:"render",value:function(){var e=this,t=this.state,a=t.competencyId,n=t.frameworkData,c=t.attributeDefs,i=t.resources,o=[];console.log(this.state.competencyId),n.forEach(function(e){return e.domains.forEach(function(t){return t.competencies.forEach(function(n){n.id===a&&o.push(Object(oe.a)({},n,{framework:e.title,domain:t.title}))})})});var s=o.map(function(t){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("h4",null," ",t.framework," / ",t.domain),r.a.createElement("h4",null,t.title))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-8"},r.a.createElement("ul",null,c.map(function(e){return r.a.createElement("div",{key:e},r.a.createElement("div",{className:"margin-top-medium"}," ",r.a.createElement("strong",null,r.a.createElement("em",null,e))),t.attributes.map(function(t){return t.type===e?r.a.createElement("li",{key:t.id},t.title," "):null}))}))),r.a.createElement("div",{className:"column large-4"},r.a.createElement("div",{className:"callout notice industry-background white-color"},r.a.createElement("p",null,"Competency derived from:"),r.a.createElement("p",null," ",t.mapped_other_competency?t.mapped_other_competency:"No data available"," ")),0===i.length?null:r.a.createElement("div",{className:"callout notice training-background white-color"},r.a.createElement("p",null,"Training resources mapped to this competency"),r.a.createElement("ul",null,e.resourceBlock())))))});return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("h3",null,"Competency details"),s))}}]),t}(r.a.Component),ue=Object(V.withSnackbar)(le),me=a(36),pe=(a(171),a(54)),he=a.n(pe),de=a(192);a(172);function fe(e){e.index;var t=e.framework,a=e.competency,n=(e.disable,e.version),c=Object(de.a)(a.attributes,"type"),i=Object.keys(c).map(function(e){var t=c[e].map(function(e){return r.a.createElement("li",{key:e.id},e.title)});return r.a.createElement("div",{key:e},r.a.createElement("em",null,e),r.a.createElement("ul",null,t))});return"1"===a.archived?null:r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(he.a,{trigger:r.a.createElement("div",{className:"open-close-title"},r.a.createElement("span",null,a.title),r.a.createElement("span",{className:"icon icon-common icon-plus float-right"},r.a.createElement("p",{className:"show-for-sr"},"show more"))),triggerWhenOpen:r.a.createElement("div",{className:"open-close-title"},r.a.createElement("span",null,a.title),r.a.createElement("span",{className:"icon icon-common icon-minus float-right"},r.a.createElement("p",{className:"show-for-sr"},"show less")))},r.a.createElement("div",{className:"padding-left-large padding-top-large"},r.a.createElement(o.b,{to:"/framework/".concat(t,"/").concat(n,"/competency/details/").concat(a.id)},r.a.createElement("span",{className:"float-right"},r.a.createElement("i",{className:"icon icon-spacer icon-common icon-info"}),"More details")),i))))}fe.defaultProps={parentIndex:0,index:0,disable:!0};var ve=fe;function ge(e){e.index;var t=e.framework,a=e.domain,n=e.disable,c=e.version,i=a.competencies.map(function(e,a){return r.a.createElement(ve,{key:e.id,index:a,framework:t,competency:e,disable:n,version:c})});return r.a.createElement("tbody",null,r.a.createElement("tr",{className:"white-color secondary-background"},r.a.createElement("td",null,r.a.createElement("h4",null," ",a.title))),i)}ge.defaultProps={domain:{title:"",competencies:[]},disable:!0};var be=ge,ye=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={courses:[],filteredCourses:[],filter:"",loadingError:!1},a.coursesService=new se,a.activeRequests=new X,a.onFilter=function(e){var t,n=a.state.courses;try{t=new RegExp(e,"i")}catch(c){t=/./}var r=n.filter(function(e){return t.test(e.title)});a.setState({filteredCourses:r,filter:e})},a.state.framework=e.framework,a.state.version=e.version,a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.coursesService.getCourses();case 4:t=e.sent,a=this.filterCourses(t),this.setState({courses:a,filteredCourses:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.setState({loadingError:!0});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[0,9,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"filterCourses",value:function(e){var t=this.state.framework,a=(this.state.version,[]);return e.forEach(function(e){if("1"!==e.archived){var n=e.competency_profile.filter(function(e){return(e.framework_label||"").toLowerCase()===t});if(0!==n.length){var r=Object(oe.a)({},e,{competencies:$(n.map(function(e){return e}))});a.push(r)}}}),a}},{key:"render",value:function(){var e=this,t=this.state,a=t.filteredCourses,n=t.framework,c=t.filter,i=t.loadingError,s=t.version;if(i)return r.a.createElement(T,null);var l=a.map(function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(o.b,{to:"/training-resources/".concat(e.id)},e.title)),r.a.createElement("td",null,e.type),r.a.createElement("td",null,r.a.createElement("ul",null,e.competencies.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(o.b,{to:"/framework/".concat(n,"/").concat(s,"/competency/details/").concat(e.competency_id)},e.competency_label))})," ")))});return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"search",value:c,onChange:function(t){return e.onFilter(t.target.value)},placeholder:"Filter resources"}),r.a.createElement("table",null,r.a.createElement("tbody",null,l)))}}]),t}(n.Component),Ee=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).competencyService=new J,a.activeRequests=new X,a.state={framework:"",frameworkVersion:"",frameworkName:"",frameworkStatus:"",frameworkDescription:"",versions:[],domains:[],filter:"",filteredDomains:[],loadingError:!1},a.onFilter=function(e){var t,n=a.state.domains;try{t=new RegExp(e,"i")}catch(c){t=/./}var r=n.map(function(e){var a=e.competencies.filter(function(e){return t.test(e.title)});return 0===a.length?null:Object(oe.a)({},e,{competencies:a})});a.setState({filter:e,filteredDomains:r})},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params,a=t.framework,n=t.version,e.prev=1,this.activeRequests.startRequest(),e.next=5,Promise.all([this.fetchFramework(a,n),this.fetchVersions(a)]);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.setState({loadingError:!0});case 10:return e.prev=10,this.activeRequests.finishRequest(),e.finish(10);case 13:case"end":return e.stop()}},e,this,[[1,7,10,13]])}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n,r,c,i,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,r=n.framework,c=n.frameworkVersion,i=n.domains,o=n.loadingError,r===a.framework&&c===a.frameworkVersion){e.next=15;break}if(0!==i.length||o){e.next=15;break}return e.prev=3,this.activeRequests.startRequest(),e.next=7,this.fetchFramework(r,c);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),this.setState({loadingError:!0});case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[3,9,12,15]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchFramework",value:function(){var e=Object(m.a)(u.a.mark(function e(t,a){var n,r,c,i,o,s;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.scroll(0,0),e.next=3,this.competencyService.getVersionedFramework(t,a);case 3:return n=e.sent,r=$(n.map(function(e){return e.domains})),c=Z(n[0].description),this.setState({frameworkName:n[0].title,frameworkDescription:c,domains:r,filteredDomains:r}),e.next=9,this.competencyService.getAllVersionedFrameworks();case 9:i=e.sent,(o=i.filter(function(e){return e.title.toLowerCase()===t})).length>0&&(s=o[0].versions.filter(function(e){return e.number==a}),this.setState({frameworkStatus:s[0].status}));case 12:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"fetchVersions",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.competencyService.getAllVersionedFrameworks();case 2:a=e.sent,(n=a.filter(function(e){return e.title.toLowerCase()===t})).length>0&&this.setState({versions:n[0].versions.reverse()});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.framework,n=t.frameworkVersion,c=t.frameworkName,i=t.frameworkStatus,o=t.frameworkDescription,s=t.filteredDomains,l=t.versions,u=t.filter;if(t.loadingError)return r.a.createElement(T,null);var m=s.map(function(e){return null===e?null:r.a.createElement(be,{key:e.nid,framework:a,domain:e,disable:!0,version:n})});return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,c),r.a.createElement("p",null,r.a.createElement("span",{className:"tag"},n),r.a.createElement("span",{className:"tag secondary-background"}," ",i)),r.a.createElement("p",null,o),r.a.createElement(me.d,null,r.a.createElement(me.b,null,r.a.createElement(me.a,null,"Competencies"),r.a.createElement(me.a,null,"Training resources")),r.a.createElement(me.c,null,r.a.createElement("input",{type:"search",value:u,onChange:function(t){return e.onFilter(t.target.value)},placeholder:"Filter competencies"}),r.a.createElement("table",null,m),r.a.createElement(M,{framework:a,versions:l})),r.a.createElement(me.c,null,r.a.createElement(ye,{framework:a,version:n}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.match.params,n=a.framework,r=a.version;return n!==t.framework||r!==t.frameworkVersion?{framework:n,frameworkVersion:r,domains:[],loadingError:!1}:null}}]),t}(n.Component),ke=a(11),we=a(7),je=a.n(we),_e=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={data:[],csrf:"",updateFlag:!1,path:a.props.location.pathname.split("/"),nid:"",title:"",dates:"",dates2:"",type:"",description:"",location:"",url:"",target_audience:"",learning_outcomes:"",keywords:"",organisers:"",trainers:""},a.redirectTo=a.redirectTo.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"changeDescription",value:function(e){var t=e.editor.getData();this.setState({description:t})}},{key:"changeTargetAudience",value:function(e){var t=e.editor.getData();this.setState({target_audience:t})}},{key:"changeLearningOutcomes",value:function(e){var t=e.editor.getData();this.setState({learning_outcomes:t})}},{key:"changeOrganisers",value:function(e){var t=e.editor.getData();this.setState({organisers:t})}},{key:"changeTrainers",value:function(e){var t=e.editor.getData();this.setState({trainers:t})}},{key:"componentDidMount",value:function(){var e=this;this.setState({nid:this.state.path[3]});var t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(W,"/api/resources?_format=json&timestamp=").concat(Date.now());fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({data:t})})}},{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"redirectTo",value:function(e){this.props.history.push("/training-resources/"+this.state.nid)}},{key:"render",value:function(){var e=this;this.checkUser();var t="",a="",n="",c="",i="",o="",s="",l="",u="",m="",p="",h="",d="";return this.state.data.forEach(function(r){r.id===e.state.nid&&(t=r.id,a=r.title,n=r.dates,c=r.end_date,i=r.type,o=r.description,s=r.location,l=r.url,u=r.target_audience,m=r.learning_outcomes,p=r.keywords,h=r.organisers,d=r.trainers)}),this.state.data.length>0?(console.log(a),r.a.createElement(Oe,{nid:t,title:a,dates:n,dates2:c,type:i,description:o,location:s,url:l,target_audience:u,learning_outcomes:m,keywords:p,organisers:h,trainers:d,redirectTo:this.redirectTo})):null}}]),t}(r.a.Component),Oe=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).activeRequests=new X,a.competencyService=new J,a.setRedirect=function(){a.props.history.push("all-training-resources")},a.state={nid:a.props.nid,title:a.props.title,dates:a.props.dates,dates2:a.props.dates2,type:a.props.type,description:a.props.description,location:a.props.location,url:a.props.url,target_audience:a.props.target_audience,learning_outcomes:a.props.learning_outcomes,keywords:a.props.keywords,organisers:a.props.organisers,trainers:a.props.trainers,redirect:!1,updateFlag:!1,csrf:""},a.handleTitle=a.handleTitle.bind(Object(ke.a)(a)),a.handleDates=a.handleDates.bind(Object(ke.a)(a)),a.handleDates2=a.handleDates2.bind(Object(ke.a)(a)),a.handleType=a.handleType.bind(Object(ke.a)(a)),a.handleDesc=a.handleDesc.bind(Object(ke.a)(a)),a.handleLocation=a.handleLocation.bind(Object(ke.a)(a)),a.handleURL=a.handleURL.bind(Object(ke.a)(a)),a.handleTargetAudience=a.handleTargetAudience.bind(Object(ke.a)(a)),a.handleLearningOutcomes=a.handleLearningOutcomes.bind(Object(ke.a)(a)),a.handleKeywords=a.handleKeywords.bind(Object(ke.a)(a)),a.handleOrganisers=a.handleOrganisers.bind(Object(ke.a)(a)),a.handleTrainers=a.handleTrainers.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})})}},{key:"handleTitle",value:function(e){this.setState({title:e.value})}},{key:"handleDates",value:function(e){this.setState({dates:e.value})}},{key:"handleDates2",value:function(e){this.setState({dates2:e.value})}},{key:"handleType",value:function(e){this.setState({type:e.value})}},{key:"handleDesc",value:function(e){this.setState({description:e.editor.getData()})}},{key:"handleLocation",value:function(e){this.setState({location:e.value})}},{key:"handleURL",value:function(e){this.setState({url:e.value})}},{key:"handleTargetAudience",value:function(e){this.setState({target_audience:e.editor.getData()})}},{key:"handleLearningOutcomes",value:function(e){this.setState({learning_outcomes:e.editor.getData()})}},{key:"handleKeywords",value:function(e){this.setState({keywords:e.value})}},{key:"handleOrganisers",value:function(e){this.setState({organisers:e.editor.getData()})}},{key:"handleTrainers",value:function(e){this.setState({trainers:e.editor.getData()})}},{key:"componentDidUpdate",value:function(e,t){this.state.updateFlag}},{key:"handleSubmit",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n,r,c,i,o,s,l,m,p,h,d,f,v,g=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=this.state.nid,n=this.refs.title.value,r=this.refs.dates.value,c=this.refs.dates2.value,i=this.refs.type.value,o=this.state.description,s=this.refs.location.value,l=this.refs.url.value,m=this.state.target_audience,p=this.state.learning_outcomes,h=this.state.organisers,d=this.state.trainers,f=this.refs.keywords.value,v=localStorage.getItem("csrf_token"),fetch("".concat(W,"/node/")+a+"?_format=hal_json",{method:"PATCH",credentials:"include",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":v},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/node/training_resource")}},title:[{value:n}],field_dates:[{value:r}],field_end_date:[{value:c}],field_type:[{value:i}],field_description:[{value:o,format:"basic_html"}],field_location:[{value:s}],field_url:[{value:l}],field_target_audience:[{value:m,format:"basic_html"}],field_learning_outcomes:[{value:p,format:"basic_html"}],field_keywords:[{value:f}],field_organisers:[{value:h,format:"basic_html"}],field_trainers:[{value:d,format:"basic_html"}],type:[{target_id:"training_resource"}]})}),t.preventDefault(),setTimeout(function(){g.props.redirectTo()},1e3);case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Edit Training Resources"),console.log(localStorage.getItem("csrf_token")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12 callout"},r.a.createElement("form",{className:"form",id:"resource_edit_form",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Title"),r.a.createElement("input",{type:"text",ref:"title",id:"title",value:this.state.title,onChange:this.handleTitle.bind(this),required:!0,placeholder:"Title"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Dates"),r.a.createElement("input",{type:"date",ref:"dates",value:this.state.dates,onChange:this.handleDates.bind(this),placeholder:"Date"})),r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Dates"),r.a.createElement("input",{type:"date",ref:"dates2",value:this.state.dates2,onChange:this.handleDates2.bind(this),placeholder:"Date"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Event type"),r.a.createElement("select",{ref:"type",value:this.state.type,onChange:this.handleType.bind(this)},r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Description"),r.a.createElement(ne.a,{content:this.state.description,events:{change:this.handleDesc},onChange:this.handleDesc,activeClass:"p10",required:!0}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Location"),r.a.createElement("input",{type:"text",ref:"location",value:this.state.location,onChange:this.handleLocation.bind(this),placeholder:"Location"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"URL"),r.a.createElement("input",{type:"text",ref:"url",value:this.state.url,onChange:this.handleURL.bind(this),required:!0,placeholder:"URL"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Target audience"),r.a.createElement(ne.a,{content:this.state.target_audience,events:{change:this.handleTargetAudience},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Learning outcomes"),r.a.createElement(ne.a,{content:this.state.learning_outcomes,events:{change:this.handleLearningOutcomes},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Organisers"),r.a.createElement(ne.a,{content:this.state.organisers,events:{change:this.handleOrganisers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Trainers"),r.a.createElement(ne.a,{content:this.state.trainers,events:{change:this.handleTrainers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Keywords"),r.a.createElement("input",{type:"text",ref:"keywords",value:this.state.keywords,onChange:this.handleKeywords.bind(this),placeholder:"Keywords"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Update"})))))))}}]),t}(r.a.Component);Oe.contextTypes={router:je.a.object};var Se=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resource/edit/:nid",component:_e}))},Ne=a(59),Ce=function(e){function t(e){return Object(p.a)(this,t),Object(d.a)(this,Object(f.a)(t).call(this,e))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return r.a.createElement(Ne.a,{onDrop:function(e){console.log(e);var t=new FileReader;t.onabort=function(){return console.log("file reading was aborted")},t.onerror=function(){return console.log("file reading has failed")},t.onload=function(){var e=t.result;console.log(e)},document.getElementById("fileupload").append(e[0].name),e.forEach(function(e){return t.readAsArrayBuffer(e)})}},function(e){var t=e.getRootProps,a=e.getInputProps;return r.a.createElement("section",null,r.a.createElement("div",t(),r.a.createElement("input",a()),r.a.createElement("a",{href:"#"},"Click to select files")))})}}]),t}(r.a.Component),xe=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).changeDescription=a.changeDescription.bind(Object(ke.a)(a)),a.changeTargetAudience=a.changeTargetAudience.bind(Object(ke.a)(a)),a.changeLearningOutcomes=a.changeLearningOutcomes.bind(Object(ke.a)(a)),a.changeOrganisers=a.changeOrganisers.bind(Object(ke.a)(a)),a.changeTrainers=a.changeTrainers.bind(Object(ke.a)(a)),a.state={data:[],csrf:"",updateFlag:!1,content:"content",description:"",target_audience:"",learning_outcomes:"",organisers:"",trainers:""},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"changeDescription",value:function(e){var t=e.editor.getData();this.setState({description:t})}},{key:"changeTargetAudience",value:function(e){var t=e.editor.getData();this.setState({target_audience:t})}},{key:"changeLearningOutcomes",value:function(e){var t=e.editor.getData();this.setState({learning_outcomes:t})}},{key:"changeOrganisers",value:function(e){var t=e.editor.getData();this.setState({organisers:t})}},{key:"changeTrainers",value:function(e){var t=e.editor.getData();this.setState({trainers:t})}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(setTimeout(function(){a.props.history.push("/all-training-resources")},1e3),console.log("componentDidUpdate"))}},{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"componentDidMount",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})})}},{key:"handleSubmit",value:function(e){var t=this.refs.title.value,a=this.refs.dates.value,n=this.refs.dates2.value,r="Online";this.refs.type.value&&(r=this.refs.type.value);var c=this.state.description,i=this.refs.location.value,o=this.refs.url.value,s=this.state.target_audience,l=this.state.learning_outcomes,u=this.refs.keywords.value,m=this.state.organisers,p=this.state.trainers,h=localStorage.getItem("csrf_token");fetch("".concat(W,"/node?_format=hal_json"),{credentials:"include",method:"POST",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":h,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/node/training_resource")}},title:[{value:t}],field_dates:[{value:a}],field_end_date:[{value:n}],field_type:[{value:r}],field_description:[{value:c,format:"basic_html"}],field_location:[{value:i}],field_url:[{value:o}],field_target_audience:[{value:s,format:"basic_html"}],field_learning_outcomes:[{value:l,format:"basic_html"}],field_keywords:[{value:u}],field_organisers:[{value:m,format:"basic_html"}],field_trainers:[{value:p,format:"basic_html"}],type:[{target_id:"training_resource"}]})}),e.target.reset(),this.setState({updateFlag:!0}),e.preventDefault()}},{key:"render",value:function(){return this.checkUser(),r.a.createElement("div",null,r.a.createElement("h2",null,"Create Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12 callout"},r.a.createElement("h4",null,"Create new competency"),r.a.createElement("form",{className:"form",id:"resource_create_form",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Title"),r.a.createElement("input",{type:"text",ref:"title",required:!0,placeholder:"Title"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"Start Date"),r.a.createElement("input",{type:"date",ref:"dates",placeholder:"Date"})),r.a.createElement("div",{className:"column large-6"},r.a.createElement("strong",null,"End Date"),r.a.createElement("input",{type:"date",ref:"dates2",placeholder:"Date"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Event type"),r.a.createElement("select",{ref:"type"},r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Description"),r.a.createElement(ne.a,{content:this.state.description,events:{change:this.changeDescription},activeClass:"p10",required:!0}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Location"),r.a.createElement("input",{type:"text",ref:"location",placeholder:"Location"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"URL"),r.a.createElement("input",{type:"text",ref:"url",required:!0,placeholder:"URL"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Target audience"),r.a.createElement(ne.a,{content:this.state.target_audience,events:{change:this.changeTargetAudience},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Learning outcomes"),r.a.createElement(ne.a,{content:this.state.learning_outcomes,events:{change:this.changeLearningOutcomes},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Organisers"),r.a.createElement(ne.a,{content:this.state.organisers,events:{change:this.changeOrganisers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Trainers"),r.a.createElement(ne.a,{content:this.state.trainers,events:{change:this.changeTrainers},activeClass:"p10"}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"Keywords"),r.a.createElement("input",{type:"text",ref:"keywords",placeholder:"Keywords"}))),r.a.createElement("div",{id:"fileupload",className:"row"},r.a.createElement("div",{className:"column large-12"},r.a.createElement("strong",null,"File upload"),r.a.createElement(Ce,null))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-2"},r.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))))))}}]),t}(r.a.Component),De=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resource/create",component:xe}))},Re=window.$,Te=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).activeRequests=new X,a.competencyService=new J,a.state={data:[],framework:a.props.location.pathname.split("/")[4],resourceID:a.props.location.pathname.split("/")[2],frameworkdetails:[],csrf:"",frameworkUUID:"",competencies:[],selectedAttributes:[],resourceDetails:"",resourcePath:a.props.location.pathname.split("/")},a.handleSelect=a.handleSelect.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleSelect",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.state.selectedAttributes,a=[],localStorage.getItem("csrf_token"),n=0;n<t.length;n++)a.push(t[n].split("id",2));return e.prev=4,this.activeRequests.startRequest(),e.next=8,Promise.all([this.competencyService.attrmap(this.state.resourceID,a)]);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),this.setState({loadingError:!0});case 13:return e.prev=13,this.activeRequests.finishRequest(),this.props.history.push("/training-resources/"+this.state.resourceID),e.finish(13);case 17:case"end":return e.stop()}},e,this,[[4,10,13,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleAllCheck",value:function(e,t,a){var n=this.state.selectedAttributes,r=document.getElementsByName(e);if(a.target.checked)for(var c=0;c<r.length;c++)r[c].checked=!0,n.push(r[c].getAttribute("data-id")),this.setState({selectedAttributes:n});else for(var i=0;i<r.length;i++)!0===r[i].checked&&(r[i].checked=!1,n.splice(n.indexOf(r[i]),1),this.setState({selectedAttributes:n}))}},{key:"handleAttributeClick",value:function(e,t,a){var n=this.state.selectedAttributes;a.target.checked?(n.push(e),this.setState({selectedAttributes:n}),document.getElementById(a.target.name).checked=!0,console.log(n)):(n.splice(n.indexOf(e),1),this.setState({selectedAttributes:n}),Re(":checkbox[name="+a.target.name+"]").is(":checked")||(document.getElementById(a.target.name).checked=!1))}},{key:"handleListAllChecked",value:function(e){var t=[];Re(":checkbox").each(function(){Re(this).is(":checked")&&t.push(Re(this).attr("id"))}),alert(t)}},{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r,c,i=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(W)+"/api/resources/?_format=hal_json&id="+this.state.resourceID+"&timestamp="+Date.now()).then(function(e){return e.json()}).then(function(e){i.setState({resourceDetails:e})});case 2:return console.log(this.state.resourceDetails),t=[],this.state.resourceDetails.competency_profile.map(function(e){e.domains.map(function(e){e.competencies.map(function(e){e.attributes.map(function(e){t.push(e.id)})})})}),this.setState({selectedAttributes:t}),a="".concat(W,"/rest/session/token"),fetch(a).then(function(e){return e}).then(function(e){i.setState({csrf:e})}),n="".concat(W,"/api/version_manager?_format=json&timestamp=").concat(Date.now()),e.next=11,fetch(n).then(function(e){return e.json()}).then(function(e){i.setState({frameworkdetails:e})});case 11:return r="",this.state.frameworkdetails.map(function(e){e.title.toLowerCase()==i.state.framework&&e.versions.map(function(e){"live"==e.status&&(r=e.number)})}),c="".concat(W)+"/api/"+this.state.framework+"/"+r+"?_format=json",console.log(c),e.next=17,fetch(c).then(function(e){return e.json()}).then(function(e){i.setState({data:e})});case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(e,t){return this.state.attributes===t.attributes}},{key:"render",value:function(){var e=this,t=this.state.frameworkdetails,a=this.state.data,n=[],c=[],i=[],o=this.state.resourceDetails,s=[],l=[];o&&o.competency_profile.map(function(e){e.domains.map(function(e){e.competencies.map(function(e){l.push(e.id),e.attributes.map(function(e){s.push(e.id)})})})}),t.forEach(function(t,a){t.title.toLowerCase()===e.state.framework&&(t.attribute_types.forEach(function(e){n.push(e.title),i.push(r.a.createElement("option",{"data-id":e.id,value:e.uuid},e.title))}),t.domains.forEach(function(e){c.push(r.a.createElement("option",{"data-id":e.id,value:e.uuid},e.title))}))});var u=a.map(function(t){return t.domains.map(function(t,a){return r.a.createElement("tbody",null,r.a.createElement("tr",{key:t.nid},r.a.createElement("td",null,a+1)," ",r.a.createElement("td",null,r.a.createElement("strong",null," ",t.title)," ")," "),t.competencies.map(function(t,c){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,a+1,".",c+1),r.a.createElement("td",null,r.a.createElement("input",{type:"checkbox",defaultChecked:-1!==l.indexOf(t.id),"data-test":t.uuid,id:t.id,onChange:e.handleAllCheck.bind(e,t.id,t.uuid)})," ",t.title,r.a.createElement("ul",{style:{marginLeft:"1em",marginBottom:"1em"}},n.map(function(a){return r.a.createElement("div",{style:{marginLeft:"1em"}},r.a.createElement("div",null," ",r.a.createElement("strong",null,r.a.createElement("em",null,a))),t.attributes.filter(function(e){return e.type===a}).map(function(a){return r.a.createElement("li",{key:a.id,style:{marginLeft:"1em"}},r.a.createElement("input",{type:"checkbox",defaultChecked:-1!==s.indexOf(a.id),name:t.id,"data-id":a.id,"data-uuid":a.uuid,id:a.id,onChange:e.handleAttributeClick.bind(e,a.id,a.uuid)})," ",r.a.createElement("span",{className:a.archived}," ",a.title))}))}))))}),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("td",null))))})});return r.a.createElement("div",null,r.a.createElement("h2",null,o.title),r.a.createElement("h4",null,"Type: ",o.type),r.a.createElement("h4",null,"URL: ",o.url),r.a.createElement("table",{className:"table"},u),r.a.createElement("div",{id:"footer-button"},r.a.createElement("button",{className:"button",onClick:this.handleSelect.bind(this)}," ","Save")))}}]),t}(r.a.Component),Ae=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resources/:id/map/:framework",component:Te}))},Ie={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};q.a.setAppElement("#root");var qe=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={modalIsOpen:!1},a.openModal=a.openModal.bind(Object(ke.a)(a)),a.closeModal=a.closeModal.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"openModal",value:function(){this.setState({modalIsOpen:!0})}},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1})}},{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement("button",{onClick:this.openModal}," ",r.a.createElement("i",{className:"fa fa-question-circle"})," "),r.a.createElement(q.a,{isOpen:this.state.modalIsOpen,onAfterOpen:this.afterOpenModal,onRequestClose:this.closeModal,style:Ie,contentLabel:"Example Modal"},r.a.createElement("button",{className:"float-right",onClick:this.closeModal},r.a.createElement("i",{className:"fa fa-window-close"})),r.a.createElement("p",null),r.a.createElement("div",{className:"callout"},"This item is deprecated in the latest version of this framework. Please see the",r.a.createElement(o.b,{to:"/framework/".concat(this.props.framework.toLowerCase(),"/").concat(this.props.version)}," release notes"))))}}]),t}(r.a.Component),Fe=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={resource:[],frameworks:[],resourcePath:a.props.location.pathname.split("/"),showModal:!1,selectedFramework:"",updateFlag:""},a.handleOpenModal=a.handleOpenModal.bind(Object(ke.a)(a)),a.handleCloseModal=a.handleCloseModal.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handleOpenModal",value:function(e,t){this.setState({showModal:!0}),this.setState({selectedFramework:e}),t.preventDefault()}},{key:"handleCloseModal",value:function(){this.setState({showModal:!1}),this.setState({updateFlag:!0})}},{key:"componentDidUpdate",value:function(){var e=this;this.state.updateFlag&&(this.fetchData(),setTimeout(function(){e.setState({updateFlag:!1})},1e3),console.log("componentDidUpdate"))}},{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.fetchData();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchData",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(W,"/api/resources/?_format=json&id=").concat(this.state.resourcePath[2],"&timestamp=").concat(Date.now());console.log(a),fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({resource:t})}),fetch("".concat(W,"/api/version_manager?_format=json")).then(function(e){return e.json()}).then(function(t){e.setState({frameworks:t})})}},{key:"mappingBlock",value:function(){var e=this;if(localStorage.getItem("roles")&&localStorage.getItem("roles").includes("content_manager"))return r.a.createElement("div",{className:"callout white-color industry-background"},r.a.createElement("strong",null," Manage competency profile "),r.a.createElement("ul",null,this.state.frameworks.map(function(t,a){return r.a.createElement("li",{style:{display:"inline",margin:"5px"}},r.a.createElement("a",{href:"/training-resources/"+e.state.resourcePath[2]+"/map/"+t.title.toLowerCase()}," ",r.a.createElement("i",{className:"fas fa-tags"})," ",t.title," "))})))}},{key:"render",value:function(){var e=this,t=[],a=this.state.resource,n="",c=Array.isArray(a.competency_profile),i=r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("h2",null,a.title),r.a.createElement("span",{className:"float-right"}," ",r.a.createElement(o.b,{to:"/training-resource/edit/"+this.state.resourcePath[2]}," ",r.a.createElement("i",{class:"fas fa-edit"}),"  Edit "))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-9"},r.a.createElement("div",{className:"callout"},a.date?r.a.createElement("p",null,r.a.createElement("strong",null,"Date:")," ",a.dates):"",a.keywords?r.a.createElement("p",null,r.a.createElement("strong",null,"Keywords:")," ",a.keywords):"",a.location?r.a.createElement("p",null,r.a.createElement("strong",null,"Location:")," ",a.location):"",a.type?r.a.createElement("p",null,r.a.createElement("strong",null,"Type:")," ",a.type):"",a.url?r.a.createElement("p",null,r.a.createElement("strong",null," URL: ")," ",r.a.createElement("a",{href:a.url,target:"_blank"},a.url)):""),r.a.createElement("h3",null,"Overview"),a.description?L()(a.description):"",a.target_audience?L()("<h3>Target Audience</h3>"+a.target_audience):"",a.learning_outcomes?L()("<h3>Learning Outcomes</h3>"+a.learning_outcomes):"",a.organisers?L()("<h3>Organizers</h3>"+a.organisers):"",a.trainers?L()("<h3>Trainers</h3>"+a.trainers):"",r.a.createElement("h3",null,"Competency Profile"),r.a.createElement("table",{className:"hover"},r.a.createElement("tbody",null,c?a.competency_profile.map(function(c){return r.a.createElement("tr",null,e.state.frameworks.map(function(e){return e.nid===c.id&&(e.attribute_types.map(function(e){return t.push(e.title)}),n=e.versions.find(function(e){return"live"===e.status})),null}),r.a.createElement("td",null,r.a.createElement("h4",null,c.title)),r.a.createElement("td",null,c.domains.map(function(e){return r.a.createElement("div",null,r.a.createElement("h5",null,e.title),r.a.createElement("ul",null,e.competencies.map(function(e){return r.a.createElement("li",null,r.a.createElement("span",{className:"archived"==e.archived?"archived":""},e.title,"archived"==e.archived?r.a.createElement(qe,{framework:"bioexcel",versions:"/bioexcel/1.1"}):""),r.a.createElement("ul",null,t.map(function(t){return r.a.createElement("span",null,e.attributes.map(function(e){return e.type===t?r.a.createElement("li",null," ",r.a.createElement("em",null,t)," -"," ",r.a.createElement("span",{className:"archived"==e.archived?"archived":""},e.title,"archived"==e.archived?r.a.createElement(qe,{framework:c.title,version:n.number}):"","archived"==e.archived?r.a.createElement("a",{href:"/training-resources/"+a.id+"/demap/"+e.id},r.a.createElement("i",{class:"fas fa-times-circle"})):"")):null}))})))})))})))}):""))),r.a.createElement("div",{className:"column large-3 callout industry-background white-color"},r.a.createElement("h3",null,"More information"),r.a.createElement("p",null,"No data available")))));return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-12"},i,this.mappingBlock()),r.a.createElement("div",{style:{overflow:"scroll"}},r.a.createElement(q.a,{isOpen:this.state.showModal,className:"Modal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},r.a.createElement("div",null,r.a.createElement("h2",{style:{"text-align":"center"}},"Manage competency profile for"," ",this.state.selectedFramework.toUpperCase()," ",r.a.createElement("i",{className:"fas fa-window-close float-right","data-close":!0,onClick:this.handleCloseModal})," ")),r.a.createElement("table",null,r.a.createElement(Ae,{selectedCompetencies:[],selectedAttributes:[],selectedFramework:this.state.selectedFramework,resourceID:this.state.resourcePath[2],handleCloseModal:this.handleCloseModal})))))}}]),t}(r.a.Component),Le=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resources/:id",component:Fe}))},Ue=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={resources:[],filterType:"",filterMapping:"",userid:""},a.archiveHandle=a.archiveHandle.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.updateFlag&&(this.fetchData(),setTimeout(function(){a.setState({updateFlag:!1})},1e3),console.log("componentDidUpdate"))}},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})});var a="".concat(W,"/api/resources?_format=json&timestamp=").concat(Date.now());fetch(a).then(function(e){return e.json()}).then(function(t){e.setState({resources:t})})}},{key:"checkAuthor",value:function(e){return localStorage.getItem("userid")==e}},{key:"filter",value:function(e){this.setState({filter:e.target.value})}},{key:"filterTypeHandle",value:function(e){this.setState({filterType:e.target.value})}},{key:"filterMappingHandle",value:function(e){this.state.filterMapping?this.setState({filterMapping:0}):this.setState({filterMapping:1})}},{key:"archiveHandle",value:function(e,t,a){var n="";n=1!==t;var r=localStorage.getItem("csrf_token");fetch("".concat(W,"/node/")+e+"?_format=hal_json",{credentials:"include",method:"PATCH",cookies:"x-access-token",headers:{Accept:"application/hal+json","Content-Type":"application/hal+json","X-CSRF-Token":r,Authorization:"Basic"},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/node/training_resource")}},field_archived:[{value:n}],type:[{target_id:"training_resource"}]})}),this.setState({updateFlag:!0}),a.preventDefault()}},{key:"render",value:function(){var e=this;this.checkUser();var t=this.state.resources;this.state.filter&&(t=t.filter(function(t){return t.title.toLowerCase().includes(e.state.filter.toLowerCase())||t.description.toLocaleLowerCase().includes(e.state.filter.toLowerCase())})),"All"!==this.state.filterType&&(t=t.filter(function(t){return t.type.toLocaleLowerCase().includes(e.state.filterType.toLowerCase())})),this.state.filterMapping&&(t=t.filter(function(e){return e.competency_profile.some(function(e){return"archived"==e.attribute_archived||"archived"==e.competency_archived||"archived"==e.domain})}),console.log("filter applied"));var a=t.map(function(t,a){return r.a.createElement("tr",{key:a},r.a.createElement("td",null,a+1," "),r.a.createElement("td",null," ",r.a.createElement(o.b,{to:"/training-resources/"+t.id},t.title," ")),r.a.createElement("td",null,t.dates),r.a.createElement("td",null,t.type),r.a.createElement("td",null,r.a.createElement("a",{href:t.url,target:"_blank"},t.url)),r.a.createElement("td",null,"1"===t.archived?r.a.createElement("a",{onClick:e.archiveHandle.bind(e,t.id,1)}," ",r.a.createElement("i",{className:"fas fa-toggle-on"})," ",r.a.createElement("span",null,"Archived")," "):r.a.createElement("a",{onClick:e.archiveHandle.bind(e,t.id,0)}," ",r.a.createElement("i",{className:"fas fa-toggle-off"}))),r.a.createElement("td",null,e.checkAuthor(t.author)?r.a.createElement(o.b,{to:"/training-resource/edit/".concat(t.id)},r.a.createElement("i",{className:"fas fa-edit"})," "):""))});return r.a.createElement("div",{className:"row"},r.a.createElement("h3",null,"Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-6"},r.a.createElement("div",null,r.a.createElement("input",{type:"text",onChange:this.filter.bind(this),placeholder:"Type to search"}))),r.a.createElement("div",{className:"column large-2"},r.a.createElement("div",null,r.a.createElement("select",{ref:"type",onChange:this.filterTypeHandle.bind(this)},r.a.createElement("option",{value:"All"},"All"),r.a.createElement("option",{value:"Online"},"Online"),r.a.createElement("option",{value:"Face-to-Face"},"Face-to-Face"),r.a.createElement("option",{value:"Webinar"},"Webinar"),r.a.createElement("option",{value:"Hackathon"},"Hackathon")))),r.a.createElement("div",{className:"column large-3"},r.a.createElement("input",{type:"checkbox",id:"checkboxMapping",checked:this.state.filterMapping,onChange:this.filterMappingHandle.bind(this)}),r.a.createElement("span",{id:"checkboxMappingLabel",for:"checkboxMapping"},"Items with deprecated mapping")),r.a.createElement("div",{className:"column large-1"},r.a.createElement(o.b,{className:"button float-right",to:"/training-resource/create"},r.a.createElement("i",{className:"fas fa-plus-circle"}," ")," Add new"," "))),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"S. No."),r.a.createElement("th",null,"Title"),r.a.createElement("th",null,"Date(s)"),r.a.createElement("th",null,"Type"),r.a.createElement("th",null,"URL"),r.a.createElement("th",null,"Archive"),r.a.createElement("th",null,"Edit"))),r.a.createElement("tbody",null,a)))}}]),t}(r.a.Component),Me=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/all-training-resources",component:Ue}))},Ve=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={resources:[],filterType:""},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"checkUser",value:function(){localStorage.getItem("roles")?localStorage.getItem("roles").includes("content_manager")||(alert("You are not authorised to access this page. Contact the administrator"),this.props.history.push("/")):this.props.history.push("/"),console.log(localStorage.getItem("roles"))}},{key:"render",value:function(){return this.checkUser(),r.a.createElement("div",{className:"row"},r.a.createElement("h3",null,"Training Resources"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-4 callout"},r.a.createElement(o.b,{className:"button float-right",to:"/all-training-resources"},r.a.createElement("i",{className:"fas fa-list"}," ")," View published training resources"," ")),r.a.createElement("div",{className:"column large-4 callout"},r.a.createElement(o.b,{className:"button float-right",to:"#"},r.a.createElement("i",{className:"fas fa-list"}," ")," View unpublished training resources"," ")),r.a.createElement("div",{className:"column large-4 callout"},r.a.createElement(o.b,{className:"button float-right",to:"#"},r.a.createElement("i",{className:"fas fa-tasks"}," ")," Manage training resources"," "))))}}]),t}(r.a.Component),Pe=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resources-home",component:Ve}))},Be=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={data:[],roles:"",user:""},a.handlePasswordChange=a.handlePasswordChange.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"handlePasswordChange",value:function(e){var t=this.refs.old.value,a=this.refs.new1.value,n=localStorage.getItem("userid");fetch("".concat(W,"/user/")+n+"/password?_format=json",{credentials:"include",method:"PATCH",headers:{"Content-Type":"application/json","X-CSRF-Token":localStorage.getItem("csrf_token")},body:JSON.stringify({_links:{type:{href:"".concat(W,"/rest/type/user/user")}},old:[{value:t}],new:[{target_id:a}]})}).then(function(e){return e}).then(function(e){return setTimeout(function(){alert("Password changed successfully"),window.location.reload()},1e3)}),e.preventDefault()}},{key:"checkUser",value:function(){localStorage.getItem("roles")||this.props.history.push("/")}},{key:"render",value:function(){return this.checkUser(),r.a.createElement("div",null,r.a.createElement("h3",null,"Change password:"),r.a.createElement("form",{id:"passChange"},r.a.createElement("input",{type:"password",ref:"old",placeholder:"Old password"}),r.a.createElement("input",{type:"password",ref:"new1",placeholder:"New password"}),r.a.createElement("input",{type:"password",placeholder:"Confirm new password"}),r.a.createElement("input",{type:"button",className:"button",onClick:this.handlePasswordChange.bind(this),value:"Submit"})))}}]),t}(r.a.Component),He=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"About competency mapper"),r.a.createElement("p",{className:"lead"},"Competency mapper is a web-based tool to support the creation and management of competency frameworks for professionals working in the biomolecular sciences."),r.a.createElement("h3",null,"Anyone can.."),r.a.createElement("p",null,r.a.createElement("ul",null,r.a.createElement("li",null,"Explore the five competency frameworks that we currently have in the system"),r.a.createElement("li",null,"Click on any competency to find the knowledge, skills and attitudes (KSAs) associated with it"),r.a.createElement("li",null,"See the relationships between different competency frameworks; for example, if a competency in framework 2 is derived from one in framework 1, this information is captured"),r.a.createElement("li",null,"Access a list of courses that have been mapped to a particular competency"),r.a.createElement("li",null,"View summary information on each of these courses, including a link through to the course website"))),r.a.createElement("h3",null,"In addition to the above, content editors can..."),r.a.createElement("ul",null,r.a.createElement("li",null,"Map courses to any competency in the mapper"),r.a.createElement("li",null,"Map courses to any combination of knowledge, skills and attitudes")),r.a.createElement("h3",null,"In addition to the above, administrators can..."),r.a.createElement("ul",null,r.a.createElement("li",null,"Build a completely new competency framework from a blank template"),r.a.createElement("li",null,"Make minor updates to an existing competency framework"),r.a.createElement("li",null,"If a competency framework has undergone major updates such as merging, splitting or deprecation of competencies, create and publish a new version of the framework without overwriting the previous version, and without losing links to pre-existing mappings"),r.a.createElement("li",null,"Create and edit multiple personas or roles associated with a competency framework"),r.a.createElement("li",null,"For each competency in an associated framework, define the level of competency required by any of the personas/roles associated with it, using an administrator-defined list of variables.")),r.a.createElement("h3",null,"What is competency?"),r.a.createElement("p",null,"By definition, competency is an observable ability of any professional, integrating multiple components such as knowledge, skills, values and attitudes. It is observable, so its acquisition can be validated objectively."),r.a.createElement("h4",null,"Why is it relevant?"),r.a.createElement("p",null,"Competency provides a shared \u2018currency\u2019 applicable to learning of all types and at all career stages."),r.a.createElement("ul",null,r.a.createElement("li",null,"Individual professionals can use competency as a career development tool: by documenting the competencies that you have gained, and the evidence that you have gained them, in a competency portfolio you can seek further training to fill gaps in your portfolio, or map your existing portfolio to roles that you might not previously have considered."),r.a.createElement("li",null,"Professional bodies and employers can use competency to define competency frameworks for different roles or professions. These provide useful guidance when hiring and promoting individuals, and can also provide the basis for professional recognition in regulated professions."),r.a.createElement("li",null,"Course providers can use competency to develop training (by asking what competencies their trainees need to gain) and, where appropriate, to assess whether training has been effective.")),r.a.createElement("h3",null,"What is a competency framework?"),r.a.createElement("p",null,"A competency framework defines the competencies required to fulfil a particular role. competency frameworks are typically defined by professional bodies or learned societies in collaboration with employers. Several projects under the EU\u2019s Horizon 2020 framework have developed competency frameworks to support emerging professions."),r.a.createElement("h3",null,"Who is developing the competency mapper?"),r.a.createElement("p",null,"The competency mapper is being developed by the"," ",r.a.createElement("a",{href:"https://www.ebi.ac.uk/about/people/cath-brooksbank",target:"_blank"}," ","EMBL-EBI training team"," ")," ","with the"," ",r.a.createElement("a",{href:"https://bioexcel.eu/",target:"_blank"}," ","BioExcel"," ")," ","competency framework as its primary use case."," "),r.a.createElement("p",null,"EMBL-EBI\u2019s Training programme uses a competency-based approach to developing new courses: put simply, we ask ourselves \u2018What competency or competencies does our audience for this course need to develop?\u2019 before we create the programme and content for a new course, and before we make a significant update to an existing course."),r.a.createElement("p",null,"The team has contributed to, and helped to steer, a number of initiatives to develop new training programmes by defining competency requirements in relation to a specific target audience and building a competency framework for that audience. Competency-based projects that we have been involved in include:"),r.a.createElement("ul",null,r.a.createElement("li",null,"The ISCB education committee\u2019s"," ",r.a.createElement("a",{href:"https://europepmc.org/articles/PMC5794068",target:"_blank"}," ","competency framework for bioinformatics professionals"," ")," "),r.a.createElement("li",null,"A clinical bioinformatics competency framework to support Health Education England to prepare clinical practitioners for the application of genomics in the healthcare service"),r.a.createElement("li",null,"The"," ",r.a.createElement("a",{href:"https://drive.google.com/file/d/0B3BA3KSKGOoQb0hvUkx3a3lMS00/view",target:"_blank"}," ","RItrain competency framework"," ")," ","for managers and leaders of research infrastructure"),r.a.createElement("li",null,"The"," ",r.a.createElement("a",{href:"https://zenodo.org/record/154085#.WbUNUhNSwUE",target:"_blank"}," ","CORBEL competency framework"," ")," ","for technical operators of research infrastructure"),r.a.createElement("li",null,"The"," ",r.a.createElement("a",{href:"https://zenodo.org/record/264231#.WbUNoRNSwUE",target:"_blank"}," ","BioExcel competency framework"," "),"for scientists working on biomolecular modelling and simulation"),r.a.createElement("p",null),r.a.createElement("p",null,"These competency frameworks were designed to be used by the training communities who developed them, and openly available to anyone who might find them useful, yet all too often they end up buried in a PDF file as part of a project deliverable. This made us long for a web-based tool that would make these frameworks,and the training associated with them, readily discoverable. We therefore decided to build that tool, and although it\u2019s still in the early stages of development we\u2019ve decided to make it openly available now so that we can seek broad input to improve it and make it as useful as possible to the education and training community at large. If you have comments or suggestions, please"," ",r.a.createElement("a",{href:"mailto:competency@ebi.ac.uk"}," contact us "),".")))};var We=function(e){var t=e.framework,a=Z(t.description);a.length>120&&(a="".concat(a.slice(0,120).trim(),"..."));var n=t.versions.reduce(function(e,t){return"live"===t.status?t.number:e},null);return null===n?null:r.a.createElement("div",{className:"column medium-4"},r.a.createElement(o.b,{className:"column callout","data-equalizer-watch":!0,to:"/framework/".concat(t.title.toLowerCase(),"/").concat(n)},r.a.createElement("img",{className:"float-center margin-bottom-medium",style:{height:"6rem"},src:t.logo[0].url,alt:"competency logo"}),r.a.createElement("h5",null,a,r.a.createElement("i",{className:"icon icon-functional","data-icon":">"}))))},Ke=window.$;var ze=function(e){var t=e.frameworks,a=new r.a.createRef;return t.length<1?null:r.a.createElement("div",{className:"row","data-equalizer":!0,ref:a},(window.setTimeout(function(){return Ke(a.current).foundation()}),t.map(function(e){return r.a.createElement(We,{key:e.nid,framework:e})})))},Je=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).activeRequests=new X,a.competencyService=new J,a.state={frameworks:[]},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.activeRequests.startRequest(),e.next=4,this.competencyService.getAllVersionedFrameworks();case 4:t=e.sent,this.setState({frameworks:t}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),this.props.enqueueSnackbar("Unable to fetch framework data",{variant:"error"}),console.error(e.t0);case 12:return e.prev=12,this.activeRequests.finishRequest(),e.finish(12);case 15:case"end":return e.stop()}},e,this,[[0,8,12,15]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.frameworks;return r.a.createElement("div",{className:"column"},r.a.createElement("h3",null,"Overview"),r.a.createElement("p",{className:"lead"},"Competency mapper is a web-based tool to support the creation and management of competency frameworks for professionals working in the biomolecular sciences"," ",r.a.createElement(o.b,{to:"/about",className:"readmore"},"read more"," ")),r.a.createElement(ze,{frameworks:e}))}}]),t}(n.Component),Xe=Object(V.withSnackbar)(Je),Ye=(r.a.Component,function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).activeRequests=new X,a.competencyService=new J,a.state={data:[],path:a.props.location.pathname.split("/"),competency:"",competencyUUID:"",competencyTitle:"",frameworkList:[],domainID:"",domainUuid:"",csrf:"",mapping:""},a.editDomain=a.editDomain.bind(Object(ke.a)(a)),a.handleChange=a.handleChange.bind(Object(ke.a)(a)),a.onTextChange=a.onTextChange.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"fetchData",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.path[4],a="".concat(W,"/node/")+t+"/?_format=json",fetch(a).then(function(e){return e.json()}).then(function(e){r.setState({competency:e},r.setMappingText)}),n="".concat(W,"/api/version_manager/?_format=json"),fetch(n).then(function(e){return e.json()}).then(function(e){r.setState({frameworkList:e})}),console.log("fetchData");case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setMappingText",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.state.competency).field_map_other_competency.length>0&&this.setState({mapping:t.field_map_other_competency[0].value});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"editDomain",value:function(e){var t=this.state.path[4],a=this.state.domainID,n=this.state.domainUuid,r=this.state.mapping;a||(a=this.state.competency.field_domain[0].target_id,n=this.state.competency.field_domain[0].target_uuid),this.competencyService.changeDomain(t,a,n,r),this.props.history.push("/framework/"+this.state.path[2]+"/manage/competencies"),e.preventDefault()}},{key:"onTextChange",value:function(e){this.setState({mapping:e.target.value}),console.log(this.state.mapping)}},{key:"handleChange",value:function(e){var t=e.target.options[e.target.selectedIndex].dataset;this.setState({domainID:t.id,domainUuid:t.uuid}),console.log(t.uuid)}},{key:"render",value:function(){var e=this,t="",a="",n="",c=this.state.competency,i=this.state.frameworkList,o=[],s=[];(i&&i.map(function(t){t.title.toLowerCase()===e.state.path[2]&&t.domains.map(function(e){o.push(r.a.createElement("option",{key:e.id,"data-id":e.id,"data-uuid":e.uuid,value:e.id},e.title)),s.push({key:e.id,value:e.title})})}),c)&&(t=c.title[0].value,a=c.field_domain[0].target_id,c.field_domain[0].target_uuid,s.length>0&&(n=s.find(function(e){return e.key==a}).value));return r.a.createElement("div",null,r.a.createElement("h2",null,"Change domain"),r.a.createElement("table",{className:"table hover stack"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Domain:")),r.a.createElement("td",null,r.a.createElement("h4",null,n))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("h4",null,"Competency:")),r.a.createElement("td",null,r.a.createElement("h4",null,t))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:2},r.a.createElement("p",{className:"lead"},"Select the domain from the following list to change:"),r.a.createElement("form",{id:"changeDomainForm",onSubmit:this.editDomain.bind(this)},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"column large-11"},r.a.createElement("select",{value:this.state.domainID?this.state.domainID:a,onChange:this.handleChange},o),r.a.createElement("label",null,"Maps to competency/attribute from other framework",r.a.createElement("input",{type:"text",placeholder:"Framework (version), competency or attribute",name:"mapping",value:this.state.mapping,onChange:this.onTextChange.bind(this)})),r.a.createElement("input",{type:"submit",className:"button",value:"Save"})),r.a.createElement("div",{className:"column large-1"}))))))))}}]),t}(r.a.Component)),$e=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/framework/:framework/competency/:id/settings",component:Ye}))},Ge=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).activeRequests=new X,a.competencyService=new J,a.state={data:[],path:a.props.location.pathname.split("/"),attributeID:a.props.location.pathname.split("/")[6],frameworkName:a.props.location.pathname.split("/")[2],frameworkList:[],attributeType:"",attribute:"",competencyID:a.props.location.pathname.split("/")[4],competencyUUID:"",competencyTitle:"",attributeTypeID:"",attributeTypeUUID:"",frameworkData:[]},a.changeSettings=a.changeSettings.bind(Object(ke.a)(a)),a.handleCompetencyChange=a.handleCompetencyChange.bind(Object(ke.a)(a)),a.handleTypeChange=a.handleTypeChange.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"fetchData",value:function(){var e=Object(m.a)(u.a.mark(function e(){var t,a,n,r=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.attributeID,a="".concat(W,"/node/")+t+"/?_format=json&timestamp=".concat(Date.now()),fetch(a).then(function(e){return e.json()}).then(function(e){r.setState({attribute:e})}),fetch("".concat(W,"/api/version_manager?_format=json")).then(function(e){return e.json()}).then(function(e){r.setState({frameworkList:e})}),e.next=6,this.competencyService.getVersionedDraftFramework(this.state.frameworkName);case 6:n=e.sent,this.setState({frameworkData:n});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.fetchData()}},{key:"changeSettings",value:function(e){var t=this.state.attributeID,a=this.state.competencyID?this.state.competencyID:this.state.attribute.field_competency[0].target_id,n=this.state.competencyUUID?this.state.competencyUUID:this.state.attribute.field_competency[0].target_uuid,r=this.state.attributeTypeID?this.state.attributeTypeID:this.state.attribute.field_attribute_type[0].target_id,c=this.state.attributeTypeUUID?this.state.attributeTypeUUID:this.state.attribute.field_attribute_type[0].target_uuid;this.competencyService.changeAttributeSettings(t,a,n,r,c),this.props.history.push("/framework/"+this.state.path[2]+"/manage/competencies/"+this.props.location.pathname.split("/")[4]+"/manage-attributes"),e.preventDefault()}},{key:"handleCompetencyChange",value:function(e){var t=e.target.options[e.target.selectedIndex].dataset;this.setState({competencyID:t.id,competencyUUID:t.uuid})}},{key:"handleTypeChange",value:function(e){var t=e.target.options[e.target.selectedIndex].dataset;this.setState({attributeTypeID:t.id,attributeTypeUUID:t.uuid})}},{key:"render",value:function(){var e=this,t="",a="",n="",c="",i="",o=this.state.attribute,s=this.state.frameworkData,l=this.state.frameworkList,u=[],m=[],p=[],h=[];if(l&&l.map(function(t){t.title.toLowerCase()==e.state.frameworkName&&t.attribute_types.map(function(e){p.push(r.a.createElement("option",{key:e.id,"data-id":e.id,"data-uuid":e.uuid,value:e.id},e.title)),h.push({key:e.id,value:e.title})})}),s&&s.map(function(e){e.domains.map(function(e){e.competencies.map(function(e){0==e.archived&&(u.push(r.a.createElement("option",{key:e.id,"data-id":e.id,"data-uuid":e.uuid,value:e.id},e.title)),m.push({key:e.id,value:e.title}))})})}),o){if(t=o.title[0].value,a=o.field_competency[0].target_id,o.field_competency[0].target_uuid,c=o.field_attribute_type[0].target_id,m.length>0)n=m.find(function(e){return e.key==a}).value;if(h.length>0)i=h.find(function(e){return e.key==c}).value}return r.a.createElement("div",null,r.a.createElement("h2",null,"Change attribute settings"),r.a.createElement("h3",null,"Attribute: ",t),r.a.createElement("table",{className:"table hover stack"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Competency:"),r.a.createElement("td",null,n),r.a.createElement("td",{rowSpan:2},r.a.createElement("form",{id:"changeDomainForm",onSubmit:this.changeSettings.bind(this)},r.a.createElement("label",null,"Change competency:"),r.a.createElement("select",{value:this.state.competencyID?this.state.competencyID:a,onChange:this.handleCompetencyChange},u),r.a.createElement("label",null,"Change attribute type:"),r.a.createElement("select",{value:this.state.attributeTypeID?this.state.attributeTypeID:c,onChange:this.handleTypeChange},p),r.a.createElement("input",{type:"submit",className:"button",value:"Save"})))),r.a.createElement("tr",null,r.a.createElement("td",null,"Attribute type:"),r.a.createElement("td",null,i)))))}}]),t}(r.a.Component),Qe=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/framework/:framework/competency/:cid/attribute/:aid/settings",component:Ge}))},Ze=(window.$,function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e))).activeRequests=new X,a.competencyService=new J,a.state={resourceID:a.props.location.pathname.split("/")[2],attributeID:a.props.location.pathname.split("/")[4],resourceDetails:[],csrf:""},a.demap=a.demap.bind(Object(ke.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"demap",value:function(){var e=Object(m.a)(u.a.mark(function e(t){var a,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return 1034,a=[20,21],e.next=4,this.competencyService.demap(1034,a);case 4:n=e.sent,console.log(n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;fetch("".concat(W)+"/node/"+this.state.resourceID+"?_format=hal_json").then(function(e){return e.json()}).then(function(t){e.setState({resourceDetails:t})});var t="".concat(W,"/rest/session/token");fetch(t).then(function(e){return e}).then(function(t){e.setState({csrf:t})})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",null,"Are you sure you want to remove this mapping? This action cannot be undone!"),r.a.createElement("button",{className:"button",onClick:this.demap.bind(this)},"Yes"))}}]),t}(r.a.Component)),et=function(){return r.a.createElement(g.d,null,r.a.createElement(g.b,{exact:!0,path:"/training-resources/:resource/demap/:attribute",component:Ze}))},tt=new K,at="/user/login?_format=json",nt="/user/logout";function rt(e,t){return ct.apply(this,arguments)}function ct(){return(ct=Object(m.a)(u.a.mark(function e(t,a){var n,r,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t,pass:a},e.prev=1,e.next=4,tt.post(at,n);case 4:return r=e.sent,c=r.data,localStorage.setItem("roles",c.current_user.roles),localStorage.setItem("csrf_token",c.csrf_token),localStorage.setItem("logout_token",c.logout_token),localStorage.setItem("user",c.current_user.name),localStorage.setItem("userid",c.current_user.uid),console.log(localStorage.getItem("roles")),e.abrupt("return",c);case 15:throw e.prev=15,e.t0=e.catch(1),it(),e.t0;case 19:case"end":return e.stop()}},e,null,[[1,15]])}))).apply(this,arguments)}function it(){return localStorage.removeItem("roles"),localStorage.removeItem("csrf_token"),localStorage.removeItem("logout_token"),localStorage.removeItem("userid"),localStorage.removeItem("user"),tt.post(nt)}var ot=window.$,st=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:!1,roles:localStorage.getItem("roles")||"",user:localStorage.getItem("user")||""},a.activeRequests=new X,a.handleActiveRequests=function(e){a.setState({isActive:e})},a.detectUserChangesFromOtherTabs=function(e){var t=e.key,n=e.newValue;"user"===t&&(n?a.setState({user:localStorage.getItem("user"),roles:localStorage.getItem("roles")}):a.setState({user:"",roles:""}))},a.handleLogin=function(){var e=Object(m.a)(u.a.mark(function e(t,n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rt(t,n);case 3:a.setState({user:localStorage.getItem("user"),roles:localStorage.getItem("roles")}),e.next=17;break;case 6:if(e.prev=6,e.t0=e.catch(0),window.console.error(e.t0),!e.t0.response){e.next=17;break}e.t1=e.t0.response.status,e.next=400===e.t1?13:15;break;case 13:return window.alert(e.t0.response.data.message),e.abrupt("return");case 15:window.alert("Sorry, there was an unknown login problem, please try again.");case 16:window.alert("Sorry, there was an unknown login problem, please try again.");case 17:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleLogout=function(){a.setState({user:"",roles:""}),it()},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){ot(document).foundation(),ot(document).foundationExtendEBI(),this.setState({isActive:this.activeRequests.isActive}),this.subcription=this.activeRequests.addEventListener(this.handleActiveRequests),window.addEventListener("storage",this.detectUserChangesFromOtherTabs)}},{key:"componentWillUnmount",value:function(){this.subcription&&this.activeRequests.removeEventListener(this.subcription),window.removeEventListener("storage",this.detectUserChangesFromOtherTabs)}},{key:"render",value:function(){var e=this.state,t=e.isActive,a=e.roles,n=e.user;return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.SnackbarProvider,{maxSnack:1,anchorOrigin:{vertical:"bottom",horizontal:"center"},preventDuplicate:!0},r.a.createElement(S,{roles:a,user:n,isActive:t,onLogin:this.handleLogin,onLogout:this.handleLogout}),r.a.createElement("section",{id:"main-content-area",className:"row",role:"main"},r.a.createElement("main",{className:"column"},r.a.createElement(g.d,null,r.a.createElement(lt,{condition:!!n&&a.includes("content_manager"),path:"/training-resource/edit/:nid",component:Se}),r.a.createElement(lt,{condition:!!n&&a.includes("content_manager"),path:"/training-resource/create",component:De}),r.a.createElement(lt,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/competency/:cid/attribute/:aid/settings",component:Qe}),r.a.createElement(lt,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/manage/competencies/:cid/manage-attributes",component:te}),r.a.createElement(lt,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/manage/competencies/:domainId?",component:ie}),r.a.createElement(g.b,{path:"/framework/:framework/:version/competency/details/:cid",component:ue}),r.a.createElement(lt,{condition:!!n&&a.includes("framework_manager"),path:"/framework/:framework/competency/:id/settings",component:$e}),r.a.createElement(g.b,{path:"/framework/:framework/:version",component:Ee}),r.a.createElement(lt,{condition:!!n&&a.includes("content_manager"),path:"/training-resources/:id/map/:framework",component:Ae}),r.a.createElement(lt,{condition:!!n&&a.includes("content_manager"),path:"/training-resources/:resource/demap/:attribute",component:et}),r.a.createElement(g.b,{path:"/training-resources/:id",component:Le}),r.a.createElement(g.b,{path:"/all-training-resources",component:Me}),r.a.createElement(g.b,{path:"/training-resources-home",component:Pe}),r.a.createElement(g.b,{path:"/user/change/password",component:Be}),r.a.createElement(g.b,{path:"/about",component:He}),r.a.createElement(g.b,{path:"/",component:Xe}))))))}}]),t}(n.Component),lt=function(e){function t(){return Object(p.a)(this,t),Object(d.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.component,a=e.condition,n=Object(s.a)(e,["component","condition"]);return r.a.createElement(g.b,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,e):r.a.createElement(g.a,{to:"/"})}}))}}]),t}(n.Component),ut=document.getElementById("root");i.a.render(r.a.createElement(o.a,{basename:""},r.a.createElement(st,null)),ut),q.a.setAppElement(ut)},66:function(e,t,a){e.exports={meter:"progress-bar_meter__2axTP",progress:"progress-bar_progress__3d3PT"}}},[[101,1,2]]]);
//# sourceMappingURL=main.779d02a7.chunk.js.map